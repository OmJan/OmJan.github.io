<!DOCTYPE html>
<html prefix="
        og: http://ogp.me/ns# article: http://ogp.me/ns/article#
    " vocab="http://ogp.me/ns" lang="ru">
<head>
<meta charset="utf-8">
<meta name="description" content="IT blog">
<meta name="viewport" content="width=device-width">
<title>VelikiiNehochuha Blog</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="ru" href="rss.xml">
<link rel="canonical" href="http://velikiinehochuha.github.io/">
<!--[if lt IE 9]><script src="assets/js/html5shiv-printshiv.min.js"></script><![endif]--><link rel="prefetch" href="posts/sicp-uprazhneniia-125-126-127-128/" type="text/html">
</head>
<body>
    <a href="#content" class="sr-only sr-only-focusable">Перейти к главному содержимому</a>
    <div id="container">
             <header id="header"><h1 id="brand"><a href="http://velikiinehochuha.github.io/" title="VelikiiNehochuha Blog" rel="home">

        <span id="blog-title">VelikiiNehochuha Blog</span>
    </a></h1>

        
            <nav id="menu"><ul>
<li><a href="archive.html">Архив</a></li>
                <li><a href="categories/">Тэги</a></li>
                <li><a href="rss.xml">RSS лента</a></li>

    
    
    
    </ul></nav></header><main id="content"><div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/sicp-uprazhneniia-125-126-127-128/" class="u-url">SICP Упражнения 1.25, 1.26, 1.27, 1.28</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Velikii Nehochuha
            </span></p>
            <p class="dateline">
            <a href="posts/sicp-uprazhneniia-125-126-127-128/" rel="bookmark">
            <time class="published dt-published" datetime="2020-01-13T14:34:28+03:00" itemprop="datePublished" title="2020-01-13 14:34">2020-01-13 14:34</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div>
 <div class="chapter-block">
  <h2>
   Упражнение 1.25
  </h2>
  <div>
   <div>
    <p>
     Алиса посетовала что мы проделали много лишней работы при написании expmod. В конце концов, сказала она, мы уже знаем как посчитать экспоненту, мы могли бы просто написать:
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno">1 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">expmod</span> <span class="nv">base</span> <span class="nv">exp</span> <span class="nv">m</span><span class="p">)</span>
<span class="lineno">2 </span>  <span class="p">(</span><span class="nb">remainder </span><span class="p">(</span><span class="nf">fast-expt</span> <span class="nv">base</span> <span class="nv">exp</span><span class="p">)</span> <span class="nv">m</span><span class="p">))</span>
</pre>
</div>   <div>
    <p>
     Правильно ли это? Будет ли эта процедура работать так же быстро как fast-prime тест?
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno"> 1 </span><span class="c1">;; метод который используем в fast-prime?</span>
<span class="lineno"> 2 </span><span class="c1">;; Два числа называются сопоставимыми по модулю n если оба имеют одинаковый остаток при делении на n.</span>
<span class="lineno"> 3 </span><span class="c1">;; вызывая каждый раз reminder, числа с которыми мы работаем остаются малыми</span>
<span class="lineno"> 4 </span>
<span class="lineno"> 5 </span><span class="c1">;; 2 7 7</span>
<span class="lineno"> 6 </span><span class="c1">;; 2 &lt;- 2 * (2 6 7)</span>
<span class="lineno"> 7 </span><span class="c1">;; 1 &lt;- square (2 3 7)</span>
<span class="lineno"> 8 </span><span class="c1">;; 1 &lt;- 2 * (2 2 7)</span>
<span class="lineno"> 9 </span><span class="c1">;; 4 &lt;- sqaure (2 1 7)</span>
<span class="lineno">10 </span><span class="c1">;; 2 &lt;- 2 * (2 0 7)</span>
<span class="lineno">11 </span>
<span class="lineno">12 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">expmod</span> <span class="nv">base</span> <span class="nv">exp</span> <span class="nv">m</span><span class="p">)</span>
<span class="lineno">13 </span>  <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">= </span><span class="nv">exp</span> <span class="mi">0</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span>
<span class="lineno">14 </span>        <span class="p">((</span><span class="nb">even? </span><span class="nv">exp</span><span class="p">)</span>
<span class="lineno">15 </span>         <span class="p">(</span><span class="nb">remainder </span><span class="p">(</span><span class="nf">square</span> <span class="p">(</span><span class="nf">expmod</span> <span class="nv">base</span> <span class="p">(</span><span class="nb">/ </span><span class="nv">exp</span> <span class="mi">2</span><span class="p">)</span> <span class="nv">m</span><span class="p">))</span>
<span class="lineno">16 </span>                    <span class="nv">m</span><span class="p">))</span>
<span class="lineno">17 </span>        <span class="p">(</span><span class="nf">else</span>
<span class="lineno">18 </span>         <span class="p">(</span><span class="nb">remainder </span><span class="p">(</span><span class="nb">* </span><span class="nv">base</span> <span class="p">(</span><span class="nf">expmod</span> <span class="nv">base</span> <span class="p">(</span><span class="nb">- </span><span class="nv">exp</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">m</span><span class="p">))</span>
<span class="lineno">19 </span>                    <span class="nv">m</span><span class="p">))))</span>
<span class="lineno">20 </span>
<span class="lineno">21 </span><span class="nv">expmod</span> <span class="p">(</span><span class="mi">100</span> <span class="mi">1000000007</span> <span class="mi">1000000007</span><span class="p">)</span>
<span class="lineno">22 </span><span class="nv">reminder</span> <span class="p">(</span><span class="mi">100</span> <span class="nv">*</span> <span class="p">[</span><span class="nv">expmod</span><span class="p">(</span><span class="mi">100</span> <span class="mi">1000000006</span> <span class="mi">1000000007</span><span class="p">)])</span> <span class="mi">1000000007</span>
<span class="lineno">23 </span><span class="c1">;; тут мы будем умножать на остаток []</span>
<span class="lineno">24 </span><span class="p">[]</span> <span class="nv">=</span> <span class="nv">reminder</span> <span class="p">(</span><span class="nf">square</span> <span class="p">([</span><span class="nv">expmod</span> <span class="mi">100</span> <span class="mi">500000003</span> <span class="mi">1000000007</span><span class="p">]))</span> <span class="mi">1000000007</span><span class="p">)</span>
<span class="lineno">25 </span><span class="c1">;; возводить в квадрат и перемножать мы будем остаток от деления</span>
<span class="lineno">26 </span><span class="c1">;; мы сделаем это лагорифмическое число раз</span>
<span class="lineno">27 </span><span class="nv">reminder</span> <span class="p">(</span><span class="nf">square</span> <span class="p">(</span><span class="mi">100</span> <span class="nv">*</span> <span class="nv">expmod</span><span class="p">(</span><span class="mi">100</span> <span class="mi">1000000006</span><span class="nv">/2</span> <span class="mi">1000000007</span><span class="p">))</span>
<span class="lineno">28 </span>
<span class="lineno">29 </span><span class="c1">;; метод Алисы</span>
<span class="lineno">30 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">fast-expt</span> <span class="nv">b</span> <span class="nv">n</span><span class="p">)</span>
<span class="lineno">31 </span>  <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">= </span><span class="nv">n</span> <span class="mi">0</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span>
<span class="lineno">32 </span>        <span class="p">((</span><span class="nb">even? </span><span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nf">square</span> <span class="p">(</span><span class="nf">fast-expt</span> <span class="nv">b</span> <span class="p">(</span><span class="nb">/ </span><span class="nv">n</span> <span class="mi">2</span><span class="p">))))</span>
<span class="lineno">33 </span>        <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">* </span><span class="nv">b</span> <span class="p">(</span><span class="nf">fast-expt</span> <span class="nv">b</span> <span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="mi">1</span><span class="p">))))))</span>
<span class="lineno">34 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">expmod</span> <span class="nv">base</span> <span class="nv">exp</span> <span class="nv">m</span><span class="p">)</span>
<span class="lineno">35 </span>  <span class="p">(</span><span class="nb">remainder </span><span class="p">(</span><span class="nf">fast-expt</span> <span class="nv">base</span> <span class="nv">exp</span><span class="p">)</span> <span class="nv">m</span><span class="p">))</span>
<span class="lineno">36 </span><span class="c1">;; тут мы сначала вычисляем экспоненту, с числами навроде 100**1000000007</span>
<span class="lineno">37 </span><span class="c1">;; умножение и возведение в квадрат на таких больших числах приводит к росту времени, алгоритм у нас по прежнему имеет лагорифмическую оценку по подсчету экспоненты, но порядок цифр таков, что обычное умножение требует больгих ресурсов компьютера.</span>
</pre>
</div>  </div>
 </div>
 <div class="chapter-block">
  <h2>
   Упражнение 1.26
  </h2>
  <div>
   <div>
    <p>
     Луи изменил процедуру expmod как приведено ниже.
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno">1 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">expmod</span> <span class="nv">base</span> <span class="nv">exp</span> <span class="nv">m</span><span class="p">)</span>
<span class="lineno">2 </span>  <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">= </span><span class="nv">exp</span> <span class="mi">0</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span>
<span class="lineno">3 </span>        <span class="p">((</span><span class="nb">even? </span><span class="nv">exp</span><span class="p">)</span>
<span class="lineno">4 </span>         <span class="p">(</span><span class="nb">remainder </span><span class="p">(</span><span class="nb">* </span><span class="p">(</span><span class="nf">expmod</span> <span class="nv">base</span> <span class="p">(</span><span class="nb">/ </span><span class="nv">exp</span> <span class="mi">2</span><span class="p">)</span> <span class="nv">m</span><span class="p">)</span>
<span class="lineno">5 </span>                       <span class="p">(</span><span class="nf">expmod</span> <span class="nv">base</span> <span class="p">(</span><span class="nb">/ </span><span class="nv">exp</span> <span class="mi">2</span><span class="p">)</span> <span class="nv">m</span><span class="p">))</span>
<span class="lineno">6 </span>                    <span class="nv">m</span><span class="p">))</span>
<span class="lineno">7 </span>        <span class="p">(</span><span class="nf">else</span>
<span class="lineno">8 </span>         <span class="p">(</span><span class="nb">remainder </span><span class="p">(</span><span class="nb">* </span><span class="nv">base</span> <span class="p">(</span><span class="nf">expmod</span> <span class="nv">base</span> <span class="p">(</span><span class="nb">- </span><span class="nv">exp</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">m</span><span class="p">))</span>
<span class="lineno">9 </span>                    <span class="nv">m</span><span class="p">))))</span>
</pre>
</div>   <div>
    <p>
     Его тест с fast-prime? стал работать медленнее теста prime? Записав процедуру таким образом мы изменили порядок роста <span class="inline-formula"><img class="img-inline-formula img-formula" width="69" height="17" src="formulae/1x5T1vUP00ZqvVjCivgudKxH94n8CzR8J2yhGg.png" alt="\theta(log(n))" title="\theta(log(n))"></span> на <span class="inline-formula"><img class="img-inline-formula img-formula" width="32" height="17" src="formulae/cCSlLH6spWmUZ.yEu3RFI4JpEISlQpO3e_iouA.png" alt="\theta(n)" title="\theta(n)"></span>. Поясните.
    </p>
    <p>
     На каждой итерации (вернее через одну) мы сокращаем показатель экспоненты в два раза, но при этом мы увеличиваем количество операций в два раза. И таких шагов будет порядка n. То есть порядок роста данной процедуры будет <span class="inline-formula"><img class="img-inline-formula img-formula" width="125" height="17" src="formulae/l0_g5HESpbwL51Bg3kOuV1NK6d.gEU49UQiD0w.png" alt="\theta(log(2^n) = \theta(n)" title="\theta(log(2^n) = \theta(n)"></span>.
    </p>
   </div>
  </div>
 </div>
 <div class="chapter-block">
  <h2>
   Упражнение 1.27
  </h2>
  <div>
   <div>
    <p>
     Продемонстрируйте что числа Кармайкла действительно проходят тест Фрема. Напишите процедуру которая принимает целое и тестуриует все числе &lt; n.
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno"> 1 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">fermat-test-all</span> <span class="nv">n</span><span class="p">)</span>
<span class="lineno"> 2 </span>  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">iter-test</span> <span class="nv">a</span><span class="p">)</span>
<span class="lineno"> 3 </span>    <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">&gt;= </span><span class="nv">a</span> <span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nb">display </span><span class="s">"passed full fermat"</span><span class="p">))</span>
<span class="lineno"> 4 </span>          <span class="p">((</span><span class="nb">= </span><span class="p">(</span><span class="nf">expmod</span> <span class="nv">a</span> <span class="nv">n</span> <span class="nv">n</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span> <span class="p">(</span><span class="nf">iter-test</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">a</span> <span class="mi">1</span><span class="p">)))</span>
<span class="lineno"> 5 </span>          <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">display </span><span class="s">"Ferma test failed"</span><span class="p">))))</span>
<span class="lineno"> 6 </span>  <span class="p">(</span><span class="nf">iter-test</span> <span class="mi">2</span><span class="p">))</span>
<span class="lineno"> 7 </span>
<span class="lineno"> 8 </span><span class="p">(</span><span class="nf">fermat-test-all</span> <span class="mi">561</span><span class="p">)</span>  <span class="c1">; passed full fermat</span>
<span class="lineno"> 9 </span><span class="p">(</span><span class="nf">fermat-test-all</span> <span class="mi">1105</span><span class="p">)</span> <span class="c1">; passed full fermat</span>
<span class="lineno">10 </span><span class="p">(</span><span class="nf">fermat-test-all</span> <span class="mi">1729</span><span class="p">)</span> <span class="c1">; passed full fermat</span>
<span class="lineno">11 </span><span class="p">(</span><span class="nf">fermat-test-all</span> <span class="mi">2465</span><span class="p">)</span> <span class="c1">; passed full fermat</span>
<span class="lineno">12 </span><span class="p">(</span><span class="nf">fermat-test-all</span> <span class="mi">2821</span><span class="p">)</span> <span class="c1">; passed full fermat</span>
<span class="lineno">13 </span><span class="p">(</span><span class="nf">fermat-test-all</span> <span class="mi">6601</span><span class="p">)</span> <span class="c1">; passed full fermat</span>
</pre>
</div>  </div>
 </div>
 <div class="chapter-block">
  <h2>
   Упражнение 1.28
  </h2>
  <div>
   <div>
    <p>
     Один из вариантов теста Ферма, который не может быть одурачен числами Кармайкла, называется тест Миллера-Рабина (Миллер 1976; Рабин 1980). Он отталкивается от альтернативной формы Малой Теоремы Ферма, которая говорит что, если n - простое число и есть положительное целое a меньшее n, тогда <span class="inline-formula"><img class="img-inline-formula img-formula" width="124" height="18" src="formulae/h1NxGLnmrm3jF.Dr5t2Dx3FVFJTQnTF5iXXiSQ.png" alt="a^{n-1} \equiv 1 mod(n)" title="a^{n-1} \equiv 1 mod(n)"></span>.
    </p>
    <p>
     Для тестирования простоты числа n, мы выбираем произвольный a &lt; n и возводим его в степень (n-1), берем молуль используя процедуру expmod.
    </p>
    <p>
     Каждый раз когда мы выполняем возведение в квадрат, мы делаем дополнительную проверку на "не тривиальность квадратного корня к 1 по модулю n", то есть число не равное 1 или n-1, квадрат которого равен 1 по модулю n. Возможно доказать что если есть нетривиальный квадратный корень сопоставимый с 1 mod n, тогда n не простое. Также возможно доказать что если n нечетное число, которое не является простым, то по крайне мере для половины чисел a&lt;n, вычисление <span class="inline-formula"><img class="img-inline-formula img-formula" width="36" height="14" src="formulae/DiMGXUF1qBWcScK6PAT_f9sf89ACJHw5efZfAg.png" alt="a^{n-1}" title="a^{n-1}"></span> таким образом выявит нетривиальный квадратный корень от 1 по модулю n. (Именно из-за этого уточнения числа Кармайкла отсеиваются). Измените процедуру expmod что бы в случае обнаружения нетривиального квадратного корня она сигнализировала об ошибке.
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno"> 1 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">expmod-miller-rabin</span> <span class="nv">base</span> <span class="nv">exp</span> <span class="nv">m</span><span class="p">)</span>
<span class="lineno"> 2 </span>  <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">= </span><span class="nv">exp</span> <span class="mi">0</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span>
<span class="lineno"> 3 </span>        <span class="p">((</span><span class="nb">even? </span><span class="nv">exp</span><span class="p">)</span>
<span class="lineno"> 4 </span>         <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">x</span> <span class="p">(</span><span class="nf">expmod-miller-rabin</span> <span class="nv">base</span> <span class="p">(</span><span class="nb">/ </span><span class="nv">exp</span> <span class="mi">2</span><span class="p">)</span> <span class="nv">m</span><span class="p">)))</span>
<span class="lineno"> 5 </span>           <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="k">or </span><span class="p">(</span><span class="nb">= </span><span class="nv">x</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nb">= </span><span class="nv">x</span> <span class="p">(</span><span class="nb">- </span><span class="nv">m</span> <span class="mi">1</span><span class="p">)))</span> <span class="p">(</span><span class="nb">remainder </span><span class="p">(</span><span class="nf">square</span> <span class="nv">x</span><span class="p">)</span> <span class="nv">m</span><span class="p">))</span>
<span class="lineno"> 6 </span>                 <span class="p">((</span><span class="nb">= </span><span class="p">(</span><span class="nb">remainder </span><span class="p">(</span><span class="nf">square</span> <span class="nv">x</span><span class="p">)</span> <span class="nv">m</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
<span class="lineno"> 7 </span>                 <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">remainder </span><span class="p">(</span><span class="nf">square</span> <span class="nv">x</span><span class="p">)</span> <span class="nv">m</span><span class="p">)))))</span>
<span class="lineno"> 8 </span>        <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">remainder </span><span class="p">(</span><span class="nb">* </span><span class="nv">base</span> <span class="p">(</span><span class="nf">expmod-miller-rabin</span> <span class="nv">base</span> <span class="p">(</span><span class="nb">- </span><span class="nv">exp</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">m</span><span class="p">))</span>
<span class="lineno"> 9 </span>                         <span class="nv">m</span><span class="p">))))</span>
<span class="lineno">10 </span>
<span class="lineno">11 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">miller-rabin-test-all</span> <span class="nv">n</span><span class="p">)</span>
<span class="lineno">12 </span>  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">iter-test</span> <span class="nv">a</span><span class="p">)</span>
<span class="lineno">13 </span>    <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">&gt;= </span><span class="nv">a</span> <span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nb">display </span><span class="s">"passed full miller-rabin test"</span><span class="p">))</span>
<span class="lineno">14 </span>          <span class="p">((</span><span class="nb">= </span><span class="p">(</span><span class="nf">expmod-miller-rabin</span> <span class="nv">a</span> <span class="nv">n</span> <span class="nv">n</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span> <span class="p">(</span><span class="nf">iter-test</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">a</span> <span class="mi">1</span><span class="p">)))</span>
<span class="lineno">15 </span>          <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">display </span><span class="s">"miller-rabin test failed"</span><span class="p">))))</span>
<span class="lineno">16 </span>  <span class="p">(</span><span class="nf">iter-test</span> <span class="mi">2</span><span class="p">))</span>
<span class="lineno">17 </span>
<span class="lineno">18 </span><span class="p">(</span><span class="nf">miller-rabin-test-all</span> <span class="mi">1999</span><span class="p">)</span> <span class="c1">;;  passed full miller-rabin test</span>
<span class="lineno">19 </span><span class="p">(</span><span class="nf">miller-rabin-test-all</span> <span class="mi">561</span><span class="p">)</span> <span class="c1">;;  miller-rabin test failed</span>
</pre>
</div>  </div>
 </div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/sicp-uprazhneniia-120-124/" class="u-url">SICP Упражнения 1.20, 1.21, 1.22, 1.23, 1.24</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Velikii Nehochuha
            </span></p>
            <p class="dateline">
            <a href="posts/sicp-uprazhneniia-120-124/" rel="bookmark">
            <time class="published dt-published" datetime="2020-01-12T12:32:43+03:00" itemprop="datePublished" title="2020-01-12 12:32">2020-01-12 12:32</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div>
 <div class="chapter-block">
  <h2>
   Упражнение 1.20
  </h2>
  <div>
   <div>
    <p>
     Процесс который генерируется процедурой естественно зависит от правил интерпритатора. Как пример возьмем итеративную процецудуру нахождения наибольшего общего делителя приведенного выше. Предположим мы интерпритируем это процедуру используя "нормамальный порядок выполнения". Используя метод подстановки проиллюстрируйте процесс вычисления (gcd 206 40) и указать "reminder" операции которые реально выполняются. Сколько таких операций выполнится при "нормальном порядке" и сколько при "апликативном".
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno"> 1 </span><span class="c1">;; нормальный порядок</span>
<span class="lineno"> 2 </span><span class="p">(</span><span class="nb">gcd </span><span class="mi">206</span> <span class="mi">40</span><span class="p">)</span>
<span class="lineno"> 3 </span><span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="mi">40</span> <span class="mi">0</span><span class="p">))</span>
<span class="lineno"> 4 </span><span class="p">(</span><span class="nb">gcd </span><span class="mi">40</span> <span class="p">(</span><span class="nb">remainder </span><span class="mi">206</span> <span class="mi">40</span><span class="p">))</span>
<span class="lineno"> 5 </span><span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="p">(</span><span class="nb">remainder </span><span class="mi">206</span> <span class="mi">40</span><span class="p">)</span> <span class="mi">0</span><span class="p">))</span> <span class="c1">; 6 + 1 раз</span>
<span class="lineno"> 6 </span><span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="mi">6</span> <span class="mi">0</span><span class="p">))</span>
<span class="lineno"> 7 </span><span class="p">(</span><span class="nb">gcd </span><span class="p">(</span><span class="nb">remainder </span><span class="mi">206</span> <span class="mi">40</span><span class="p">)</span> <span class="p">(</span><span class="nb">remainder </span><span class="mi">40</span> <span class="p">(</span><span class="nb">remainder </span><span class="mi">206</span> <span class="mi">40</span><span class="p">)))</span>
<span class="lineno"> 8 </span><span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="p">(</span><span class="nb">remainder </span><span class="mi">40</span> <span class="p">(</span><span class="nb">remainder </span><span class="mi">206</span> <span class="mi">40</span><span class="p">))</span> <span class="mi">0</span><span class="p">))</span> <span class="c1">; 4 + 2 раза</span>
<span class="lineno"> 9 </span><span class="p">(</span><span class="nb">gcd </span><span class="p">(</span><span class="nb">remainder </span><span class="mi">40</span> <span class="p">(</span><span class="nb">remainder </span><span class="mi">206</span> <span class="mi">40</span><span class="p">))</span> <span class="p">(</span><span class="nb">remainder </span><span class="p">(</span><span class="nb">remainder </span><span class="mi">206</span> <span class="mi">40</span><span class="p">)</span> <span class="p">(</span><span class="nb">remainder </span><span class="mi">40</span> <span class="p">(</span><span class="nb">remainder </span><span class="mi">206</span> <span class="mi">40</span><span class="p">))))</span>
<span class="lineno">10 </span><span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="p">(</span><span class="nb">remainder </span><span class="p">(</span><span class="nb">remainder </span><span class="mi">206</span> <span class="mi">40</span><span class="p">)</span> <span class="p">(</span><span class="nb">remainder </span><span class="mi">40</span> <span class="p">(</span><span class="nb">remainder </span><span class="mi">206</span> <span class="mi">40</span><span class="p">)))</span> <span class="mi">0</span><span class="p">))</span> <span class="c1">; 2 + 4 раза</span>
<span class="lineno">11 </span><span class="p">(</span><span class="nb">gcd </span><span class="p">(</span><span class="nb">remainder </span><span class="p">(</span><span class="nb">remainder </span><span class="mi">206</span> <span class="mi">40</span><span class="p">)</span> <span class="p">(</span><span class="nb">remainder </span><span class="mi">40</span> <span class="p">(</span><span class="nb">remainder </span><span class="mi">206</span> <span class="mi">40</span><span class="p">)))</span> <span class="p">(</span><span class="nb">remainder </span><span class="p">(</span><span class="nb">remainder </span><span class="mi">40</span> <span class="p">(</span><span class="nb">remainder </span><span class="mi">206</span> <span class="mi">40</span><span class="p">))</span> <span class="p">(</span><span class="nb">remainder </span><span class="p">(</span><span class="nb">remainder </span><span class="mi">206</span> <span class="mi">40</span><span class="p">)</span> <span class="p">(</span><span class="nb">remainder </span><span class="mi">40</span> <span class="p">(</span><span class="nb">remainder </span><span class="mi">206</span> <span class="mi">40</span><span class="p">)))))</span>
<span class="lineno">12 </span><span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="p">(</span><span class="nf">reminder</span> <span class="p">(</span><span class="nb">remainder </span><span class="mi">40</span> <span class="p">(</span><span class="nb">remainder </span><span class="mi">206</span> <span class="mi">40</span><span class="p">))</span> <span class="p">(</span><span class="nb">remainder </span><span class="p">(</span><span class="nb">remainder </span><span class="mi">206</span> <span class="mi">40</span><span class="p">)</span> <span class="p">(</span><span class="nb">remainder </span><span class="mi">40</span> <span class="p">(</span><span class="nb">remainder </span><span class="mi">206</span> <span class="mi">40</span><span class="p">))))</span> <span class="mi">0</span><span class="p">))</span><span class="c1">; 0; + 7 раз</span>
<span class="lineno">13 </span><span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="mi">0</span> <span class="mi">0</span><span class="p">)</span> <span class="o">...</span><span class="p">)</span>
<span class="lineno">14 </span><span class="p">(</span><span class="nb">remainder </span><span class="p">(</span><span class="nb">remainder </span><span class="mi">206</span> <span class="mi">40</span><span class="p">)</span> <span class="p">(</span><span class="nb">remainder </span><span class="mi">40</span> <span class="p">(</span><span class="nb">remainder </span><span class="mi">206</span> <span class="mi">40</span><span class="p">)))</span> <span class="c1">;; 4 раза</span>
<span class="lineno">15 </span><span class="c1">;; 18 вычислений reminder</span>
<span class="lineno">16 </span><span class="c1">;; при апликативной форме этих вычислений всего 4</span>
</pre>
</div>   <div>
    <p>
     Вывод: при normal-order-evaluation 18 вызовов reminder, при applicative-order-evaluation 4.
    </p>
   </div>
  </div>
 </div>
 <div class="chapter-block">
  <h2>
   Упражнение 1.21
  </h2>
  <div>
   <div>
    <p>
     Используя процедуру "smallest-divisor" Найдите наиментший делитель для 199б 1999, 19999
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno"> 1 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">smallest-divisor</span> <span class="nv">n</span><span class="p">)</span>
<span class="lineno"> 2 </span>  <span class="p">(</span><span class="nf">find-divisor</span> <span class="nv">n</span> <span class="mi">2</span><span class="p">))</span>
<span class="lineno"> 3 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">find-divisor</span> <span class="nv">n</span> <span class="nv">test-divisor</span><span class="p">)</span>
<span class="lineno"> 4 </span>  <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">&gt; </span><span class="p">(</span><span class="nf">square</span> <span class="nv">test-divisor</span><span class="p">)</span> <span class="nv">n</span><span class="p">)</span> <span class="nv">n</span><span class="p">)</span>
<span class="lineno"> 5 </span>        <span class="p">((</span><span class="nf">divides?</span> <span class="nv">test-divisor</span> <span class="nv">n</span><span class="p">)</span> <span class="nv">test-divisor</span><span class="p">)</span>
<span class="lineno"> 6 </span>        <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">find-divisor</span> <span class="nv">n</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">test-divisor</span> <span class="mi">1</span><span class="p">)))))</span>
<span class="lineno"> 7 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">divides?</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
<span class="lineno"> 8 </span>  <span class="p">(</span><span class="nb">= </span><span class="p">(</span><span class="nb">remainder </span><span class="nv">b</span> <span class="nv">a</span><span class="p">)</span> <span class="mi">0</span><span class="p">))</span>
<span class="lineno"> 9 </span>
<span class="lineno">10 </span><span class="p">(</span><span class="nf">smallest-divisor</span> <span class="mi">199</span><span class="p">)</span> <span class="c1">; 199</span>
<span class="lineno">11 </span><span class="p">(</span><span class="nf">smallest-divisor</span> <span class="mi">1999</span><span class="p">)</span> <span class="c1">; 1999</span>
<span class="lineno">12 </span><span class="p">(</span><span class="nf">smallest-divisor</span> <span class="mi">19999</span><span class="p">)</span> <span class="c1">; 7</span>
</pre>
</div>  </div>
 </div>
 <div class="chapter-block">
  <h2>
   Упражнение 1.22
  </h2>
  <div>
   <div>
    <p>
     Большинство реализаций lisp включаются примитиву runtime, которая возвращает время работы системы. Ниже написана процедура которое замеряет время теста на простоту. Используя ей, напишите процедуру search-for-primes, которая проверяет простоту последовательных нечетных целых в заданном диапазоне. Используйте её чтобы найти 3 простых &gt; 1000; &gt; 10 000; &gt; 100 000; &gt; 1 000 000. Замерьте время для проверки каждого простого числа. Так как тестирующий алгоритм имеет порядок роста <span class="inline-formula"><img class="img-inline-formula img-formula" width="47" height="18" src="formulae/Fm5mrdojcg8nfk0moVZWNPpDRW6kuON6Rr83Gg.png" alt="\theta(\sqrt{n})" title="\theta(\sqrt{n})"></span>, вы должны ожидать получить для время для 10 000 в <span class="inline-formula"><img class="img-inline-formula img-formula" width="32" height="18" src="formulae/stpajtmjWkASRa_Px.gSazh7yZYs.WaF43zFUg.png" alt="\sqrt{10}" title="\sqrt{10}"></span> больше времени чем для 1 000. Посмотрите как работает это соотношение для разных диапазонов n.
    </p>
    <p>
     Запись кривовата, потому что нет конструкции (let или progn как в emacs lisp, просто их еще не было в курсе). Тенденция <span class="inline-formula"><img class="img-inline-formula img-formula" width="33" height="18" src="formulae/R5RobS5u6di.UD.78_HWXVOLw_0Y2cnEpyVVEQ.png" alt="\theta{\sqrt{n}}" title="\theta{\sqrt{n}}"></span> начинает походить на оценку только с 10 000 000. До этого все данные совпадают и нет прироста.
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno"> 1 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">report-prime</span> <span class="nv">start-time</span> <span class="nv">end-time</span><span class="p">)</span>
<span class="lineno"> 2 </span>  <span class="p">(</span><span class="nf">newline</span><span class="p">)</span>
<span class="lineno"> 3 </span>  <span class="p">(</span><span class="nb">display </span><span class="s">" *** "</span><span class="p">)</span>
<span class="lineno"> 4 </span>  <span class="p">(</span><span class="nb">display </span><span class="nv">start-time</span><span class="p">)</span>
<span class="lineno"> 5 </span>  <span class="p">(</span><span class="nb">display </span><span class="s">"; "</span><span class="p">)</span>
<span class="lineno"> 6 </span>  <span class="p">(</span><span class="nb">display </span><span class="nv">end-time</span><span class="p">)</span>
<span class="lineno"> 7 </span>  <span class="p">(</span><span class="nb">display </span><span class="s">"; "</span><span class="p">)</span>
<span class="lineno"> 8 </span>  <span class="p">(</span><span class="nb">display </span><span class="p">(</span><span class="nb">- </span><span class="nv">end-time</span> <span class="nv">start-time</span><span class="p">)))</span>
<span class="lineno"> 9 </span>
<span class="lineno">10 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">prime?</span> <span class="nv">n</span><span class="p">)</span>
<span class="lineno">11 </span>  <span class="p">(</span><span class="nb">= </span><span class="nv">n</span> <span class="p">(</span><span class="nf">smallest-divisor</span> <span class="nv">n</span><span class="p">)))</span>
<span class="lineno">12 </span>
<span class="lineno">13 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">search-iter</span> <span class="nv">from</span> <span class="nv">number</span> <span class="nv">start-time</span><span class="p">)</span>
<span class="lineno">14 </span>  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nb">= </span><span class="nv">number</span> <span class="mi">0</span><span class="p">))</span>
<span class="lineno">15 </span>      <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">prime?</span> <span class="nv">from</span><span class="p">)</span>
<span class="lineno">16 </span>          <span class="p">(</span><span class="nf">report-and-continue</span> <span class="nv">from</span> <span class="nv">number</span> <span class="nv">start-time</span> <span class="p">(</span><span class="nf">runtime</span><span class="p">))</span>
<span class="lineno">17 </span>          <span class="p">(</span><span class="nf">search-iter</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">from</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">number</span> <span class="nv">start-time</span><span class="p">))))</span>
<span class="lineno">18 </span>
<span class="lineno">19 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">report-and-continue</span> <span class="nv">from</span> <span class="nv">number</span> <span class="nv">start-time</span> <span class="nv">end-time</span><span class="p">)</span>
<span class="lineno">20 </span>  <span class="p">(</span><span class="nf">newline</span><span class="p">)</span>
<span class="lineno">21 </span>  <span class="p">(</span><span class="nb">display </span><span class="nv">from</span><span class="p">)</span>
<span class="lineno">22 </span>  <span class="p">(</span><span class="nf">newline</span><span class="p">)</span>
<span class="lineno">23 </span>  <span class="p">(</span><span class="nf">report-prime</span> <span class="nv">start-time</span> <span class="nv">end-time</span><span class="p">)</span>
<span class="lineno">24 </span>  <span class="p">(</span><span class="nf">search-iter</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">from</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nb">- </span><span class="nv">number</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">start-time</span><span class="p">))</span>
<span class="lineno">25 </span>
<span class="lineno">26 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">search-for-primes</span> <span class="nv">from</span> <span class="nv">number</span><span class="p">)</span>
<span class="lineno">27 </span>  <span class="p">(</span><span class="nf">search-iter</span> <span class="nv">from</span> <span class="nv">number</span> <span class="p">(</span><span class="nf">runtime</span><span class="p">)))</span>
<span class="lineno">28 </span>
<span class="lineno">29 </span><span class="p">(</span><span class="nf">search-for-primes</span> <span class="mi">1000</span> <span class="mi">3</span><span class="p">)</span>
<span class="lineno">30 </span><span class="p">(</span><span class="nf">search-for-primes</span> <span class="mi">10000</span> <span class="mi">3</span><span class="p">)</span>
<span class="lineno">31 </span><span class="p">(</span><span class="nf">search-for-primes</span> <span class="mi">100000</span> <span class="mi">3</span><span class="p">)</span>
<span class="lineno">32 </span><span class="p">(</span><span class="nf">search-for-primes</span> <span class="mi">1000000</span> <span class="mi">3</span><span class="p">)</span>
<span class="lineno">33 </span><span class="p">(</span><span class="nf">search-for-primes</span> <span class="mi">10000000</span> <span class="mi">3</span><span class="p">)</span>
<span class="lineno">34 </span><span class="p">(</span><span class="nf">search-for-primes</span> <span class="mi">100000000</span> <span class="mi">3</span><span class="p">)</span>
</pre>
</div>   <div class="center-block">
    <p>
     </p>
<div class="tabular-wrapper"><table>
<tr>
<td class="cell-lt" style="text-align: left;">1009 </td>
<td class="cell-lrt" style="text-align: center;"> 0. </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">1013 </td>
<td class="cell-lrt" style="text-align: center;"> 1.0000000000001563e-2 </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">1019 </td>
<td class="cell-lrt" style="text-align: center;"> 1.0000000000001563e-2 </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">10007 </td>
<td class="cell-lrt" style="text-align: center;"> 0. </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">10009 </td>
<td class="cell-lrt" style="text-align: center;"> .00999999999999801 </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">10037 </td>
<td class="cell-lrt" style="text-align: center;"> 1.9999999999999574e-2 </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">100003 </td>
<td class="cell-lrt" style="text-align: center;"> 0. </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">100019 </td>
<td class="cell-lrt" style="text-align: center;"> 1.0000000000001563e-2 </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">100043 </td>
<td class="cell-lrt" style="text-align: center;"> 1.9999999999999574e-2 </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">1000003 </td>
<td class="cell-lrt" style="text-align: center;"> 0. </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">1000033 </td>
<td class="cell-lrt" style="text-align: center;"> 1.0000000000001563e-2 </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">1000037 </td>
<td class="cell-lrt" style="text-align: center;"> 1.9999999999999574e-2 </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">10000019 </td>
<td class="cell-lrt" style="text-align: center;"> .00999999999999801 </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">10000079 </td>
<td class="cell-lrt" style="text-align: center;"> .03999999999999915 </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">10000103 </td>
<td class="cell-lrt" style="text-align: center;"> .05999999999999872 </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">100000007 </td>
<td class="cell-lrt" style="text-align: center;"> .03999999999999915 </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">10000079 </td>
<td class="cell-lrt" style="text-align: center;"> .08999999999999986 </td>
</tr>
<tr>
<td class="cell-ltb" style="text-align: left;">10000103 </td>
<td class="cell-lrtb" style="text-align: center;"> .129999999999999 </td>
</tr>
</table></div>
    
   </div>
  </div>
 </div>
 <div class="chapter-block">
  <h2>
   Упражнение 1.23
  </h2>
  <div>
   <div>
    <p>
     Процедура smallest-divisor приведенная в начале главы выполняет много ненужных проверок. После проверки деления на 2, нет смысла делить на любые другие четные. То есть значениями для проверки должны быть не 2, 3, 4, 5, 6, ..., а 2, 3, 5, 7, 9, ....
    </p>
    <p>
     Сделайте это изменение реализовав процедуру next, которая вернет 3 если на вход получили 2, в ином случае вернет входное значение плюс два. Измените smallest-divisor используя (next test-divisor) (+ test-divisor 1).
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno"> 1 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">smallest-divisor</span> <span class="nv">n</span><span class="p">)</span>
<span class="lineno"> 2 </span>  <span class="p">(</span><span class="nf">find-divisor</span> <span class="nv">n</span> <span class="mi">2</span><span class="p">))</span>
<span class="lineno"> 3 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">next</span> <span class="nv">n</span><span class="p">)</span>
<span class="lineno"> 4 </span>  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="nv">n</span> <span class="mi">2</span><span class="p">)</span>
<span class="lineno"> 5 </span>      <span class="mi">3</span>
<span class="lineno"> 6 </span>      <span class="p">(</span><span class="nb">+ </span><span class="nv">n</span> <span class="mi">2</span><span class="p">)))</span>
<span class="lineno"> 7 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">find-divisor</span> <span class="nv">n</span> <span class="nv">test-divisor</span><span class="p">)</span>
<span class="lineno"> 8 </span>  <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">&gt; </span><span class="p">(</span><span class="nf">square</span> <span class="nv">test-divisor</span><span class="p">)</span> <span class="nv">n</span><span class="p">)</span> <span class="nv">n</span><span class="p">)</span>
<span class="lineno"> 9 </span>        <span class="p">((</span><span class="nf">divides?</span> <span class="nv">test-divisor</span> <span class="nv">n</span><span class="p">)</span> <span class="nv">test-divisor</span><span class="p">)</span>
<span class="lineno">10 </span>        <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">find-divisor</span> <span class="nv">n</span> <span class="p">(</span><span class="nf">next</span> <span class="nv">test-divisor</span><span class="p">)))))</span>
<span class="lineno">11 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">divides?</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
<span class="lineno">12 </span>  <span class="p">(</span><span class="nb">= </span><span class="p">(</span><span class="nb">remainder </span><span class="nv">b</span> <span class="nv">a</span><span class="p">)</span> <span class="mi">0</span><span class="p">))</span>
</pre>
</div>   <div>
    <p>
     Повторите тест из 1.22
    </p>
    <div class="center-block">
     <p>
      </p>
<div class="tabular-wrapper"><table>
<tr>
<td class="cell-lt" style="text-align: left;">1009 </td>
<td class="cell-lrt" style="text-align: center;"> 0. </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">1013 </td>
<td class="cell-lrt" style="text-align: center;"> 0. </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">1019 </td>
<td class="cell-lrt" style="text-align: center;"> 1.0000000000001563e-2 </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">10007 </td>
<td class="cell-lrt" style="text-align: center;"> 0. </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">10009 </td>
<td class="cell-lrt" style="text-align: center;"> 0. </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">10037 </td>
<td class="cell-lrt" style="text-align: center;"> 1.0000000000001563e-2 </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">100003 </td>
<td class="cell-lrt" style="text-align: center;"> 0. </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">100019 </td>
<td class="cell-lrt" style="text-align: center;"> 1.0000000000001563e-2 </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">100043 </td>
<td class="cell-lrt" style="text-align: center;"> 1.9999999999999574e-2 </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">1000003 </td>
<td class="cell-lrt" style="text-align: center;"> 0. </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">1000033 </td>
<td class="cell-lrt" style="text-align: center;"> 1.0000000000001563e-2 </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">1000037 </td>
<td class="cell-lrt" style="text-align: center;"> 2.0000000000003126e-2 </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">10000019 </td>
<td class="cell-lrt" style="text-align: center;"> .0 </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">10000079 </td>
<td class="cell-lrt" style="text-align: center;"> 1.9999999999999574e-2 </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">10000103 </td>
<td class="cell-lrt" style="text-align: center;"> 3.0000000000001137e-2 </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">100000007 </td>
<td class="cell-lrt" style="text-align: center;"> 1.9999999999999574e-2 </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">100000037 </td>
<td class="cell-lrt" style="text-align: center;"> .05000000000000071 </td>
</tr>
<tr>
<td class="cell-ltb" style="text-align: left;">100000039 </td>
<td class="cell-lrtb" style="text-align: center;"> .07000000000000028 </td>
</tr>
</table></div>
     
    </div>
    <p>
     Во многих случаях уменьшилось в два раза.
    </p>
   </div>
  </div>
 </div>
 <div class="chapter-block">
  <h2>
   Упражнение 1.24
  </h2>
  <div>
   <div>
    <p>
     Измените процедуру timed-prime-test из 1.22 что бы она использовала fast-prime? (метод Ферма), протестируйте 12 чисел которые были найдены в упражнении 1.22. Сравните время проверки. Так как тест Ферма имеет порядок роста (log n), каково ожидание по времени для чисел около 1,000,000 в сравнении с числами около 1000? Подтвержают ли это ваши данные? Можете объяснить несоответствия, которые найдете?
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno"> 1 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">smallest-divisor</span> <span class="nv">n</span><span class="p">)</span>
<span class="lineno"> 2 </span>  <span class="p">(</span><span class="nf">find-divisor</span> <span class="nv">n</span> <span class="mi">2</span><span class="p">))</span>
<span class="lineno"> 3 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">next</span> <span class="nv">n</span><span class="p">)</span>
<span class="lineno"> 4 </span>  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="nv">n</span> <span class="mi">2</span><span class="p">)</span>
<span class="lineno"> 5 </span>      <span class="mi">3</span>
<span class="lineno"> 6 </span>      <span class="p">(</span><span class="nb">+ </span><span class="nv">n</span> <span class="mi">2</span><span class="p">)))</span>
<span class="lineno"> 7 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">find-divisor</span> <span class="nv">n</span> <span class="nv">test-divisor</span><span class="p">)</span>
<span class="lineno"> 8 </span>  <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">&gt; </span><span class="p">(</span><span class="nf">square</span> <span class="nv">test-divisor</span><span class="p">)</span> <span class="nv">n</span><span class="p">)</span> <span class="nv">n</span><span class="p">)</span>
<span class="lineno"> 9 </span>        <span class="p">((</span><span class="nf">divides?</span> <span class="nv">test-divisor</span> <span class="nv">n</span><span class="p">)</span> <span class="nv">test-divisor</span><span class="p">)</span>
<span class="lineno">10 </span>        <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">find-divisor</span> <span class="nv">n</span> <span class="p">(</span><span class="nf">next</span> <span class="nv">test-divisor</span><span class="p">)))))</span>
<span class="lineno">11 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">divides?</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
<span class="lineno">12 </span>  <span class="p">(</span><span class="nb">= </span><span class="p">(</span><span class="nb">remainder </span><span class="nv">b</span> <span class="nv">a</span><span class="p">)</span> <span class="mi">0</span><span class="p">))</span>
</pre>
</div>   <div>
    <p>
     для диапазанов &lt; 10,000,000 время проверки по исходному тесту было .0, поэтому я добавил еще один диапазон и протестировал сначала старую функцию timed-prime-test
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno"> 1 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">10000019</span><span class="p">)</span><span class="c1">; 1.0000000000001563e-2</span>
<span class="lineno"> 2 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">10000079</span><span class="p">)</span><span class="c1">; 1.0000000000001563e-2</span>
<span class="lineno"> 3 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">10000103</span><span class="p">)</span><span class="c1">; 1.0000000000001563e-2</span>
<span class="lineno"> 4 </span>
<span class="lineno"> 5 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">100000007</span><span class="p">)</span><span class="c1">; 1.9999999999999574e-2</span>
<span class="lineno"> 6 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">100000037</span><span class="p">)</span><span class="c1">; 2.0000000000003126e-2</span>
<span class="lineno"> 7 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">100000039</span><span class="p">)</span><span class="c1">; 2.0000000000003126e-2</span>
<span class="lineno"> 8 </span>
<span class="lineno"> 9 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">1000000007</span><span class="p">)</span><span class="c1">; .05000000000000071</span>
<span class="lineno">10 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">1000000009</span><span class="p">)</span><span class="c1">; .05999999999999872</span>
<span class="lineno">11 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">1000000021</span><span class="p">)</span><span class="c1">; .07000000000000028</span>
</pre>
</div>   <div>
    <p>
     результаты выполнения теста между 1 и 2 диапазоном &lt; <span class="inline-formula"><img class="img-inline-formula img-formula" width="32" height="18" src="formulae/stpajtmjWkASRa_Px.gSazh7yZYs.WaF43zFUg.png" alt="\sqrt{10}" title="\sqrt{10}"></span> между 2 и 3 приближенно равны ему.
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno"> 1 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">10000019</span><span class="p">)</span><span class="c1">; 1.0000000000001563e-2</span>
<span class="lineno"> 2 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">10000079</span><span class="p">)</span><span class="c1">; 1.0000000000001563e-2</span>
<span class="lineno"> 3 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">10000103</span><span class="p">)</span><span class="c1">; 1.0000000000001563e-2</span>
<span class="lineno"> 4 </span>
<span class="lineno"> 5 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">100000007</span><span class="p">)</span><span class="c1">; 1.9999999999999574e-2</span>
<span class="lineno"> 6 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">100000037</span><span class="p">)</span><span class="c1">; 2.0000000000003126e-2</span>
<span class="lineno"> 7 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">100000039</span><span class="p">)</span><span class="c1">; 2.0000000000003126e-2</span>
<span class="lineno"> 8 </span>
<span class="lineno"> 9 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">1000000007</span><span class="p">)</span><span class="c1">; .05000000000000071</span>
<span class="lineno">10 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">1000000009</span><span class="p">)</span><span class="c1">; .05999999999999872</span>
<span class="lineno">11 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">1000000021</span><span class="p">)</span><span class="c1">; .07000000000000028</span>
</pre>
</div>   <div>
    <p>
     после этого переписал через fast-prime, время теста зависит от количества проверок
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno"> 1 </span><span class="c1">; c 10 проверками</span>
<span class="lineno"> 2 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">10000019</span><span class="p">)</span><span class="c1">; 0.</span>
<span class="lineno"> 3 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">10000079</span><span class="p">)</span><span class="c1">; 0.</span>
<span class="lineno"> 4 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">10000103</span><span class="p">)</span><span class="c1">; .00999999999999801</span>
<span class="lineno"> 5 </span>
<span class="lineno"> 6 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">100000007</span><span class="p">)</span><span class="c1">; 0.</span>
<span class="lineno"> 7 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">100000037</span><span class="p">)</span><span class="c1">; .00999999999999801</span>
<span class="lineno"> 8 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">100000039</span><span class="p">)</span><span class="c1">; .00999999999999801</span>
<span class="lineno"> 9 </span>
<span class="lineno">10 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">1000000007</span><span class="p">)</span><span class="c1">; 1.0000000000001563e-2</span>
<span class="lineno">11 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">1000000009</span><span class="p">)</span><span class="c1">; 1.0000000000001563e-2</span>
<span class="lineno">12 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">1000000021</span><span class="p">)</span><span class="c1">; 1.0000000000001563e-2</span>
<span class="lineno">13 </span>
<span class="lineno">14 </span><span class="c1">; с 1000 проверками</span>
<span class="lineno">15 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">10000019</span><span class="p">)</span><span class="c1">; .1999999999999993</span>
<span class="lineno">16 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">10000079</span><span class="p">)</span><span class="c1">; .20000000000000284</span>
<span class="lineno">17 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">10000103</span><span class="p">)</span><span class="c1">; .21999999999999886</span>
<span class="lineno">18 </span>
<span class="lineno">19 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">100000007</span><span class="p">)</span><span class="c1">; .23000000000000043</span>
<span class="lineno">20 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">100000037</span><span class="p">)</span><span class="c1">; .23999999999999844</span>
<span class="lineno">21 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">100000039</span><span class="p">)</span><span class="c1">; .240000000000002</span>
<span class="lineno">22 </span>
<span class="lineno">23 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">1000000007</span><span class="p">)</span><span class="c1">; .2699999999999996</span>
<span class="lineno">24 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">1000000009</span><span class="p">)</span><span class="c1">; .26000000000000156</span>
<span class="lineno">25 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">1000000021</span><span class="p">)</span><span class="c1">; .259999999999998</span>
</pre>
</div>   <div>
    <p>
     оба тесты похожи на линейный прирост времени.
    </p>
   </div>
  </div>
 </div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/sicp-uprazhnenie-114/" class="u-url">SICP Упражнения 1.14, 1.15, 1.16, 1.17.</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Velikii Nehochuha
            </span></p>
            <p class="dateline">
            <a href="posts/sicp-uprazhnenie-114/" rel="bookmark">
            <time class="published dt-published" datetime="2020-01-11T14:54:25+03:00" itemprop="datePublished" title="2020-01-11 14:54">2020-01-11 14:54</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div>
 <div class="chapter-block">
  <h2>
   Упражнение 1.14
  </h2>
  <div>
   <div class="section-block">
    <h3>
     Изобразите дерево иллюстрирующее процесс процедуры count-charge из секции 1.22 для 11 центов.
    </h3>
    <div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno"> 1 </span><span class="c1">;; Example: Counting change</span>
<span class="lineno"> 2 </span><span class="c1">;; Сколькими способами мы можем внесни изменение в сумму</span>
<span class="lineno"> 3 </span><span class="c1">;; если у нас есть монеты 50 25 10 5 и 1 центов.</span>
<span class="lineno"> 4 </span><span class="c1">;; Есть простое решение через рекурсивную процедуру</span>
<span class="lineno"> 5 </span><span class="c1">;; если a = 0 1 способ внести изменение</span>
<span class="lineno"> 6 </span><span class="c1">;; если a &lt; 0 0 способов</span>
<span class="lineno"> 7 </span><span class="c1">;; если n = 0, 0 способов внести изменение</span>
<span class="lineno"> 8 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">count-change</span> <span class="nv">amount</span><span class="p">)</span>
<span class="lineno"> 9 </span>  <span class="p">(</span><span class="nf">cc</span> <span class="nv">amount</span> <span class="mi">5</span><span class="p">))</span>
<span class="lineno">10 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">first-denomination</span> <span class="nv">kinds-of-coins</span><span class="p">)</span>
<span class="lineno">11 </span>  <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">= </span><span class="nv">kinds-of-coins</span> <span class="mi">1</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span>
<span class="lineno">12 </span>        <span class="p">((</span><span class="nb">= </span><span class="nv">kinds-of-coins</span> <span class="mi">2</span><span class="p">)</span> <span class="mi">5</span><span class="p">)</span>
<span class="lineno">13 </span>        <span class="p">((</span><span class="nb">= </span><span class="nv">kinds-of-coins</span> <span class="mi">3</span><span class="p">)</span> <span class="mi">10</span><span class="p">)</span>
<span class="lineno">14 </span>        <span class="p">((</span><span class="nb">= </span><span class="nv">kinds-of-coins</span> <span class="mi">4</span><span class="p">)</span> <span class="mi">25</span><span class="p">)</span>
<span class="lineno">15 </span>        <span class="p">((</span><span class="nb">= </span><span class="nv">kinds-of-coins</span> <span class="mi">5</span><span class="p">)</span> <span class="mi">50</span><span class="p">)))</span>
<span class="lineno">16 </span>
<span class="lineno">17 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">cc</span> <span class="nv">amount</span> <span class="nv">kinds-of-coins</span><span class="p">)</span>
<span class="lineno">18 </span>  <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">= </span><span class="nv">amount</span> <span class="mi">0</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span>
<span class="lineno">19 </span>        <span class="p">((</span><span class="k">or </span><span class="p">(</span><span class="nb">&lt; </span><span class="nv">amount</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nb">= </span><span class="nv">kinds-of-coins</span> <span class="mi">0</span><span class="p">))</span> <span class="mi">0</span><span class="p">)</span>
<span class="lineno">20 </span>        <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">cc</span> <span class="nv">amount</span>
<span class="lineno">21 </span>                     <span class="p">(</span><span class="nb">- </span><span class="nv">kinds-of-coins</span> <span class="mi">1</span><span class="p">))</span> <span class="c1">;; изменение берем разные монетки</span>
<span class="lineno">22 </span>                 <span class="p">(</span><span class="nf">cc</span> <span class="p">(</span><span class="nb">- </span><span class="nv">amount</span>
<span class="lineno">23 </span>                        <span class="p">(</span><span class="nf">first-denomination</span> <span class="nv">kinds-of-coins</span><span class="p">))</span> <span class="c1">;; изменяем сумму на значение монетки</span>
<span class="lineno">24 </span>                     <span class="nv">kinds-of-coins</span><span class="p">)))))</span>
</pre>
</div>     <div>
      <p>
       Иттерируя можно себе представить что получится что-то вроде.
      </p>
     </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno"> 1 </span>                            <span class="p">(</span><span class="nf">cc</span> <span class="mi">11</span> <span class="mi">5</span><span class="p">)</span>
<span class="lineno"> 2 </span>                     <span class="p">(</span><span class="nf">cc</span> <span class="mi">11</span> <span class="mi">4</span><span class="p">)</span>     <span class="p">(</span><span class="nf">cc</span> <span class="mi">-39</span> <span class="mi">5</span><span class="p">)</span>
<span class="lineno"> 3 </span>                <span class="p">(</span><span class="nf">cc</span> <span class="mi">11</span> <span class="mi">3</span><span class="p">)</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">-14</span> <span class="mi">4</span><span class="p">)</span>      <span class="mi">0</span>
<span class="lineno"> 4 </span>           <span class="p">(</span><span class="nf">cc</span> <span class="mi">11</span> <span class="mi">2</span><span class="p">)</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">1</span> <span class="mi">3</span><span class="p">)</span> <span class="nv">|</span> <span class="mi">0</span>
<span class="lineno"> 5 </span>      <span class="p">(</span><span class="nf">cc</span> <span class="mi">11</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">6</span> <span class="mi">2</span><span class="p">)</span> <span class="nv">|</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">1</span> <span class="mi">2</span><span class="p">)</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">-9</span> <span class="mi">3</span><span class="p">)</span>
<span class="lineno"> 6 </span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">11</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">10</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">|</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">6</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">|</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">-4</span> <span class="mi">2</span><span class="p">)</span> <span class="nv">|</span> <span class="mi">0</span>
<span class="lineno"> 7 </span>    <span class="mi">0</span> <span class="nv">|</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">10</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">9</span> <span class="mi">0</span><span class="p">)</span> <span class="nv">|</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">6</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">5</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">|</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">0</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">|</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">0</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">|</span> <span class="mi">0</span>
<span class="lineno"> 8 </span>          <span class="mi">0</span> <span class="nv">|</span> <span class="mi">0</span> <span class="nv">|</span> <span class="mi">0</span> <span class="nv">|</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">5</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">4</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">|</span> <span class="mi">0</span> <span class="nv">|</span> <span class="mi">0</span> <span class="nv">|</span> <span class="mi">0</span> <span class="nv">|</span> <span class="mi">0</span>
<span class="lineno"> 9 </span>          <span class="mi">0</span> <span class="nv">|</span> <span class="mi">0</span> <span class="nv">|</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">4</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">3</span> <span class="mi">1</span><span class="p">)</span>
<span class="lineno">10 </span>          <span class="mi">0</span> <span class="nv">|</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">3</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">2</span> <span class="mi">1</span><span class="p">)</span>
<span class="lineno">11 </span>          <span class="mi">0</span> <span class="nv">|</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">2</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">)</span>
<span class="lineno">12 </span>          <span class="mi">0</span> <span class="nv">|</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">0</span> <span class="mi">1</span><span class="p">)</span>
<span class="lineno">13 </span>          <span class="mi">0</span> <span class="nv">|</span> <span class="mi">0</span>
</pre>
</div>    </div>
   </div>
   <div class="section-block">
    <h3>
     Каков порядок роста (<span class="inline-formula"><img class="img-inline-formula img-formula" width="32" height="17" src="formulae/cCSlLH6spWmUZ.yEu3RFI4JpEISlQpO3e_iouA.png" alt="\theta(n)" title="\theta(n)"></span>) по памяти и по количеству шагов. Где n - сумма.
    </h3>
    <div>
     <div>
      <p>
       По количеству шагов, давайте представим что у нас есть всего одна монетка для изменений. Тогда.
      </p>
     </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno">1 </span>        <span class="p">(</span><span class="nf">cc</span> <span class="nv">amount</span> <span class="mi">1</span><span class="p">)</span>
<span class="lineno">2 </span>  <span class="p">(</span><span class="nf">cc</span> <span class="nv">amount</span> <span class="mi">0</span><span class="p">)</span>  <span class="p">(</span><span class="nf">cc</span> <span class="p">(</span><span class="nf">amount</span> <span class="nv">-</span> <span class="mi">1</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span>
<span class="lineno">3 </span><span class="mi">0</span>                <span class="mi">0</span>     <span class="p">(</span><span class="nf">cc</span> <span class="p">(</span><span class="nf">amount</span> <span class="nv">-</span> <span class="mi">2</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span>
</pre>
</div>     <div>
      <p>
       Видим что у нас левая часть всегда вырождается в 0. А порядок роста в право это просто <span class="inline-formula"><img class="img-inline-formula img-formula" width="32" height="17" src="formulae/cCSlLH6spWmUZ.yEu3RFI4JpEISlQpO3e_iouA.png" alt="\theta(n)" title="\theta(n)"></span>
      </p>
      <p>
       Теперь посмотрим что будет происходить с двумя монетками для изменения.
      </p>
     </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno">1 </span>        <span class="p">(</span><span class="nf">cc</span> <span class="nv">amount</span> <span class="mi">2</span><span class="p">)</span>
<span class="lineno">2 </span>  <span class="p">(</span><span class="nf">cc</span> <span class="nv">amount</span> <span class="mi">1</span><span class="p">)</span>  <span class="p">(</span><span class="nf">cc</span> <span class="p">(</span><span class="nf">amount</span> <span class="nv">-</span> <span class="mi">1</span><span class="p">)</span> <span class="mi">2</span><span class="p">)</span>
</pre>
</div>     <div>
      <p>
       Видим что в левой части у нас в точности то что при одной монетке. А в провой части у нас каждый раз будет создаваться новая левая для одной монетки и еще одна правая. Порядок роста у нас получится <span class="inline-formula"><img class="img-inline-formula img-formula" width="40" height="18" src="formulae/TDMg7xotZXKkYHRB35dASqEHcCEqzcosTs4gqA.png" alt="\theta(n^2)" title="\theta(n^2)"></span>.
      </p>
      <p>
       И так при каждом добавлении еще одного номинала разменной монетки, порядок роста будет увеличиваться на n.
      </p>
      <p>
       У нас в задаче 5 разменных монет, поэтому для нашей задачи порядок роста <span class="inline-formula"><img class="img-inline-formula img-formula" width="40" height="18" src="formulae/fOU3P7Sr57KOt1u0RoA3w7g8.o4nZ4F8ewg70g.png" alt="\theta(n^5)" title="\theta(n^5)"></span>.
      </p>
      <p>
       По памяти <span class="inline-formula"><img class="img-inline-formula img-formula" width="32" height="17" src="formulae/cCSlLH6spWmUZ.yEu3RFI4JpEISlQpO3e_iouA.png" alt="\theta(n)" title="\theta(n)"></span> (порядок максимального разветвления дерева).
      </p>
     </div>
    </div>
   </div>
  </div>
 </div>
 <div class="chapter-block">
  <h2>
   Упражнение 1.15
  </h2>
  <div>
   <div>
    <p>
     Синус угла (указанный в радианах) может быть вычислен используя приближение что <span class="inline-formula"><img class="img-inline-formula img-formula" width="74" height="17" src="formulae/VwTzGshSwoUNeeeAXWnwBL9X4VMacim1a14XTQ.png" alt="\sin(r) = r" title="\sin(r) = r"></span> если <span class="inline-formula"><img class="img-inline-formula img-formula" width="8" height="7" src="formulae/9PDR_uZ5xxt4l_bI_FVKMXrwFl94B6.ue5eEfg.png" alt="r" title="r"></span> малое значение. Для итеративного уменьшения угла будем использовать тригонометрическое тождество <span class="inline-formula"><img class="img-inline-formula img-formula" width="204" height="18" src="formulae/B.h1aEvWmQVlz4e7yBgWDTMA515GD0w6mJyTvg.png" alt="\sin{r} = 3\sin{r/3} - 4sin^3{r/3}" title="\sin{r} = 3\sin{r/3} - 4sin^3{r/3}"></span>.
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno">1 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">cube</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">* </span><span class="nv">x</span> <span class="nv">x</span> <span class="nv">x</span><span class="p">))</span>
<span class="lineno">2 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">p</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">- </span><span class="p">(</span><span class="nb">* </span><span class="mi">3</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">* </span><span class="mi">4</span> <span class="p">(</span><span class="nf">cube</span> <span class="nv">x</span><span class="p">))))</span>
<span class="lineno">3 </span>
<span class="lineno">4 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">sine</span> <span class="nv">angle</span><span class="p">)</span>
<span class="lineno">5 </span>   <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nb">&gt; </span><span class="p">(</span><span class="nb">abs </span><span class="nv">angle</span><span class="p">)</span> <span class="mf">0.1</span><span class="p">))</span>
<span class="lineno">6 </span>       <span class="nv">angle</span>
<span class="lineno">7 </span>       <span class="p">(</span><span class="nf">p</span> <span class="p">(</span><span class="nf">sine</span> <span class="p">(</span><span class="nb">/ </span><span class="nv">angle</span> <span class="mf">3.0</span><span class="p">)))))</span>
</pre>
</div>   <div>
    <div class="section-block">
     <h3>
      Сколько раз выполнится процедура p применительно к sin 12.15?
     </h3>
     <div>
      <p>
       Будем делить угол на 3 пока, он не станет меньше чем 0.1. 12.15/3/3/3/3/3 = 0.049, значит 5 раз.
      </p>
      <p>
       А если записать в общем виде это будет <span class="inline-formula"><img class="img-inline-formula img-formula" width="73" height="16" src="formulae/WyZGa87XcDVFaBuL3zhCCfou.bf8HHwAK4huJg.png" alt="\log_3{x} + a" title="\log_3{x} + a"></span>, где а константа.
      </p>
     </div>
    </div>
    <div class="section-block">
     <h3>
      Каков порядок роста этой функции.
     </h3>
     <div>
      <p>
       Порядок роста по количеству итераций равен <span class="inline-formula"><img class="img-inline-formula img-formula" width="55" height="17" src="formulae/p7Pg644Ou_yBspI.6P9dd_cyiYJtXOrDgKl4aQ.png" alt="\theta(log{n})" title="\theta(log{n})"></span>. По месту так же.
      </p>
     </div>
    </div>
   </div>
  </div>
 </div>
 <div class="chapter-block">
  <h2>
   Упражнение 1.16
  </h2>
  <div>
   <div>
    <p>
     Написать итеративный вариант быстрой экспоненты с порядком роста <span class="inline-formula"><img class="img-inline-formula img-formula" width="55" height="17" src="formulae/p7Pg644Ou_yBspI.6P9dd_cyiYJtXOrDgKl4aQ.png" alt="\theta(log{n})" title="\theta(log{n})"></span>
    </p>
    <p>
     Рекурсивный вариант:
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno"> 1 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nb">even? </span><span class="nv">n</span><span class="p">)</span>
<span class="lineno"> 2 </span>  <span class="p">(</span><span class="nb">= </span><span class="p">(</span><span class="nb">remainder </span><span class="nv">n</span> <span class="mi">2</span><span class="p">)</span> <span class="mi">0</span><span class="p">))</span>
<span class="lineno"> 3 </span><span class="p">(</span><span class="nb">even? </span><span class="mi">2</span><span class="p">)</span>
<span class="lineno"> 4 </span><span class="p">(</span><span class="nb">even? </span><span class="mi">7</span><span class="p">)</span>
<span class="lineno"> 5 </span>
<span class="lineno"> 6 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">fast-expt</span> <span class="nv">b</span> <span class="nv">n</span><span class="p">)</span>
<span class="lineno"> 7 </span>  <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">= </span><span class="nv">n</span> <span class="mi">0</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span>
<span class="lineno"> 8 </span>        <span class="p">((</span><span class="nb">even? </span><span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nf">square</span> <span class="p">(</span><span class="nf">fast-expt</span> <span class="nv">b</span> <span class="p">(</span><span class="nb">/ </span><span class="nv">n</span> <span class="mi">2</span><span class="p">))))</span>
<span class="lineno"> 9 </span>        <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">* </span><span class="nv">b</span> <span class="p">(</span><span class="nf">fast-expt</span> <span class="nv">b</span> <span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="mi">1</span><span class="p">))))))</span>
<span class="lineno">10 </span><span class="p">(</span><span class="nf">fast-expt</span> <span class="mi">5</span> <span class="mi">10</span><span class="p">)</span>
</pre>
</div>   <div>
    <p>
     Итеративный вариант:
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno"> 1 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nb">even? </span><span class="nv">n</span><span class="p">)</span>
<span class="lineno"> 2 </span>  <span class="p">(</span><span class="nb">= </span><span class="p">(</span><span class="nb">remainder </span><span class="nv">n</span> <span class="mi">2</span><span class="p">)</span> <span class="mi">0</span><span class="p">))</span>
<span class="lineno"> 3 </span>
<span class="lineno"> 4 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nb">expt </span><span class="nv">b</span> <span class="nv">n</span><span class="p">)</span>
<span class="lineno"> 5 </span>  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">expt-iter</span> <span class="nv">a</span> <span class="nv">count</span><span class="p">)</span>
<span class="lineno"> 6 </span>    <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">= </span><span class="nv">count</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span>
<span class="lineno"> 7 </span>          <span class="p">((</span><span class="nb">= </span><span class="nv">count</span> <span class="mi">0</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span>
<span class="lineno"> 8 </span>          <span class="p">((</span><span class="nb">&gt;= </span><span class="nv">count</span> <span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="mi">1</span><span class="p">))</span> <span class="p">(</span><span class="nf">expt-iter</span> <span class="p">(</span><span class="nf">square</span> <span class="nv">b</span><span class="p">)</span> <span class="p">(</span><span class="nb">/ </span><span class="nv">count</span> <span class="mi">2</span><span class="p">)))</span>
<span class="lineno"> 9 </span>          <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">expt-iter</span> <span class="p">(</span><span class="nf">square</span> <span class="nv">a</span><span class="p">)</span> <span class="p">(</span><span class="nb">/ </span><span class="nv">count</span> <span class="mi">2</span><span class="p">)))))</span>
<span class="lineno">10 </span>  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">even? </span><span class="nv">n</span><span class="p">)</span>
<span class="lineno">11 </span>      <span class="p">(</span><span class="nf">expt-iter</span> <span class="mi">1</span> <span class="nv">n</span><span class="p">)</span>
<span class="lineno">12 </span>      <span class="p">(</span><span class="nb">* </span><span class="nv">b</span> <span class="p">(</span><span class="nf">expt-iter</span> <span class="mi">1</span> <span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="mi">1</span><span class="p">)))))</span>
<span class="lineno">13 </span><span class="p">(</span><span class="nb">expt </span><span class="mi">3</span> <span class="mi">150</span><span class="p">)</span>
</pre>
</div>  </div>
 </div>
 <div class="chapter-block">
  <h2>
   Упражнение 1.17
  </h2>
  <div>
   <div>
    <p>
     Допустим у нас нет процедуры умножения, написать процедуру использую только сложение и предопределенные процедуры halve и double, с порядком роста <span class="inline-formula"><img class="img-inline-formula img-formula" width="55" height="17" src="formulae/p7Pg644Ou_yBspI.6P9dd_cyiYJtXOrDgKl4aQ.png" alt="\theta(log{n})" title="\theta(log{n})"></span>
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno"> 1 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">double</span> <span class="nv">x</span><span class="p">)</span>
<span class="lineno"> 2 </span>  <span class="p">(</span><span class="nb">* </span><span class="nv">x</span> <span class="mi">2</span><span class="p">))</span>
<span class="lineno"> 3 </span><span class="p">(</span><span class="nf">double</span> <span class="mi">2</span><span class="p">)</span>
<span class="lineno"> 4 </span>
<span class="lineno"> 5 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">halve</span> <span class="nv">x</span><span class="p">)</span>
<span class="lineno"> 6 </span>  <span class="p">(</span><span class="nb">/ </span><span class="nv">x</span> <span class="mi">2</span><span class="p">))</span>
<span class="lineno"> 7 </span><span class="p">(</span><span class="nf">halve</span> <span class="mi">4</span><span class="p">)</span>
<span class="lineno"> 8 </span>
<span class="lineno"> 9 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nb">even? </span><span class="nv">n</span><span class="p">)</span>
<span class="lineno">10 </span>  <span class="p">(</span><span class="nb">= </span><span class="p">(</span><span class="nb">remainder </span><span class="nv">n</span> <span class="mi">2</span><span class="p">)</span> <span class="mi">0</span><span class="p">))</span>
<span class="lineno">11 </span><span class="p">(</span><span class="nb">even? </span><span class="mi">6</span><span class="p">)</span>
<span class="lineno">12 </span>
<span class="lineno">13 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">fast?</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
<span class="lineno">14 </span>  <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="k">or </span><span class="p">(</span><span class="nb">= </span><span class="nv">b</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nb">= </span><span class="nv">a</span> <span class="mi">0</span><span class="p">))</span> <span class="mi">0</span><span class="p">)</span>
<span class="lineno">15 </span>        <span class="p">((</span><span class="nb">= </span><span class="nv">b</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span>
<span class="lineno">16 </span>        <span class="p">((</span><span class="nb">even? </span><span class="nv">b</span><span class="p">)</span> <span class="p">(</span><span class="nf">double</span> <span class="p">(</span><span class="nf">fast?</span> <span class="nv">a</span> <span class="p">(</span><span class="nf">halve</span> <span class="nv">b</span><span class="p">))))</span>
<span class="lineno">17 </span>        <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">+ </span><span class="nv">a</span> <span class="p">(</span><span class="nf">double</span> <span class="p">(</span><span class="nf">fast?</span> <span class="nv">a</span> <span class="p">(</span><span class="nf">halve</span> <span class="p">(</span><span class="nb">- </span><span class="nv">b</span> <span class="mi">1</span><span class="p">))))))))</span>
<span class="lineno">18 </span><span class="p">(</span><span class="nf">fast?</span> <span class="mi">10</span> <span class="mi">0</span><span class="p">)</span>
<span class="lineno">19 </span><span class="p">(</span><span class="nf">fast?</span> <span class="mi">0</span> <span class="mi">10</span><span class="p">)</span>
<span class="lineno">20 </span><span class="p">(</span><span class="nf">fast?</span> <span class="mi">10</span> <span class="mi">10</span><span class="p">)</span>
<span class="lineno">21 </span><span class="p">(</span><span class="nf">fast?</span> <span class="mi">10</span> <span class="mi">11</span><span class="p">)</span>
</pre>
</div>  </div>
 </div>
 <div class="chapter-block">
  <h2>
   Упражнение 1.18
  </h2>
  <div>
   <div>
    <p>
     Используя результаты 1.16, 1.17 разработайте итеративную процедуру умножения двух чисел в терминах “удвоить, взять половину, добавить”, процедура должна выполняться с порядком роста <span class="inline-formula"><img class="img-inline-formula img-formula" width="55" height="17" src="formulae/p7Pg644Ou_yBspI.6P9dd_cyiYJtXOrDgKl4aQ.png" alt="\theta(log{n})" title="\theta(log{n})"></span>.
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno"> 1 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">fast?</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
<span class="lineno"> 2 </span>  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">fast-iter</span> <span class="nv">asum</span> <span class="nv">bsum</span> <span class="nv">count</span><span class="p">)</span>
<span class="lineno"> 3 </span>    <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">= </span><span class="nv">bsum</span> <span class="mi">0</span><span class="p">)</span> <span class="nv">asum</span><span class="p">)</span>
<span class="lineno"> 4 </span>          <span class="p">((</span><span class="nb">= </span><span class="nv">bsum</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">asum</span><span class="p">)</span>
<span class="lineno"> 5 </span>          <span class="p">((</span><span class="nb">even? </span><span class="nv">bsum</span><span class="p">)</span> <span class="p">(</span><span class="nf">fast-iter</span> <span class="p">(</span><span class="nf">double</span> <span class="nv">asum</span><span class="p">)</span> <span class="p">(</span><span class="nf">halve</span> <span class="nv">bsum</span><span class="p">)))</span>
<span class="lineno"> 6 </span>          <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">fast-iter</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">asum</span> <span class="nv">asum</span><span class="p">)</span> <span class="p">(</span><span class="nb">- </span><span class="nv">bsum</span> <span class="mi">1</span><span class="p">)))))</span>
<span class="lineno"> 7 </span>  <span class="p">(</span><span class="k">cond </span><span class="p">(</span><span class="k">or </span><span class="p">(</span><span class="nb">= </span><span class="nv">b</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nb">= </span><span class="nv">a</span> <span class="mi">0</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
<span class="lineno"> 8 </span>        <span class="p">((</span><span class="nb">= </span><span class="nv">b</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span>
<span class="lineno"> 9 </span>        <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">fast-iter</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">))))</span>
<span class="lineno">10 </span><span class="p">(</span><span class="nf">fast?</span> <span class="mi">16</span> <span class="mi">18</span><span class="p">)</span>
</pre>
</div>  </div>
 </div>
 <div class="chapter-block">
  <h2>
   Упражнение 1.19
  </h2>
  <div>
   <div>
    <p>
     Доработать вычисление функции Фибоначи, процедура должна выполняться с порядком роста <span class="inline-formula"><img class="img-inline-formula img-formula" width="55" height="17" src="formulae/p7Pg644Ou_yBspI.6P9dd_cyiYJtXOrDgKl4aQ.png" alt="\theta(log{n})" title="\theta(log{n})"></span>.
    </p>
    <p>
     В последнем итеративном подсчете Фибоначи мы перезаписывали a &lt;- a + b и b &lt;- a, назовем это трансформацией T. Заметим что применение T n раз даст пару Fib(n + 1) и Fib(n), иными словами числа генерируются применением T^n. Теперь рассмотрим частный случай T p = 0 q = 1 в преобразовании Tpq, где Tpq преобразует пару (a, b) в a &lt;- bq + aq + ap и b &lt;- bp + aq. Покажите что если применить такую трансформацию Tpq дважды, результат будет тем же как и от единственной трансформации Tp'q' такой же формы, для которой p' и q' выраженны через p и q. Это даст нам возможность ускорить процедуру, как мы делали в fast-exp. Собрав все это вместе закончите процедуру приведенную ниже.
    </p>
    <p>
     Выражаем p' и q' через p и q.
    </p>
    <div class="theorem-environment theorem-proposition-environment">
     <div class="theorem-header theorem-proposition-header">
      Утверждение.
     </div>
     <div class="theorem-content theorem-proposition-content">
      <p>
       a1 b1 a2 = b1q + a1q + a1p b2 = b1p + a1q
      </p>
      <p>
       a3 = b2q + a2q + a2p b3 = b2p + a2q
      </p>
      <p>
       a3 = (b1p + a1q)q + (b1q + a1q + a1p)q + (b1q + a1q + a1p)p b3 = (b1p + a1q)p + (b1q + a1q + a1p)q
      </p>
      <p>
       a3 = b1q' + a1q' + a1p' (1) b3 = b1p' + a1q' (2)
      </p>
      <p>
       a3 = b1pq + a1qq + b1qq + a1qq + a1pq + b1pq + a1pq + a1pp b3 = b1pp + a1pq + b1qq + a1qq + a1pq
      </p>
      <p>
       a3 = b1(2pq + qq) + a1(2qq + 2pq + pp) (3) b3 = b1(pp + qq) + a1(2pq + qq) (4)
      </p>
      <p>
       a3 = b1(2pq + qq) + a1(2pq + qq) + a1(qq + pp)
      </p>
      <p>
       q' = 2pq + qq
      </p>
      <p>
       p' = pp + qq
      </p>
     </div>
    </div>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno"> 1 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">fib</span> <span class="nv">n</span><span class="p">)</span>
<span class="lineno"> 2 </span>  <span class="p">(</span><span class="nf">fib-iter</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="nv">n</span><span class="p">))</span>
<span class="lineno"> 3 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">fib-iter</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">p</span> <span class="nv">q</span> <span class="nv">count</span><span class="p">)</span>
<span class="lineno"> 4 </span>  <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">= </span><span class="nv">count</span> <span class="mi">0</span><span class="p">)</span> <span class="nv">b</span><span class="p">)</span>
<span class="lineno"> 5 </span>        <span class="p">((</span><span class="nb">even? </span><span class="nv">count</span><span class="p">)</span>
<span class="lineno"> 6 </span>         <span class="p">(</span><span class="nf">fib-iter</span> <span class="nv">a</span>
<span class="lineno"> 7 </span>                   <span class="nv">b</span>
<span class="lineno"> 8 </span>                   <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">square</span> <span class="nv">p</span><span class="p">)</span> <span class="p">(</span><span class="nf">square</span> <span class="nv">q</span><span class="p">))</span>      <span class="c1">; compute p'</span>
<span class="lineno"> 9 </span>                   <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nb">* </span><span class="mi">2</span> <span class="nv">p</span> <span class="nv">q</span><span class="p">)</span> <span class="p">(</span><span class="nf">square</span> <span class="nv">q</span><span class="p">))</span>      <span class="c1">; compute q'</span>
<span class="lineno">10 </span>                   <span class="p">(</span><span class="nb">/ </span><span class="nv">count</span> <span class="mi">2</span><span class="p">)))</span>
<span class="lineno">11 </span>        <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">fib-iter</span> <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nb">* </span><span class="nv">b</span> <span class="nv">q</span><span class="p">)</span> <span class="p">(</span><span class="nb">* </span><span class="nv">a</span> <span class="nv">q</span><span class="p">)</span> <span class="p">(</span><span class="nb">* </span><span class="nv">a</span> <span class="nv">p</span><span class="p">))</span>
<span class="lineno">12 </span>                        <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nb">* </span><span class="nv">b</span> <span class="nv">p</span><span class="p">)</span> <span class="p">(</span><span class="nb">* </span><span class="nv">a</span> <span class="nv">q</span><span class="p">))</span>
<span class="lineno">13 </span>                        <span class="nv">p</span>
<span class="lineno">14 </span>                        <span class="nv">q</span>
<span class="lineno">15 </span>                        <span class="p">(</span><span class="nb">- </span><span class="nv">count</span> <span class="mi">1</span><span class="p">)))))</span>
</pre>
</div>  </div>
 </div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/sicp-uprazhnenie-113/" class="u-url">SICP Упражнение 1.13</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Velikii Nehochuha
            </span></p>
            <p class="dateline">
            <a href="posts/sicp-uprazhnenie-113/" rel="bookmark">
            <time class="published dt-published" datetime="2020-01-10T22:44:12+03:00" itemprop="datePublished" title="2020-01-10 22:44">2020-01-10 22:44</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div class="chapter-block">
 <h2>
  Упражнение 1.13
 </h2>
 <div>
  <div class="section-block">
   <h3>
    Доказать что Fib(n) равно ближайшему целому от <span class="inline-formula"><img class="img-inline-formula img-formula" width="51" height="20" src="formulae/qmmHpyMlLsLpIpLHlURTp1owmHnJlfTVv755nw.png" alt="\phi^n/\sqrt{5}" title="\phi^n/\sqrt{5}"></span>, где <span class="inline-formula"><img class="img-inline-formula img-formula" width="117" height="20" src="formulae/hZnPfd8DlYO9DZt9mrqHPU3pZH.9aebd5WDGlg.png" alt="\phi = (1+\sqrt{5})/2" title="\phi = (1+\sqrt{5})/2"></span>
   </h3>
   <div>
    <p>
     при n=0, <span class="inline-formula"><img class="img-inline-formula img-formula" width="113" height="20" src="formulae/kGR35pg.J1oIAbS3ByyC3CfU7u_zYp7UkShLJA.png" alt="\phi^0/\sqrt{5} = 1/\sqrt{5}" title="\phi^0/\sqrt{5} = 1/\sqrt{5}"></span>, что округляя до целых рано 0.
    </p>
    <p>
     при n=1, <span class="inline-formula"><img class="img-inline-formula img-formula" width="375" height="21" src="formulae/2bqrTUr.StkHYLtOgqb2S6yXaVJRKkmml3mJOQ.png" alt="\phi^1/\sqrt{5} = (1+\sqrt(5))/(2*\sqrt{5}) = 1/2 + 1/(2*\sqrt{5})" title="\phi^1/\sqrt{5} = (1+\sqrt(5))/(2*\sqrt{5}) = 1/2 + 1/(2*\sqrt{5})"></span>, что округляя до целых равно 1. осталось доказать что Fib(n) = Fib(n-2) + Fib(n-1) (1):
    </p>
    <div class="display-formula">
     <img class="img-display-formula img-formula" width="399" height="21" src="formulae/ZURQpAKWFG6.0WAEX.BQDw361iAytlELyBK8rw.png" alt="((1+\sqrt{5})/2)^n = ((1+\sqrt{5})/2)^{n-1} + ((1+\sqrt{5})/2)^{n-2}" title="((1+\sqrt{5})/2)^n = ((1+\sqrt{5})/2)^{n-1} + ((1+\sqrt{5})/2)^{n-2}">
</div>
    <p>
     , (тождество 1) делим все на <span class="inline-formula"><img class="img-inline-formula img-formula" width="124" height="20" src="formulae/P64fheNboh7kjVc.J65fG8aaUiK4lNgXCZmWew.png" alt="((1+\sqrt{5})/2)^{n-2}" title="((1+\sqrt{5})/2)^{n-2}"></span>, получаем:
    </p>
    <div class="display-formula">
     <img class="img-display-formula img-formula" width="255" height="21" src="formulae/OhVfNfT1IDLrXElHys_g1uIdw4zxYkeUMSN2gA.png" alt="((1+\sqrt{5})/2)^2 = ((1+\sqrt{5})/2) + 1" title="((1+\sqrt{5})/2)^2 = ((1+\sqrt{5})/2) + 1">
</div>
    <div class="display-formula">
     <img class="img-display-formula img-formula" width="188" height="21" src="formulae/WdC6BsCq.ziw2FoIpJJN.MGzpGRlNpFiA0Z7HA.png" alt="(1+\sqrt{5})^2 = 2+2\sqrt{5} + 4" title="(1+\sqrt{5})^2 = 2+2\sqrt{5} + 4">
</div>
    <div class="display-formula">
     <img class="img-display-formula img-formula" width="40" height="11" src="formulae/y.GRlg4873GC_OIUeajnnK2yU.iIDK26NTUc9g.png" alt="0 = 0" title="0 = 0">
</div>
    <p>
     Ч.т.д.
    </p>
   </div>
  </div>
  <div class="section-block">
   <h3>
    Доказать по индукции что функцию Фибоначи можно считать как <span class="inline-formula"><img class="img-inline-formula img-formula" width="165" height="20" src="formulae/mF8cUs5LkLg5BCDr.3uAay12c56n.d8XMHDpKQ.png" alt="f(n) = (\phi^n-\psi^n)/\sqrt{5}" title="f(n) = (\phi^n-\psi^n)/\sqrt{5}"></span>, где <span class="inline-formula"><img class="img-inline-formula img-formula" width="117" height="20" src="formulae/hZnPfd8DlYO9DZt9mrqHPU3pZH.9aebd5WDGlg.png" alt="\phi = (1+\sqrt{5})/2" title="\phi = (1+\sqrt{5})/2"></span> и <span class="inline-formula"><img class="img-inline-formula img-formula" width="119" height="20" src="formulae/oxKL1Mb1N_iMBE2vAPapClklGGyJp1NSTo3KTw.png" alt="\psi = (1-\sqrt{5})/2" title="\psi = (1-\sqrt{5})/2"></span>
   </h3>
   <div>
    <p>
     при n=0, <span class="inline-formula"><img class="img-inline-formula img-formula" width="136" height="20" src="formulae/jLMP21rgYPtqQeX8CrNrJkXZjCDu0pSpVoCj9g.png" alt="(\phi^0-\psi^0)/\sqrt{5} = 0" title="(\phi^0-\psi^0)/\sqrt{5} = 0"></span>
    </p>
    <p>
     при n=1, <span class="inline-formula"><img class="img-inline-formula img-formula" width="295" height="21" src="formulae/nSajWKu5CFrSKniUBj10DkIqKy3LRye6a8cl8A.png" alt="((1+\sqrt{5})/2)-(1-\sqrt{5})/2))/\sqrt(5) = 1" title="((1+\sqrt{5})/2)-(1-\sqrt{5})/2))/\sqrt(5) = 1"></span>
    </p>
    <p>
     осталось доказать что Fib(n) = Fib(n-2) + Fib(n-1) (2):
    </p>
    <div class="display-formula">
     <img class="img-display-formula img-formula" width="953" height="21" src="formulae/wq.Rq.HXT9H104.ghU.llmrz5UuKrAI0m.hgBA.png" alt="(((1+\sqrt{5})/2)^n - ((1-\sqrt{5})/2)^n)/\sqrt{5} = (((1+\sqrt{5})/2)^{n-1} - ((1-\sqrt{5})/2)^{n-1})/\sqrt{5} + (((1+\sqrt{5})/2)^{n-2} - ((1-\sqrt{5})/2)^{n-2})/\sqrt{5}" title="(((1+\sqrt{5})/2)^n - ((1-\sqrt{5})/2)^n)/\sqrt{5} = (((1+\sqrt{5})/2)^{n-1} - ((1-\sqrt{5})/2)^{n-1})/\sqrt{5} + (((1+\sqrt{5})/2)^{n-2} - ((1-\sqrt{5})/2)^{n-2})/\sqrt{5}">
</div>
    <div class="display-formula">
     <img class="img-display-formula img-formula" width="817" height="21" src="formulae/Am4sZVszc.AJBcPvGGP2Hg7B_r2VB.lJFJe7rw.png" alt="((1+\sqrt{5})/2)^n - ((1-\sqrt{5})/2)^n = ((1+\sqrt{5})/2)^{n-1} - ((1-\sqrt{5})/2)^{n-1} + ((1+\sqrt{5})/2)^{n-2} - ((1-\sqrt{5})/2)^{n-2}" title="((1+\sqrt{5})/2)^n - ((1-\sqrt{5})/2)^n = ((1+\sqrt{5})/2)^{n-1} - ((1-\sqrt{5})/2)^{n-1} + ((1+\sqrt{5})/2)^{n-2} - ((1-\sqrt{5})/2)^{n-2}">
</div>
    <p>
     применяя тождество 1, получаем:
    </p>
    <div class="display-formula">
     <img class="img-display-formula img-formula" width="399" height="21" src="formulae/mBgmwA_a43nN1qjuDL0a6pF5vhKZV2qnhE5gQg.png" alt="((1-\sqrt{5})/2)^n = ((1-\sqrt{5})/2)^{n-1} + ((1-\sqrt{5})/2)^{n-2}" title="((1-\sqrt{5})/2)^n = ((1-\sqrt{5})/2)^{n-1} + ((1-\sqrt{5})/2)^{n-2}">
</div>
    <p>
     доказывается точно также как тождество 1:
    </p>
    <div class="display-formula">
     <img class="img-display-formula img-formula" width="255" height="21" src="formulae/a8t2dmDEAsinmvCGJofpZncar22jW5V8rrFouA.png" alt="((1-\sqrt{5})/2)^2 = ((1-\sqrt{5})/2) + 1" title="((1-\sqrt{5})/2)^2 = ((1-\sqrt{5})/2) + 1">
</div>
    <div class="display-formula">
     <img class="img-display-formula img-formula" width="188" height="21" src="formulae/kO6G5BYnE8.uTj3lK4dBHJYVKD59RAU6XGtnZA.png" alt="(1-\sqrt{5})^2 = 2-2\sqrt{5} + 4" title="(1-\sqrt{5})^2 = 2-2\sqrt{5} + 4">
</div>
    <div class="display-formula">
     <img class="img-display-formula img-formula" width="40" height="11" src="formulae/y.GRlg4873GC_OIUeajnnK2yU.iIDK26NTUc9g.png" alt="0 = 0" title="0 = 0">
</div>
    <p>
     Ч.т.д.
    </p>
   </div>
  </div>
 </div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/sicp-uprazhneniia-iz-glavy-12/" class="u-url">SICP Упражнения из главы 1.2 (1.9-1.12)</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Velikii Nehochuha
            </span></p>
            <p class="dateline">
            <a href="posts/sicp-uprazhneniia-iz-glavy-12/" rel="bookmark">
            <time class="published dt-published" datetime="2020-01-10T12:33:18+03:00" itemprop="datePublished" title="2020-01-10 12:33">2020-01-10 12:33</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div id="outline-container-org53c3a57" class="outline-2">
<h2 id="org53c3a57">Exercise 1.9.</h2>
<div class="outline-text-2" id="text-org53c3a57">
<p>
Каждая из двух приведенных процедур реализует сложение в терминах инкремента (int), используя модель замещения, проиллюстрируйте процесс вычисления, это рекурсивные или итеративные процессы?
</p>

<div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nb">+ </span><span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="nv">a</span> <span class="mi">0</span><span class="p">)</span>
      <span class="nv">b</span>
      <span class="p">(</span><span class="nf">inc</span> <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">dec</span> <span class="nv">a</span><span class="p">)</span> <span class="nv">b</span><span class="p">))))</span>

<span class="p">(</span><span class="nb">+ </span><span class="mi">6</span> <span class="mi">5</span><span class="p">)</span>
<span class="p">(</span><span class="nf">inc</span> <span class="p">(</span><span class="nb">+ </span><span class="mi">5</span> <span class="mi">5</span><span class="p">))</span>
<span class="p">(</span><span class="nf">inc</span> <span class="p">(</span><span class="nf">inc</span> <span class="p">(</span><span class="nb">+ </span><span class="mi">4</span> <span class="mi">5</span><span class="p">)))</span>
<span class="p">(</span><span class="nf">inc</span> <span class="p">(</span><span class="nf">inc</span> <span class="p">(</span><span class="nf">inc</span> <span class="p">(</span><span class="nb">+ </span><span class="mi">3</span> <span class="mi">5</span><span class="p">))))</span>
<span class="p">(</span><span class="nf">inc</span> <span class="p">(</span><span class="nf">inc</span> <span class="p">(</span><span class="nf">inc</span> <span class="p">(</span><span class="nf">inc</span> <span class="p">(</span><span class="nb">+ </span><span class="mi">2</span> <span class="mi">5</span><span class="p">)))))</span>
<span class="p">(</span><span class="nf">inc</span> <span class="p">(</span><span class="nf">inc</span> <span class="p">(</span><span class="nf">inc</span> <span class="p">(</span><span class="nf">inc</span> <span class="p">(</span><span class="nf">inc</span> <span class="p">(</span><span class="nb">+ </span><span class="mi">1</span> <span class="mi">5</span><span class="p">))))))</span>
<span class="p">(</span><span class="nf">inc</span> <span class="p">(</span><span class="nf">inc</span> <span class="p">(</span><span class="nf">inc</span> <span class="p">(</span><span class="nf">inc</span> <span class="p">(</span><span class="nf">inc</span> <span class="p">(</span><span class="nf">inc</span> <span class="p">(</span><span class="nb">+ </span><span class="mi">0</span> <span class="mi">5</span><span class="p">)))))))</span> <span class="c1">; 5 + 6inc 11</span>


<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nb">+ </span><span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="nv">a</span> <span class="mi">0</span><span class="p">)</span>
      <span class="nv">b</span>
      <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">dec</span> <span class="nv">a</span><span class="p">)</span> <span class="p">(</span><span class="nf">inc</span> <span class="nv">b</span><span class="p">))))</span>
<span class="p">(</span><span class="nb">+ </span><span class="mi">6</span> <span class="mi">5</span><span class="p">)</span>
<span class="p">(</span><span class="nb">+ </span><span class="mi">5</span> <span class="mi">6</span><span class="p">)</span>
<span class="p">(</span><span class="nb">+ </span><span class="mi">4</span> <span class="mi">7</span><span class="p">)</span>
<span class="p">(</span><span class="nb">+ </span><span class="mi">3</span> <span class="mi">8</span><span class="p">)</span>
<span class="p">(</span><span class="nb">+ </span><span class="mi">2</span> <span class="mi">9</span><span class="p">)</span>
<span class="p">(</span><span class="nb">+ </span><span class="mi">1</span> <span class="mi">10</span><span class="p">)</span>
<span class="p">(</span><span class="nb">+ </span><span class="mi">0</span> <span class="mi">11</span><span class="p">)</span> <span class="c1">; 11</span>
</pre></div>
</div>
</div>

<div id="outline-container-orgd2c0f7d" class="outline-2">
<h2 id="orgd2c0f7d">Exercise 1.10</h2>
<div class="outline-text-2" id="text-orgd2c0f7d">
<p>
Функция Аккермана. Интересна тем что являетеся рекурсивной и растет быстрее экспоненты.
</p>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">A</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span>
  <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">= </span><span class="nv">y</span> <span class="mi">0</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
	<span class="p">((</span><span class="nb">= </span><span class="nv">x</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nb">* </span><span class="mi">2</span> <span class="nv">y</span><span class="p">))</span>
	<span class="p">((</span><span class="nb">= </span><span class="nv">y</span> <span class="mi">1</span><span class="p">)</span> <span class="mi">2</span><span class="p">)</span>
	<span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">A</span> <span class="p">(</span><span class="nb">- </span><span class="nv">x</span> <span class="mi">1</span><span class="p">)</span>
		 <span class="p">(</span><span class="nf">A</span> <span class="nv">x</span> <span class="p">(</span><span class="nb">- </span><span class="nv">y</span> <span class="mi">1</span><span class="p">))))))</span>
<span class="p">(</span><span class="nf">A</span> <span class="mi">1</span> <span class="mi">10</span><span class="p">)</span> <span class="c1">;Value: 1024</span>
<span class="p">(</span><span class="nf">A</span> <span class="mi">2</span> <span class="mi">4</span><span class="p">)</span> <span class="c1">;Value: 65536</span>
<span class="p">(</span><span class="nf">A</span> <span class="mi">3</span> <span class="mi">3</span><span class="p">)</span> <span class="c1">;Value: 65536</span>
</pre></div>
<p>
Рассмотрим следующие процедуры
</p>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">f</span> <span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nf">A</span> <span class="mi">0</span> <span class="nv">n</span><span class="p">))</span>
<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">g</span> <span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nf">A</span> <span class="mi">1</span> <span class="nv">n</span><span class="p">))</span>
<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">h</span> <span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nf">A</span> <span class="mi">2</span> <span class="nv">n</span><span class="p">))</span>
<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">k</span> <span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nb">* </span><span class="mi">5</span> <span class="nv">n</span> <span class="nv">n</span><span class="p">))</span>
</pre></div>

<p>
Дайте краткое математическое определение функций f, g, h. К примеру k(n) = 5*n*n
</p>

<p>
(f n) = (A 0 n) = (* 2 n)
(g n) = (A 1 n) = (A 0 (A 1 (- n 1))) = (* 2 (A 1 (- n 1))) = это будет 2 в степени n
(h n) = (A 2 n) = (A 1 (A 2 (- n 1))) = 2 в степени (A 2 (- n 1)) = 2 <b>* 2 в cтепени (A 2 (-n 2), пока A 2 (- n (- n 1))
(A 2 4) ;;  = 2 *</b> 2 <b>* 2 *</b> 2 ;; 65536
</p>
</div>
</div>

<div id="outline-container-org34d7e75" class="outline-2">
<h2 id="org34d7e75">Exercise 1.11.</h2>
<div class="outline-text-2" id="text-org34d7e75">
<p>
Функция f(n) = n, если n&lt;3 и f(n) = f(n - 1) + 2f(n - 2) + 3f(n - 3) если n&gt;= 3. Напишите процедуру для вычисления значения f в рекурсивной и итеративной форме.
</p>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">f</span> <span class="nv">n</span><span class="p">)</span>
  <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">&lt; </span><span class="nv">n</span> <span class="mi">3</span><span class="p">)</span> <span class="nv">n</span><span class="p">)</span>
	<span class="p">((</span><span class="nb">&gt;= </span><span class="nv">n</span> <span class="mi">3</span><span class="p">)</span> <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">f</span> <span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="mi">1</span><span class="p">))</span> <span class="p">(</span><span class="nb">* </span><span class="mi">2</span> <span class="p">(</span><span class="nf">f</span> <span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="mi">2</span><span class="p">)))</span> <span class="p">(</span><span class="nb">* </span><span class="mi">3</span> <span class="p">(</span><span class="nf">f</span> <span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="mi">3</span><span class="p">)))))))</span>
</pre></div>

<p>
при итеративном подходе просто начинаем с известных f(2) f(1) f(0) это параметры f-iter a, b, c
f(3) = (f(2) + 2f(1) + 3f(0)), записываем это значение в a
в b записываем f(2) в с f(1)
на следующей итерации нам вычислять f(4) = (f(3) + 2(f2) + 3(f1))
в a у нас f(3) b = f(2) c = f(1)то есть можем вычислить f4 и записать его в снова в a, при этом в b записываем f(3) то есть предыдущее значение a, в c записываем f(2) теперь нам нужно вычислить f(5), у нас все есть a = f(4) b = f(3) c = f(2).
</p>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">f</span> <span class="nv">n</span><span class="p">)</span>
   <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">f-iter</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span> <span class="nv">count</span><span class="p">)</span>
     <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&lt; </span><span class="nv">count</span> <span class="mi">3</span><span class="p">)</span>
	 <span class="nv">a</span>
	 <span class="p">(</span><span class="nf">f-iter</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">a</span> <span class="p">(</span><span class="nb">* </span><span class="mi">2</span> <span class="nv">b</span><span class="p">)</span> <span class="p">(</span><span class="nb">* </span><span class="mi">3</span> <span class="nv">c</span><span class="p">))</span> <span class="nv">a</span> <span class="nv">b</span> <span class="p">(</span><span class="nb">- </span><span class="nv">count</span> <span class="mi">1</span><span class="p">))))</span>
   <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&lt; </span><span class="nv">n</span> <span class="mi">3</span><span class="p">)</span>
       <span class="nv">n</span>
       <span class="p">(</span><span class="nf">f-iter</span> <span class="mi">2</span> <span class="mi">1</span> <span class="mi">0</span> <span class="nv">n</span><span class="p">)))</span>
</pre></div>
</div>
</div>

<div id="outline-container-orgbbeab67" class="outline-2">
<h2 id="orgbbeab67">Exercise 1.12.</h2>
<div class="outline-text-2" id="text-orgbbeab67">
<p>
Треугольник Паскаля изображен на картинке.
<img src="images/ch1-Z-G-17.gif" alt="nil">
Напишите рекурсивную процедуру вычисления значений элементов в треугольнике паскаля.
</p>

<p>
пусть n ряд в треугольнике
m - позиция в ряду начиная с 0, тогда значение в m будет равно биномиальному коэффициенту С из n по m. (/ n! (* m! (- n m)!)
(1 + x)**3 = 1 + 3x + 3xx + xxx
</p>
<div class="highlight"><pre><span></span><span class="c1">;; через биномиальные коэффициенты</span>
<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">factorial</span> <span class="nv">n</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="nv">n</span> <span class="mi">1</span><span class="p">)</span>
      <span class="nv">n</span>
      <span class="p">(</span><span class="nb">* </span><span class="nv">n</span> <span class="p">(</span><span class="nf">factorial</span> <span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="mi">1</span><span class="p">)))))</span>
<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">pascal</span> <span class="nv">n</span> <span class="nv">m</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="k">or </span><span class="p">(</span><span class="nb">= </span><span class="nv">n</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nb">= </span><span class="nv">m</span> <span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nb">= </span><span class="nv">m</span> <span class="mi">0</span><span class="p">))</span>
      <span class="mi">1</span>
      <span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nf">factorial</span> <span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nb">* </span><span class="p">(</span><span class="nf">factorial</span> <span class="nv">m</span><span class="p">)</span> <span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="nv">m</span><span class="p">)))))</span>

<span class="c1">;; рекурсивно поднимамясь вверх по столбцам</span>
<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">pascal</span> <span class="nv">n</span> <span class="nv">m</span><span class="p">)</span>
  <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="k">or </span><span class="p">(</span><span class="nb">= </span><span class="nv">m</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nb">= </span><span class="nv">m</span> <span class="nv">n</span><span class="p">))</span> <span class="mi">1</span><span class="p">)</span>
	<span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">pascal</span> <span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nb">- </span><span class="nv">m</span> <span class="mi">1</span><span class="p">))</span>
		 <span class="p">(</span><span class="nf">pascal</span> <span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">m</span><span class="p">)))))</span>
</pre></div>
</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/sicp-uprazhneniia-iz-glavy-11/" class="u-url">SICP Упражнения из главы 1.1</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Velikii Nehochuha
            </span></p>
            <p class="dateline">
            <a href="posts/sicp-uprazhneniia-iz-glavy-11/" rel="bookmark">
            <time class="published dt-published" datetime="2020-01-09T13:10:04+03:00" itemprop="datePublished" title="2020-01-09 13:10">2020-01-09 13:10</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div id="outline-container-orga933951" class="outline-2">
<h2 id="orga933951">Exercise 1.1.</h2>
<div class="outline-text-2" id="text-orga933951">
<p>
Простейшие арифметические операции, специальные формы if, define, cond.
</p>
<div class="highlight"><pre><span></span><span class="mi">10</span> <span class="c1">;Value: 10</span>
<span class="p">(</span><span class="nb">+ </span><span class="mi">5</span> <span class="mi">3</span> <span class="mi">4</span><span class="p">)</span> <span class="c1">;Value: 12</span>
<span class="p">(</span><span class="nb">- </span><span class="mi">9</span> <span class="mi">1</span><span class="p">)</span> <span class="c1">;Value: 8</span>
<span class="p">(</span><span class="nb">/ </span><span class="mi">6</span> <span class="mi">2</span><span class="p">)</span> <span class="c1">;Value: 3</span>
<span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nb">* </span><span class="mi">2</span> <span class="mi">4</span><span class="p">)</span> <span class="p">(</span><span class="nb">- </span><span class="mi">4</span> <span class="mi">6</span><span class="p">))</span> <span class="c1">;Value: 6</span>
<span class="p">(</span><span class="k">define </span><span class="nv">a</span> <span class="mi">3</span><span class="p">)</span> <span class="c1">;Value: a</span>
<span class="p">(</span><span class="k">define </span><span class="nv">b</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">a</span> <span class="mi">1</span><span class="p">))</span> <span class="c1">;Value: b</span>
<span class="p">(</span><span class="nb">+ </span><span class="nv">a</span> <span class="nv">b</span> <span class="p">(</span><span class="nb">* </span><span class="nv">a</span> <span class="nv">b</span><span class="p">))</span> <span class="c1">;Value: 19</span>
<span class="p">(</span><span class="nb">= </span><span class="nv">a</span> <span class="nv">b</span><span class="p">)</span> <span class="c1">;Value: #f</span>
<span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nb">&gt; </span><span class="nv">b</span> <span class="nv">a</span><span class="p">)</span> <span class="p">(</span><span class="nb">&lt; </span><span class="nv">b</span> <span class="p">(</span><span class="nb">* </span><span class="nv">a</span> <span class="nv">b</span><span class="p">)))</span>
    <span class="nv">b</span>
    <span class="nv">a</span><span class="p">)</span> <span class="c1">;Value: 4</span>
<span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">= </span><span class="nv">a</span> <span class="mi">4</span><span class="p">)</span> <span class="mi">6</span><span class="p">)</span>
      <span class="p">((</span><span class="nb">= </span><span class="nv">b</span> <span class="mi">4</span><span class="p">)</span> <span class="p">(</span><span class="nb">+ </span><span class="mi">6</span> <span class="mi">7</span> <span class="nv">a</span><span class="p">))</span>
      <span class="p">(</span><span class="k">else </span><span class="mi">25</span><span class="p">))</span> <span class="c1">;Value: 16</span>
<span class="p">(</span><span class="nb">+ </span><span class="mi">2</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&gt; </span><span class="nv">b</span> <span class="nv">a</span><span class="p">)</span> <span class="nv">b</span> <span class="nv">a</span><span class="p">))</span> <span class="c1">;Value: 6</span>
<span class="p">(</span><span class="nb">* </span><span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">&gt; </span><span class="nv">a</span> <span class="nv">b</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span>
	 <span class="p">((</span><span class="nb">&lt; </span><span class="nv">a</span> <span class="nv">b</span><span class="p">)</span> <span class="nv">b</span><span class="p">)</span>
	 <span class="p">(</span><span class="k">else </span><span class="mi">-1</span><span class="p">))</span>
   <span class="p">(</span><span class="nb">+ </span><span class="nv">a</span> <span class="mi">1</span><span class="p">))</span> <span class="c1">;Value: 16</span>
</pre></div>
</div>
</div>

<div id="outline-container-org3679b76" class="outline-2">
<h2 id="org3679b76">Exercise 1.2.</h2>
<div class="outline-text-2" id="text-org3679b76">
<p>
Перевести формулу с картинки в scheme.
</p>

<p>
<img src="images/ch1-Z-G-3.gif" alt="nil"></p>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nb">+ </span><span class="mi">5</span> <span class="mi">4</span> <span class="p">(</span><span class="nb">- </span><span class="mi">2</span> <span class="p">(</span><span class="nb">- </span><span class="mi">3</span> <span class="p">(</span><span class="nb">+ </span><span class="mi">6</span> <span class="p">(</span><span class="nb">/ </span><span class="mi">4</span> <span class="mi">3</span><span class="p">)))))</span> <span class="p">(</span><span class="nb">* </span><span class="mi">3</span> <span class="p">(</span><span class="nb">- </span><span class="mi">6</span> <span class="mi">2</span><span class="p">)</span> <span class="p">(</span><span class="nb">- </span><span class="mi">2</span> <span class="mi">7</span><span class="p">)))</span> <span class="c1">;Value: -23/90</span>
</pre></div>
</div>
</div>

<div id="outline-container-org5f5c07d" class="outline-2">
<h2 id="org5f5c07d">Exercise 1.3.</h2>
<div class="outline-text-2" id="text-org5f5c07d">
<p>
Определить функцию сложения квадратов, двух чисел, выбрав их из трех аргументов.
</p>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">squire</span> <span class="nv">x</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">* </span><span class="nv">x</span> <span class="nv">x</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">sum-squire-two-larger</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&gt; </span><span class="nv">x</span> <span class="nv">y</span><span class="p">)</span>
      <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&gt; </span><span class="nv">y</span> <span class="nv">z</span><span class="p">)</span>
	  <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">squire</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nf">squire</span> <span class="nv">y</span><span class="p">))</span>
	  <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">squire</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nf">squire</span> <span class="nv">z</span><span class="p">)))</span>
      <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&gt; </span><span class="nv">x</span> <span class="nv">z</span><span class="p">)</span>
	  <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">squire</span> <span class="nv">y</span><span class="p">)</span> <span class="p">(</span><span class="nf">squire</span> <span class="nv">x</span><span class="p">))</span>
	  <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">squire</span> <span class="nv">y</span><span class="p">)</span> <span class="p">(</span><span class="nf">squire</span> <span class="nv">z</span><span class="p">)))))</span>
<span class="p">(</span><span class="nf">sum-squire-two-larger</span> <span class="mi">0</span> <span class="mi">5</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>

<div id="outline-container-org3b3179a" class="outline-2">
<h2 id="org3b3179a">Exercise 1.4.</h2>
<div class="outline-text-2" id="text-org3b3179a">
<p>
Scheme позволяет выбирать операнды так же как и обычные переменные.
Можно выбирать какую операцию применить в зависимости от условия, то есть функции можно рассматривать как объекты.
</p>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="n">define</span> <span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="n">plus</span><span class="o">-</span><span class="nb">abs</span><span class="o">-</span><span class="n">b</span> <span class="n">a</span> <span class="n">b</span><span class="p">)</span>
  <span class="p">((</span><span class="k">if</span> <span class="p">(</span><span class="o">&gt;</span> <span class="n">b</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="o">-</span><span class="p">)</span> <span class="n">a</span> <span class="n">b</span><span class="p">))</span>

<span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="n">plus</span><span class="o">-</span><span class="nb">abs</span><span class="o">-</span><span class="n">b</span> <span class="mi">5</span> <span class="o">-</span><span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>

<div id="outline-container-org5893909" class="outline-2">
<h2 id="org5893909">Exercise 1.5.</h2>
<div class="outline-text-2" id="text-org5893909">
<p>
Пытаемся разобраться в какой последовательности выполняются процедуры и зачем нужны специальные формы.
</p>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">p</span><span class="p">)</span> <span class="p">(</span><span class="nf">p</span><span class="p">))</span>
<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">test</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="nv">x</span> <span class="mi">0</span><span class="p">)</span>
      <span class="mi">0</span>
      <span class="nv">y</span><span class="p">))</span>

<span class="p">(</span><span class="nf">test</span> <span class="mi">0</span> <span class="p">(</span><span class="nf">p</span><span class="p">))</span>
</pre></div>

<p>
Scheme сначала вычисляет аргументы, а потом тело процедуры (applicative-order evaluation)
при попытке вычислить (test 0 (p)) интерпретатор пытается сначала
посчитать аргументы функции test, что приводит к бесконечному рекурсивному вызову (define (p) (p))
если мы это была специальная форма, а не обычный define, то нам не пришлось бы вычислять (p) и результатом был бы 0
</p>
</div>
</div>

<div id="outline-container-orgbe9d794" class="outline-2">
<h2 id="orgbe9d794">Exercise 1.6.</h2>
<div class="outline-text-2" id="text-orgbe9d794">
<p>
Хакер Алиса не понимает для чего нужны специальные формы. ``Почему я не могу просто определить if как обычную процедуру в терминах cond?'' - спросила она. Её друг Ева Ли Атор согласился что это действительно можно сделать, и она записала свою реализацию специальной формы if через define:
</p>

<div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">new-if</span> <span class="nv">predicate</span> <span class="nv">then-clause</span> <span class="nv">else-clause</span><span class="p">)</span>
  <span class="p">(</span><span class="k">cond </span><span class="p">(</span><span class="nf">predicate</span> <span class="nv">then-clause</span><span class="p">)</span>
	<span class="p">(</span><span class="k">else </span><span class="nv">else-clause</span><span class="p">)))</span>
</pre></div>

<p>
Ева продемонстрировала программу Алисе:
</p>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">new-if</span> <span class="p">(</span><span class="nb">= </span><span class="mi">2</span> <span class="mi">3</span><span class="p">)</span> <span class="mi">0</span> <span class="mi">5</span><span class="p">)</span>
<span class="c1">;; 5</span>
<span class="p">(</span><span class="nf">new-if</span> <span class="p">(</span><span class="nb">= </span><span class="mi">1</span> <span class="mi">1</span><span class="p">)</span> <span class="mi">0</span> <span class="mi">5</span><span class="p">)</span>
<span class="c1">;; 0</span>
</pre></div>

<p>
Обрадовавшись, Алиса использует new-if чтобы переписать программу получения квадратного корня:
</p>

<div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">sqrt-iter</span> <span class="nv">guess</span> <span class="nv">x</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">new-if</span> <span class="p">(</span><span class="nf">good-enough?</span> <span class="nv">guess</span> <span class="nv">x</span><span class="p">)</span>
	  <span class="nv">guess</span>
	  <span class="p">(</span><span class="nf">sqrt-iter</span> <span class="p">(</span><span class="nf">improve</span> <span class="nv">guess</span> <span class="nv">x</span><span class="p">)</span>
		     <span class="nv">x</span><span class="p">)))</span>
</pre></div>

<p>
Что произойдет при попытке использовать новую версию программы? Объясните.
</p>

<p>
При попытке вывполнить программу мы получаем сообщение об ошибке
</p>
<div class="highlight"><pre><span></span><span class="c1">;Aborting!: maximum recursion depth exceeded</span>
</pre></div>

<p>
обычный if (if &lt;predicate&gt; &lt;consequent&gt; &lt;alternative&gt;) сначала выполняет
predicate, затем в зависимости от условия выполнятеся consequent или alternative.
</p>

<p>
в случае же new-if эта правило нарушается, то есть в new-if
(new-if &lt;predicate&gt; &lt;consequent&gt; &lt;alternative&gt;) интерпретатор сначала выполняет predicate и потом не зависимо от результата пытается вычислить результат consequent и alternative (так как это аргументы процедуры new-if), но так как alternative содержит рекурсию, то данная операция выполняется всегда, так как условие проверяется постфактум.
Это и приводит к ошибке (Превышена глубина рекурсии). Поэтому специальная форма if необходима в данном случае.
</p>
</div>
</div>

<div id="outline-container-orgbd61893" class="outline-2">
<h2 id="orgbd61893">Exercise 1.7.</h2>
<div class="outline-text-2" id="text-orgbd61893">
<p>
Ограничение приведенное в книге не подходит для малых чисел а так же для больших. Так же в реальном мире, арифметические операции всегда выполняются с погрешностью. Это делает наш тест неподходящим для больших чисел. Поясните данное утверждение, приведите примеры когда исходный вариант программы работает плохо. В качестве альтернативной реализации напишите программу которая считает результат подходящим когда изменение предположения между двумя итерациями много меньше предыдущего предполагаемого решения, то есть мы будем получать очень малое уточнение за все последующие операции. Попробуйте получить результат с помощью новой процедуры.
</p>

<div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nb">sqrt </span><span class="nv">x</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">good-enough?</span> <span class="nv">guess</span> <span class="nv">x</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">&lt; </span><span class="p">(</span><span class="nb">abs </span><span class="p">(</span><span class="nb">- </span><span class="p">(</span><span class="nf">square</span> <span class="nv">guess</span><span class="p">)</span> <span class="nv">x</span><span class="p">))</span> <span class="mf">0.001</span><span class="p">))</span>
  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">average</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nb">+ </span><span class="nv">x</span> <span class="nv">y</span><span class="p">)</span> <span class="mi">2</span><span class="p">))</span>
  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">improve</span> <span class="nv">guess</span> <span class="nv">x</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">average</span> <span class="nv">guess</span> <span class="p">(</span><span class="nb">/ </span><span class="nv">x</span> <span class="nv">guess</span><span class="p">)))</span>
  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">sqrt-iter</span> <span class="nv">guess</span> <span class="nv">x</span><span class="p">)</span>
    <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">good-enough?</span> <span class="nv">guess</span> <span class="nv">x</span><span class="p">)</span>
	<span class="nv">guess</span>
	<span class="p">(</span><span class="nf">sqrt-iter</span> <span class="p">(</span><span class="nf">improve</span> <span class="nv">guess</span> <span class="nv">x</span><span class="p">)</span> <span class="nv">x</span><span class="p">)))</span>
  <span class="p">(</span><span class="nf">sqrt-iter</span> <span class="mf">1.0</span> <span class="nv">x</span><span class="p">))</span>

<span class="p">(</span><span class="nb">sqrt </span><span class="mf">0.01</span><span class="p">)</span> <span class="c1">;Value: .10032578510960605 Ok</span>
<span class="p">(</span><span class="nb">sqrt </span><span class="mf">0.001</span><span class="p">)</span> <span class="c1">;Value: .04124542607499115 Работает плохо "реальное значение" 0.03162277660168379</span>

<span class="p">(</span><span class="nb">sqrt </span><span class="mi">10000000</span><span class="p">)</span> <span class="c1">;Value: 3162.277660168379, Ok "реальное значение" 3162.2776601683795</span>
<span class="p">(</span><span class="nb">sqrt </span><span class="mi">12345678901234567</span><span class="p">)</span> <span class="c1">;; Слишком много итераций, программа зависает.</span>
</pre></div>

<p>
Новая версия
</p>

<div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nb">sqrt </span><span class="nv">x</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">good-enough?</span> <span class="nv">guess</span> <span class="nv">prev-guess</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">&lt; </span><span class="p">(</span><span class="nb">abs </span><span class="p">(</span><span class="nb">- </span><span class="nv">guess</span> <span class="nv">prev-guess</span><span class="p">))</span> <span class="mf">0.001</span><span class="p">))</span> <span class="c1">;; изменение guess менее десятой доли процента</span>
  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">average</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nb">+ </span><span class="nv">x</span> <span class="nv">y</span><span class="p">)</span> <span class="mi">2</span><span class="p">))</span>
  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">improve</span> <span class="nv">guess</span> <span class="nv">x</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">average</span> <span class="nv">guess</span> <span class="p">(</span><span class="nb">/ </span><span class="nv">x</span> <span class="nv">guess</span><span class="p">)))</span>
  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">sqrt-iter</span> <span class="nv">g</span> <span class="nv">prev-g</span> <span class="nv">x</span><span class="p">)</span>
    <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">good-enough?</span> <span class="nv">g</span> <span class="nv">prev-g</span><span class="p">)</span>
	<span class="nv">g</span>
	<span class="p">(</span><span class="nf">sqrt-iter</span> <span class="p">(</span><span class="nf">improve</span> <span class="nv">g</span> <span class="nv">x</span><span class="p">)</span> <span class="nv">g</span> <span class="nv">x</span><span class="p">)))</span>
  <span class="p">(</span><span class="nf">sqrt-iter</span> <span class="mf">1.0</span> <span class="mf">1.002</span> <span class="nv">x</span><span class="p">))</span>

<span class="p">(</span><span class="nb">sqrt </span><span class="mi">2</span><span class="p">)</span>
<span class="p">(</span><span class="nb">sqrt </span><span class="mi">12345678901234567</span><span class="p">)</span> <span class="c1">;Value: 111111110.6111111</span>
<span class="p">(</span><span class="nb">sqrt </span><span class="mf">0.001</span><span class="p">)</span> <span class="c1">;Value: .03162278245070105</span>
</pre></div>

<p>
Видим что стало работать быстро на больших числах и точно на любых с заданной погрешностью.
</p>
</div>
</div>

<div id="outline-container-orgf299247" class="outline-2">
<h2 id="orgf299247">Exercise 1.8.</h2>
<div class="outline-text-2" id="text-orgf299247">
<p>
Метод Ньютона для кубического корня основан на факте что приближенное значение можно искать по формуле с картинки. Реализуйте метод извлечения кубического корня из числа.
</p>

<p>
<img src="images/ch1-Z-G-5.gif" alt="nil"></p>

<div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">cube-root</span> <span class="nv">x</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">good-enough?</span> <span class="nv">guess</span> <span class="nv">prev-guess</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">&lt; </span><span class="p">(</span><span class="nb">abs </span><span class="p">(</span><span class="nb">- </span><span class="nv">guess</span> <span class="nv">prev-guess</span><span class="p">))</span> <span class="mf">0.001</span><span class="p">))</span>
  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">average</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nb">+ </span><span class="nv">x</span> <span class="nv">y</span><span class="p">)</span> <span class="mi">2</span><span class="p">))</span>
  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">improve</span> <span class="nv">guess</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">average</span> <span class="nv">guess</span> <span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nb">/ </span><span class="nv">x</span> <span class="p">(</span><span class="nf">square</span> <span class="nv">guess</span><span class="p">))</span> <span class="p">(</span><span class="nb">* </span><span class="mi">2</span> <span class="nv">guess</span><span class="p">))</span> <span class="mi">3</span><span class="p">)))</span>
  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">sqrt-iter</span> <span class="nv">g</span> <span class="nv">prev-g</span><span class="p">)</span>
    <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">good-enough?</span> <span class="nv">g</span> <span class="nv">prev-g</span><span class="p">)</span>
	<span class="nv">g</span>
	<span class="p">(</span><span class="nf">sqrt-iter</span> <span class="p">(</span><span class="nf">improve</span> <span class="nv">g</span><span class="p">)</span> <span class="nv">g</span><span class="p">)))</span>
  <span class="p">(</span><span class="nf">sqrt-iter</span> <span class="mf">1.0</span> <span class="mf">1.002</span><span class="p">))</span>

<span class="p">(</span><span class="nf">cube-root</span> <span class="mi">27</span><span class="p">)</span> <span class="c1">;Value: 3.000935399157486</span>
</pre></div>
</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/zadachi-po-kursu-sicp/" class="u-url">Задачи по курсу SICP. Введение.</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Velikii Nehochuha
            </span></p>
            <p class="dateline">
            <a href="posts/zadachi-po-kursu-sicp/" rel="bookmark">
            <time class="published dt-published" datetime="2020-01-08T15:07:03+03:00" itemprop="datePublished" title="2020-01-08 15:07">2020-01-08 15:07</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>
Есть такой замечательный курс <a href="https://mitpress.mit.edu/sites/default/files/sicp/full-text/book/book-Z-H-4.html#%_toc_start">SICP</a>. Я его когда-то начинал читать, но до конца не прошел, думаю на этот раз получится. Буду делать упражнения из него и выкладывать сюда свои решения.
Первым делом надо настроить emacs что бы удобно было тестировать программы. <code>[4/4]</code>
</p>
<ul class="org-ul">
<li class="on">
<code>[X]</code> Установить mit scheme по <a href="https://www.gnu.org/software/mit-scheme/documentation/mit-scheme-user/Unix-Installation.html">Инструкции.</a>
</li>
<li class="on">
<code>[X]</code> Создать файл в 1-ой вкладке emacs c разрешением .scm файл откроется в scheme-mode</li>
<li class="on">
<code>[X]</code> Запустить в другой окне (C-x 3 - создать окно) M-x run-scheme RET</li>
<li class="on">
<code>[X]</code> Любое выражение из первой вкладки можно выполнить по C-x C-e.</li>
</ul>
<p>
Получится что-то вроде:
</p>

<p>
<img src="images/Screenshot_2020-01-08_08-08-55.thumbnail.png" alt="nil"></p>

<p>
Пишем что-то в правой вкладке, жмем C-x C-e, видим результат в левой.
</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/nastroika-emacs-dlia-svelte/" class="u-url">Настройка emacs для svelte</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Velikii Nehochuha
            </span></p>
            <p class="dateline">
            <a href="posts/nastroika-emacs-dlia-svelte/" rel="bookmark">
            <time class="published dt-published" datetime="2019-11-26T22:58:31+03:00" itemprop="datePublished" title="2019-11-26 22:58">2019-11-26 22:58</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div id="outline-container-orgf99b1d5" class="outline-2">
<h2 id="orgf99b1d5">Установить необходимые пакеты в emacs</h2>
<div class="outline-text-2" id="text-orgf99b1d5">
<p>
Я добавил поддержку svelte шаблонов сравнительно недавно, поэтому web-mode
c поддержкой svelte доступен пока только в unstable melpa
</p>

<div class="highlight"><pre><span></span><span class="nv">package-install</span> <span class="nv">web-mode</span>
<span class="nv">package-install</span> <span class="nv">add-node-modules-path</span>
<span class="nv">package-install</span> <span class="nv">flycheck</span>
</pre></div>
</div>
</div>

<div id="outline-container-org53994fa" class="outline-2">
<h2 id="org53994fa">Настроим web-mode</h2>
<div class="outline-text-2" id="text-org53994fa">
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nb">load</span> <span class="s">"~/.emacs.d/web-mode.el"</span><span class="p">)</span>
<span class="p">(</span><span class="nv">add-to-list</span> <span class="ss">'auto-mode-alist</span> <span class="o">'</span><span class="p">(</span><span class="s">"\\.svelte\\'"</span> <span class="o">.</span> <span class="nv">web-mode</span><span class="p">))</span>
<span class="p">(</span><span class="nv">add-to-list</span> <span class="ss">'auto-mode-alist</span> <span class="o">'</span><span class="p">(</span><span class="s">"\\.html\\'"</span> <span class="o">.</span> <span class="nv">web-mode</span><span class="p">))</span>
<span class="p">(</span><span class="nv">add-to-list</span> <span class="ss">'auto-mode-alist</span> <span class="o">'</span><span class="p">(</span><span class="s">"\\.jsx\\'"</span> <span class="o">.</span> <span class="nv">web-mode</span><span class="p">))</span>
<span class="p">(</span><span class="nv">add-to-list</span> <span class="ss">'auto-mode-alist</span> <span class="o">'</span><span class="p">(</span><span class="s">"\\.js\\'"</span> <span class="o">.</span> <span class="nv">web-mode</span><span class="p">))</span>

<span class="p">(</span><span class="k">setq</span> <span class="nv">web-mode-engines-alist</span>
    <span class="o">'</span><span class="p">((</span><span class="s">"django"</span>    <span class="o">.</span> <span class="s">"\\.html\\'"</span><span class="p">))</span>
<span class="p">)</span>
<span class="p">(</span><span class="nb">defun</span> <span class="nv">my-web-mode-hook</span> <span class="p">()</span>
  <span class="s">"Hooks for Web mode."</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">web-mode-indent-style</span> <span class="mi">2</span><span class="p">)</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">web-mode-markup-indent-offset</span> <span class="mi">2</span><span class="p">)</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">web-mode-css-indent-offset</span> <span class="mi">2</span><span class="p">)</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">web-mode-code-indent-offset</span> <span class="mi">2</span><span class="p">)</span> <span class="c1">;; 4</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">web-mode-style-padding</span> <span class="mi">2</span><span class="p">)</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">web-mode-script-padding</span> <span class="mi">2</span><span class="p">)</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">web-mode-block-padding</span> <span class="mi">2</span><span class="p">)</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">web-mode-part-padding</span> <span class="mi">2</span><span class="p">)</span>
<span class="p">)</span>
<span class="p">(</span><span class="nv">add-hook</span> <span class="ss">'web-mode-hook</span>  <span class="ss">'my-web-mode-hook</span><span class="p">)</span>
</pre></div>
</div>
</div>


<div id="outline-container-org8aa27a8" class="outline-2">
<h2 id="org8aa27a8">Настройка eslint</h2>
<div class="outline-text-2" id="text-org8aa27a8">
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nb">when</span> <span class="p">(</span><span class="nv">maybe-require-package</span> <span class="ss">'add-node-modules-path</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">after-load</span> <span class="ss">'web-mode</span>
    <span class="p">(</span><span class="nv">add-hook</span> <span class="ss">'web-mode-hook</span> <span class="ss">'add-node-modules-path</span><span class="p">)))</span>
<span class="p">(</span><span class="nv">setenv</span> <span class="s">"PATH"</span> <span class="p">(</span><span class="nv">concat</span> <span class="p">(</span><span class="nv">getenv</span> <span class="s">"PATH"</span><span class="p">)</span> <span class="s">":/home/anton/.nvm/versions/node/v10.15.3/bin/"</span><span class="p">))</span>
<span class="p">(</span><span class="k">setq</span> <span class="nv">exec-path</span> <span class="p">(</span><span class="nb">append</span> <span class="nv">exec-path</span> <span class="o">'</span><span class="p">(</span><span class="s">"/home/anton/.nvm/versions/node/v10.15.3/bin"</span><span class="p">)))</span>
<span class="p">(</span><span class="k">setq</span> <span class="nv">flycheck-javascript-eslint-executable</span> <span class="s">"eslint_d"</span><span class="p">)</span>
<span class="p">(</span><span class="nv">with-eval-after-load</span> <span class="ss">'flycheck</span>
  <span class="p">(</span><span class="nv">flycheck-add-mode</span> <span class="ss">'javascript-eslint</span> <span class="ss">'web-mode</span><span class="p">))</span>
</pre></div>
</div>

<div id="outline-container-org5604b4a" class="outline-3">
<h3 id="org5604b4a">установить глобально eslint<sub>d</sub>
</h3>
<div class="outline-text-3" id="text-org5604b4a">
<div class="highlight"><pre><span></span>npm install -g eslint eslint_d
</pre></div>
</div>
</div>
<div id="outline-container-orgf8cce70" class="outline-3">
<h3 id="orgf8cce70">установить в директорию с проектом</h3>
<div class="outline-text-3" id="text-orgf8cce70">
<div class="highlight"><pre><span></span>npm install eslint-plugin-svelte3 babel-eslint --save-dev
</pre></div>
</div>
</div>

<div id="outline-container-org632c4ab" class="outline-3">
<h3 id="org632c4ab">в директорию с проектом поместить .eslintrc</h3>
<div class="outline-text-3" id="text-org632c4ab">
<div class="highlight"><pre><span></span>{
  "parserOptions": { "ecmaVersion": 2019, "sourceType": "module" },
  "env": {
    "es6": true,
    "browser": true,
    "node": true
  },
  "plugins": [
    "svelte3"
  ],
  "overrides": [
    {
      "files": ["**/*.svelte"],
      "processor": "svelte3/svelte3"
    }
  ],
  "rules": {
    //"no-undefined": 2,
    "no-unused-vars": 2,
    "no-use-before-define": 2
  }
}
</pre></div>
</div>
</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/binarnyi-poisk-realizatsiia-na-python/" class="u-url">Бинарный поиск (реализация на python)</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Velikii Nehochuha
            </span></p>
            <p class="dateline">
            <a href="posts/binarnyi-poisk-realizatsiia-na-python/" rel="bookmark">
            <time class="published dt-published" datetime="2019-11-17T20:14:29+03:00" itemprop="datePublished" title="2019-11-17 20:14">2019-11-17 20:14</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>
Представьте англо-русский словарь и вам нужно найти какое-то слово на букву "o".
Для этого мы откроем словарь посередине и в зависимости на какую букву будет начинаться
слово примем решение левая или правая половина листов нам нужна. Повторим это пока не найдем страницу с буквой "o".
</p>

<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">binary_search</span><span class="p">(</span><span class="n">iterable</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
    <span class="n">minimum</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">maximum</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">iterable</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">minimum</span><span class="p">,</span> <span class="n">maximum</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">minimum</span> <span class="o">&lt;</span> <span class="n">maximum</span><span class="p">:</span>
	<span class="n">midle</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">maximum</span> <span class="o">+</span> <span class="n">minimum</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
	<span class="nb">print</span><span class="p">(</span><span class="s1">'midle'</span><span class="p">,</span> <span class="n">midle</span><span class="p">)</span>
	<span class="n">current</span> <span class="o">=</span> <span class="n">iterable</span><span class="p">[</span><span class="n">midle</span><span class="p">]</span>
	<span class="nb">print</span><span class="p">(</span><span class="s1">'current'</span><span class="p">,</span> <span class="n">current</span><span class="p">)</span>
	<span class="nb">print</span><span class="p">(</span><span class="s1">'item'</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
	<span class="k">if</span> <span class="n">current</span> <span class="o">==</span> <span class="n">item</span><span class="p">:</span>
	    <span class="k">return</span> <span class="n">midle</span>
	<span class="k">elif</span> <span class="n">item</span> <span class="o">&gt;</span> <span class="n">current</span><span class="p">:</span>
	    <span class="nb">print</span><span class="p">(</span><span class="s1">'ehrhe'</span><span class="p">)</span>
	    <span class="n">minimum</span> <span class="o">=</span> <span class="n">midle</span>
	<span class="k">elif</span> <span class="n">item</span> <span class="o">&lt;</span> <span class="n">current</span><span class="p">:</span>
	    <span class="n">maximum</span> <span class="o">=</span> <span class="n">midle</span>
	<span class="k">else</span><span class="p">:</span>
	    <span class="k">return</span> <span class="kc">None</span>

<span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">binary_search</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">res</span> <span class="o">=</span> <span class="mi">7</span>
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/poluchit-sms-s-telefona/" class="u-url">Получить смс с android телефона</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Velikii Nehochuha
            </span></p>
            <p class="dateline">
            <a href="posts/poluchit-sms-s-telefona/" rel="bookmark">
            <time class="published dt-published" datetime="2019-11-02T23:40:11+03:00" itemprop="datePublished" title="2019-11-02 23:40">2019-11-02 23:40</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div id="outline-container-org38b0488" class="outline-2">
<h2 id="org38b0488">Если есть root доступ по adb</h2>
<div class="outline-text-2" id="text-org38b0488">
<p>
Подключаемся по adb и запускаем запускаем отладочный сервер
</p>

<div class="highlight"><pre><span></span>adb root
adb start-server
adb tcpip 5555
adb connect host:5555 # adb over wi-fi
</pre></div>

<p>
Все SMS хранятся в базе данных mmssms.db, ищем её на устройстве
</p>
<div class="highlight"><pre><span></span>find / -name "*mmssms*" # in my case it is /data/user_de/0/com.android.providers.telephony/databases/mmssms.db
</pre></div>

<p>
Считываем из базы данных
</p>
<div class="highlight"><pre><span></span>sqlite3 /data/user_de/0/com.android.providers.telephony/databases/mmssms.db
select * from sms limit 3;
</pre></div>

<p>
Я часто раздаю интернет через hotsport с телефона, поэтому однострочником будет
</p>
<div class="highlight"><pre><span></span>ip -4 route list 0/0 | awk '{print $3}' | (read _default_route; adb connect $_default_route:5555) &amp;&amp; adb root &amp;&amp; adb shell 'sqlite3 /data/user_de/0/com.android.providers.telephony/databases/mmssms.db -batch "select * from sms limit 2";'
</pre></div>
</div>
</div>
    </div>
    </article>
</div>



         </main><footer id="footer"><p>Contents © 2020         <a href="mailto:anton.s.pilipenko@gmail.com">Velikii Nehochuha</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         </p>
            
        </footer>
</div>
                <script src="assets/js/all-nocdn.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script>
</body>
</html>
