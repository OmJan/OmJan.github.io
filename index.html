<!DOCTYPE html>
<html>
  <head>
    <title>OmJan page</title>
    <style type="text/css">
      html{ height: 100%; }
      body{ display: flex; flex-direction: column; height: 100%;}
      header{ flex: 0 0 auto; }
      .wrap-content{ flex: 1 0 auto; }
      .main-content {
        display: flex;
        flex-direction: row;
        justify-content: center;
        flex-wrap: wrap;
      }
      .main-content section { width: 320px; }
      footer{ flex: 0 0 auto; }
      .st0{fill:black;}
      .st1{fill:green;}
      .st2{fill:red;}
    </style>
  </head>
  <body>
    <header></header>
    <section class="wrap-content">
      <div class="main-content">
        <section>
          <div class="container">
            <a href="http://stackoverflow.com/users/4638004/janom?theme=clean">
              <img src="http://stackoverflow.com/users/flair/4638004.png" width="208" height="58" alt="profile for Janom at Stack Overflow, Q&amp;A for professional and enthusiast programmers" title="profile for Janom at Stack Overflow, Q&amp;A for professional and enthusiast programmers">
            </a>
          </div>
        </section>
        <section>
          <button id="stop">Pause</button><button id="start">Start</button><button id="reset">Reset</button>
          <div class="multik" style="width: 320px; height:500px; background: #aaa;">
            <svg xmlns="http://www.w3.org/2000/svg" id="solly" viewBox="0 0 320 500">
              <g id="Sun2">
                <circle id="gameBall" class="st2" cx="10" cy="50.8" r="5"/>
                <polyline points="0, 500.0 1, 497.01 2, 494.04 3, 491.09 4, 488.16 5, 485.25 6, 482.36 7, 479.49 8, 476.64 9, 473.81 10, 471.0 11, 468.21 12, 465.44 13, 462.69 14, 459.96 15, 457.25 16, 454.56 17, 451.89 18, 449.24 19, 446.61 20, 444.0 21, 441.41 22, 438.84 23, 436.29 24, 433.76 25, 431.25 26, 428.76 27, 426.29 28, 423.84 29, 421.41 30, 419.0 31, 416.61 32, 414.24 33, 411.89 34, 409.56 35, 407.25 36, 404.96 37, 402.69 38, 400.44 39, 398.21 40, 396.0 41, 393.81 42, 391.64 43, 389.49 44, 387.36 45, 385.25 46, 383.16 47, 381.09 48, 379.04 49, 377.01 50, 375.0 51, 373.01 52, 371.04 53, 369.09 54, 367.16 55, 365.25 56, 363.36 57, 361.49 58, 359.64 59, 357.81 60, 356.0 61, 354.21 62, 352.44 63, 350.69 64, 348.96 65, 347.25 66, 345.56 67, 343.89 68, 342.24 69, 340.61 70, 339.0 71, 337.41 72, 335.84 73, 334.29 74, 332.76 75, 331.25 76, 329.76 77, 328.29 78, 326.84 79, 325.41 80, 324.0 81, 322.61 82, 321.24 83, 319.89 84, 318.56 85, 317.25 86, 315.96 87, 314.69 88, 313.44 89, 312.21 90, 311.0 91, 309.81 92, 308.64 93, 307.49 94, 306.36 95, 305.25 96, 304.16 97, 303.09 98, 302.04 99, 301.01 100, 300.0 101, 299.01 102, 298.04 103, 297.09 104, 296.16 105, 295.25 106, 294.36 107, 293.49 108, 292.64 109, 291.81 110, 291.0 111, 290.21 112, 289.44 113, 288.69 114, 287.96 115, 287.25 116, 286.56 117, 285.89 118, 285.24 119, 284.61 120, 284.0 121, 283.41 122, 282.84 123, 282.29 124, 281.76 125, 281.25 126, 280.76 127, 280.29 128, 279.84 129, 279.41 130, 279.0 131, 278.61 132, 278.24 133, 277.89 134, 277.56 135, 277.25 136, 276.96 137, 276.69 138, 276.44 139, 276.21 140, 276.0 141, 275.81 142, 275.64 143, 275.49 144, 275.36 145, 275.25 146, 275.16 147, 275.09 148, 275.04 149, 275.01 150, 275.0 151, 275.01 152, 275.04 153, 275.09 154, 275.16 155, 275.25 156, 275.36 157, 275.49 158, 275.64 159, 275.81 160, 276.0 161, 276.21 162, 276.44 163, 276.69 164, 276.96 165, 277.25 166, 277.56 167, 277.89 168, 278.24 169, 278.61 170, 279.0 171, 279.41 172, 279.84 173, 280.29 174, 280.76 175, 281.25 176, 281.76 177, 282.29 178, 282.84 179, 283.41 180, 284.0 181, 284.61 182, 285.24 183, 285.89 184, 286.56 185, 287.25 186, 287.96 187, 288.69 188, 289.44 189, 290.21 190, 291.0 191, 291.81 192, 292.64 193, 293.49 194, 294.36 195, 295.25 196, 296.16 197, 297.09 198, 298.04 199, 299.01 200, 300.0 201, 301.01 202, 302.04 203, 303.09 204, 304.16 205, 305.25 206, 306.36 207, 307.49 208, 308.64 209, 309.81 210, 311.0 211, 312.21 212, 313.44 213, 314.69 214, 315.96 215, 317.25 216, 318.56 217, 319.89 218, 321.24 219, 322.61 220, 324.0 221, 325.41 222, 326.84 223, 328.29 224, 329.76 225, 331.25 226, 332.76 227, 334.29 228, 335.84 229, 337.41 230, 339.0 231, 340.61 232, 342.24 233, 343.89 234, 345.56 235, 347.25 236, 348.96 237, 350.69 238, 352.44 239, 354.21 240, 356.0 241, 357.81 242, 359.64 243, 361.49 244, 363.36 245, 365.25 246, 367.16 247, 369.09 248, 371.04 249, 373.01 250, 375.0 251, 377.01 252, 379.04 253, 381.09 254, 383.16 255, 385.25 256, 387.36 257, 389.49 258, 391.64 259, 393.81 260, 396.0 261, 398.21 262, 400.44 263, 402.69 264, 404.96 265, 407.25 266, 409.56 267, 411.89 268, 414.24 269, 416.61 270, 419.0 271, 421.41 272, 423.84 273, 426.29 274, 428.76 275, 431.25 276, 433.76 277, 436.29 278, 438.84 279, 441.41 280, 444.0 281, 446.61 282, 449.24 283, 451.89 284, 454.56 285, 457.25 286, 459.96 287, 462.69 288, 465.44 289, 468.21 290, 471.0 291, 473.81 292, 476.64 293, 479.49 294, 482.36 295, 485.25 296, 488.16 297, 491.09 298, 494.04 299, 497.01 300, 500.0 301, 503.01 302, 506.04 303, 509.09 304, 512.16 305, 515.25 306, 518.36 307, 521.49 308, 524.64 309, 527.81 310, 531.0 311, 534.21 312, 537.44 313, 540.69 314, 543.96 315, 547.25 316, 550.56 317, 553.89 318, 557.24 319, 560.61" fill="rgb(249,249,249)" stroke-width="1" stroke="rgb(0,0,0)"/>
                <!--y = x*x/100 -3*x + 400 -->
                <!--y' = f(x') + (2*x'/100 - 3)(x-x')-->
              </g>
            </svg>
          </div>
        </section>
        <section>
        </section>
      </div>
    </section>
    <footer>
      <nav>
        <ul>
          <li><a href="https://github.com/OmJan">Github</a></li>
        </ul>
      </nav>
    </footer>
    <script type="text/javascript">
    var DELTA = 1000 / 200;

      var ball = function () {
        var self = this;
        var e = document.getElementById ( 'gameBall' );
        this.xSpeed = 50/1000.0;
        this.ySpeed = 0;
        this.yAcceleration = 0.0001;
        this.xAcceleration = 0;
        this.delta = DELTA;
        this.x = parseFloat(e.getAttribute( 'cx' ));
        this.y = parseFloat(e.getAttribute( 'cy' ));
        this.bang = false;

        this.stopBall = function stopBall() {
          this.xSpeed = 0;
          this.ySpeed = 0;
          this.yAcceleration = 0;
          this.xAcceleration = 0;
        };

        this.setNewSpeed = function setNewSpeed() {
          self.xSpeed = self.xSpeed + self.xAcceleration * self.delta;
          self.ySpeed = self.ySpeed + self.yAcceleration * self.delta;
        };
        this.getNewPosition = function getNewPosition() {
          var e, cxNew, cyNew;
          e = document.getElementById ( 'gameBall' );
          var cxPrev = e.getAttribute( 'cx' );
          var cyPrev = e.getAttribute( 'cy' );
          cyNew = parseFloat(cyPrev) + self.ySpeed * self.delta + self.yAcceleration * self.delta * self.delta / 2;
          cxNew = parseFloat(cxPrev) + self.xSpeed * self.delta + self.xAcceleration * self.delta * self.delta / 2;
          e.setAttribute ( "cx", cxNew );
          e.setAttribute ( "cy", cyNew );

          if (self.checkBreakPoint(cxNew, cyNew)) {
            var Tan = this.xSpeed / this.ySpeed;
            var aTan = Math.atan(Tan);
            var absV = Math.sqrt((self.xSpeed*self.xSpeed + self.ySpeed*self.ySpeed));


            console.log(2*cxNew/100 - 3);


            var tanParabola = 2*cxNew/100 - 3;
            if (tanParabola > 0) {
              console.log('herhehr');
              self.xSpeed =  absV * Math.cos(aTan);
              self.ySpeed = absV * Math.sin(aTan);
            } else {
              console.log('herhehr');
              self.xSpeed =  -absV * Math.cos(aTan);
              self.ySpeed = -absV * Math.sin(aTan);
            }
            // f(x') + (2*x'/100 - 3)(x-x')
            // self.stopBall();
          } else {
            self.setNewSpeed();
          }
        };
        this.checkBreakPoint = function checkBreakPoint(x, y) {
          function hasPoint(x, y) {
            var yCalc = x*x/100 -3*x + 500;
            if (((Math.floor(y) - 1) <  Number((yCalc).toFixed(1))) && (Number((yCalc).toFixed(1)) < (Math.ceil(y) + 1))) {
              return true;
            } else {
              return false;
            }
          }
          return hasPoint(x, y);
        };
      };
      var game = function () {
        var self = this;
        this.animate = function animate() {
          self.gameBall.getNewPosition();
        };
        this.play = function play() {
          var gameBall = new ball();
          self.gameBall = gameBall;
          self.animateInterval = setInterval(self.animate, DELTA);
        };
        this.stop = function stop() {
          clearInterval(self.animateInterval);
        };
        this.start = function start() {
          self.animateInterval = setInterval(self.animate, DELTA);
        };
        this.reset = function reset() {
          clearInterval(self.animateInterval);
          delete self.gameBall;
          var gameBall = new ball();
          e = document.getElementById ( 'gameBall' );
          e.setAttribute ( "cx", gameBall.x );
          e.setAttribute ( "cy", gameBall.y );
          self.gameBall = gameBall;
          self.animateInterval = setInterval(self.animate, DELTA);
        };
      };
      var Game = new game();
      Game.play();

      var stop = document.getElementById('stop');
      var start = document.getElementById('start');
      var reset = document.getElementById('reset');
      stop.onclick = Game.stop;
      start.onclick = Game.start;
      reset.onclick = Game.reset;
    </script>
  </body>
</html>
