<!DOCTYPE html>
<html prefix="
        og: http://ogp.me/ns# article: http://ogp.me/ns/article#
    " vocab="http://ogp.me/ns" lang="ru">
<head>
<meta charset="utf-8">
<meta name="description" content="IT blog">
<meta name="viewport" content="width=device-width">
<title>VelikiiNehochuha Blog</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="ru" href="rss.xml">
<link rel="canonical" href="http://velikiinehochuha.github.io/">
<link rel="next" href="index-1.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5shiv-printshiv.min.js"></script><![endif]--><link rel="prefetch" href="posts/sicp-134-protsedury-kak-vozvrashchaemye-znacheniia-uprazhneniia-140-146/" type="text/html">
</head>
<body>
    <a href="#content" class="sr-only sr-only-focusable">Перейти к главному содержимому</a>
    <div id="container">
             <header id="header"><h1 id="brand"><a href="http://velikiinehochuha.github.io/" title="VelikiiNehochuha Blog" rel="home">

        <span id="blog-title">VelikiiNehochuha Blog</span>
    </a></h1>

        
            <nav id="menu"><ul>
<li><a href="archive.html">Архив</a></li>
                <li><a href="categories/">Тэги</a></li>
                <li><a href="rss.xml">RSS лента</a></li>

    
    
    
    </ul></nav></header><main id="content"><div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/sicp-134-protsedury-kak-vozvrashchaemye-znacheniia-uprazhneniia-140-146/" class="u-url">SICP 1.34 Процедуры как возвращаемые значения, упражнения 1.40-1.46</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Velikii Nehochuha
            </span></p>
            <p class="dateline">
            <a href="posts/sicp-134-protsedury-kak-vozvrashchaemye-znacheniia-uprazhneniia-140-146/" rel="bookmark">
            <time class="published dt-published" datetime="2020-01-15T19:17:40+03:00" itemprop="datePublished" title="2020-01-15 19:17">2020-01-15 19:17</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div>
 <div class="chapter-block">
  <h2>
   Упражнение 1.40
  </h2>
  <div>
   <div>
    <p>
     Определите процедуру cubic, которая может быть использована вместе с newtons-method для нахождения корней <span class="inline-formula"><img class="img-inline-formula img-formula" width="158" height="16" src="formulae/sXwqMiZD7UL6oHbZ.i0kVUnRMNW4SotUtae6OQ.png" alt="x^3+a\cdot x^2+b\cdot x+c" title="x^3+a\cdot x^2+b\cdot x+c"></span>
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno">1 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">cubic</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span><span class="p">)</span>
<span class="lineno">2 </span>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span>
<span class="lineno">3 </span>    <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nb">* </span><span class="nv">x</span> <span class="nv">x</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">* </span><span class="nv">a</span> <span class="nv">x</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">* </span><span class="nv">b</span> <span class="nv">x</span><span class="p">)</span> <span class="nv">c</span><span class="p">)))</span>
<span class="lineno">4 </span>
<span class="lineno">5 </span><span class="p">(</span><span class="nf">newtons-method</span> <span class="p">(</span><span class="nf">cubic</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span>
</pre>
</div>  </div>
 </div>
 <div class="chapter-block">
  <h2>
   Упражнение 1.41
  </h2>
  <div>
   <div>
    <p>
     Определите процедуру double которая принимает процедуру как аргумент и возвращает процедуру, которая применяет переданную процедуру дважды. К примеру (double inc) должена вернуть процедуру которая два раза делает inc. Какое значение вернет (((double (double double)) inc) 5)?
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno">1 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">double</span> <span class="nv">f</span><span class="p">)</span>
<span class="lineno">2 </span>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span>
<span class="lineno">3 </span>    <span class="p">(</span><span class="nf">f</span> <span class="p">(</span><span class="nf">f</span> <span class="nv">x</span><span class="p">))))</span>
<span class="lineno">4 </span><span class="p">(((</span><span class="nf">double</span> <span class="p">(</span><span class="nf">double</span> <span class="nv">double</span><span class="p">))</span> <span class="nv">inc</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span> <span class="c1">; 16</span>
</pre>
</div>  </div>
 </div>
 <div class="chapter-block">
  <h2>
   Упражнение 1.42
  </h2>
  <div>
   <div>
    <p>
     Пусть f и g две функции одного аргумента. Композицией f после g называется <span class="inline-formula"><img class="img-inline-formula img-formula" width="93" height="17" src="formulae/gZRHSPvfgublk.GfaBQZG_htxW7etTPzHVF0_g.png" alt="x\mapsto f(g(x))" title="x\mapsto f(g(x))"></span>. Определите процедуру compose, которая составляет композицию двух функций.
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno">1 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">compose</span> <span class="nv">f</span> <span class="nv">g</span><span class="p">)</span>
<span class="lineno">2 </span>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="nf">f</span> <span class="p">(</span><span class="nf">g</span> <span class="nv">x</span><span class="p">))))</span>
<span class="lineno">3 </span><span class="p">((</span><span class="nf">compose</span> <span class="nv">square</span> <span class="nv">inc</span><span class="p">)</span> <span class="mi">6</span><span class="p">)</span> <span class="c1">; 49</span>
</pre>
</div>  </div>
 </div>
 <div class="chapter-block">
  <h2>
   Упражнение 1.43
  </h2>
  <div>
   <div>
    <p>
     Если f числовая функция и n положительное целое, тогда мы можем n раз применить функцию к результату выполнения исходной функции, то есть <span class="inline-formula"><img class="img-inline-formula img-formula" width="124" height="17" src="formulae/HU6llSc5.Zpyr.Hr5NnGjQGw2XI4.RQN15cVAQ.png" alt="f(f(...(f(x))...))" title="f(f(...(f(x))...))"></span>. К примеру, если f(x) = x + 1, тогда если мы применим функцию n раз, то получим функцию f(x)=x+n. Если f - возведение в квадрат,тогда результирующая функция будет x в степени 2n. Напишите процедуру, что бы её можно было использовать вот таким образом ((repeated square 2) 5), используйте compose из упражнения 1.42.
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno">1 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">repeated</span> <span class="nv">f</span> <span class="nv">n</span><span class="p">)</span>
<span class="lineno">2 </span>  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="nv">n</span> <span class="mi">1</span><span class="p">)</span>
<span class="lineno">3 </span>      <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="nf">f</span> <span class="nv">x</span><span class="p">))</span>
<span class="lineno">4 </span>      <span class="p">(</span><span class="nf">compose</span> <span class="nv">f</span> <span class="p">(</span><span class="nf">repeated</span> <span class="nv">f</span> <span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="mi">1</span><span class="p">)))))</span>
<span class="lineno">5 </span>
<span class="lineno">6 </span><span class="p">((</span><span class="nf">repeated</span> <span class="nv">square</span> <span class="mi">2</span><span class="p">)</span> <span class="mi">5</span><span class="p">)</span> <span class="c1">;; 625</span>
</pre>
</div>  </div>
 </div>
 <div class="chapter-block">
  <h2>
   Упражнение 1.44
  </h2>
  <div>
   <div>
    <p>
     Идея сглаживающей функции важна при обработке сигналов. Если f - функция и dx - некоторое малое приращение, тогда сглаженная версия функции f, эта функция значение которой в точке x среднее между f(x-dx) и f(x+dx). Напишете процедуру smooth которая принимает на вход функцию и возвращает сглаженную функцию f. Иногда полезно применить сглаживание несколько раз (то есть сгладить сглаженную функцию) что-бы получить n-раз сглаженную функцию. Покажите как генерировать n раз сглаженную функцию при помощи процедуры repeat из 1.43.
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno">1 </span><span class="p">(</span><span class="k">define </span><span class="nv">dx</span> <span class="mf">0.00001</span><span class="p">)</span>
<span class="lineno">2 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">smooth</span> <span class="nv">f</span><span class="p">)</span>
<span class="lineno">3 </span>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="nf">average</span> <span class="p">(</span><span class="nf">f</span> <span class="p">(</span><span class="nb">- </span><span class="nv">x</span> <span class="nv">dx</span><span class="p">))</span> <span class="p">(</span><span class="nf">f</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">x</span> <span class="nv">dx</span><span class="p">)))))</span>
<span class="lineno">4 </span>
<span class="lineno">5 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">smooth-n</span> <span class="nv">f</span> <span class="nv">n</span><span class="p">)</span>
<span class="lineno">6 </span>  <span class="p">((</span><span class="nf">repeated</span> <span class="nv">smooth</span> <span class="nv">n</span><span class="p">)</span> <span class="nv">f</span><span class="p">))</span>
<span class="lineno">7 </span><span class="p">((</span><span class="nf">smooth</span> <span class="nv">square</span><span class="p">)</span> <span class="mi">2</span><span class="p">)</span>
<span class="lineno">8 </span><span class="p">((</span><span class="nf">smooth-n</span> <span class="nv">square</span> <span class="mi">5</span><span class="p">)</span> <span class="mi">2</span><span class="p">)</span>
</pre>
</div>  </div>
 </div>
 <div class="chapter-block">
  <h2>
   Упражнение 1.45
  </h2>
  <div>
   <div>
    <p>
     В разделе 1.3.3 мы видели, что вычилсить квадратные корни путем лобового нахождения фиксированной точки от <span class="inline-formula"><img class="img-inline-formula img-formula" width="64" height="17" src="formulae/zdJWgnFS7PUYZhExeEvrX_tFSENKt1VSCK.Y5Q.png" alt="y\mapsto x/y" title="y\mapsto x/y"></span> не получается, это удалось починить методом усреднения. Тот же метод работает для нахождения кубического корня. К сожалению процесс не срабатывает для корня четвертой степени. Одного усреднения не достаточно что бы выполнить поиск фиксированной точки для схождения <span class="inline-formula"><img class="img-inline-formula img-formula" width="71" height="18" src="formulae/lgB8nsh8BmlyJvAIU7tAqvbF8Rl8.f5Qr5TrSA.png" alt="y\mapsto x/y^3" title="y\mapsto x/y^3"></span>. C другой стороны если применить усреднение два раза , поиск фиксированной точки начинает сходиться. Поэксперементируйте с количеством усреднений для вычисления корня n-ой степени, то есть на отображении <span class="inline-formula"><img class="img-inline-formula img-formula" width="91" height="18" src="formulae/3G5wsHuLMEIvQKNcMebKrdcrXyGTIDeetUDp8Q.png" alt="y\mapsto x/y^{n-1}" title="y\mapsto x/y^{n-1}"></span>. Используя это запишите процедуру для вычисления корня n-ой степени, через fixed-point, average-damp и repeated.
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno"> 1 </span><span class="c1">;; 1 ; 1 0</span>
<span class="lineno"> 2 </span><span class="c1">;; 2 ; 2 1</span>
<span class="lineno"> 3 </span>     <span class="c1">; 3 1</span>
<span class="lineno"> 4 </span><span class="c1">;; 4 ; 4 2</span>
<span class="lineno"> 5 </span>     <span class="c1">; 5 2</span>
<span class="lineno"> 6 </span>     <span class="c1">; 6 2</span>
<span class="lineno"> 7 </span>     <span class="c1">; 7 2</span>
<span class="lineno"> 8 </span><span class="c1">;; 8 ; 8 3</span>
<span class="lineno"> 9 </span>     <span class="c1">; 15 3</span>
<span class="lineno">10 </span>     <span class="c1">; 16 4</span>
<span class="lineno">11 </span>     <span class="c1">; 32 4</span>
<span class="lineno">12 </span>     <span class="c1">; 33 5</span>
<span class="lineno">13 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">nth-root</span> <span class="nv">x</span> <span class="nv">n</span><span class="p">)</span>
<span class="lineno">14 </span>  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">get-ad-count</span> <span class="nv">n</span> <span class="nv">i</span><span class="p">)</span>
<span class="lineno">15 </span>    <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&lt; </span><span class="nv">n</span> <span class="p">(</span><span class="nf">fast-expt</span> <span class="mi">2</span> <span class="nv">i</span><span class="p">))</span>
<span class="lineno">16 </span>        <span class="p">(</span><span class="nb">- </span><span class="nv">i</span> <span class="mi">1</span><span class="p">)</span>
<span class="lineno">17 </span>        <span class="p">(</span><span class="nf">get-ad-count</span> <span class="nv">n</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">i</span> <span class="mi">1</span><span class="p">))))</span>
<span class="lineno">18 </span>  <span class="p">(</span><span class="nb">display </span><span class="p">(</span><span class="nf">get-ad-count</span> <span class="nv">n</span> <span class="mi">1</span><span class="p">))</span>
<span class="lineno">19 </span>  <span class="p">(</span><span class="nf">fixed-point</span> <span class="p">((</span><span class="nf">repeated</span> <span class="nv">average-damp</span> <span class="p">(</span><span class="nf">get-ad-count</span> <span class="nv">n</span> <span class="mi">1</span><span class="p">))</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">y</span><span class="p">)</span> <span class="p">(</span><span class="nb">/ </span><span class="nv">x</span> <span class="p">(</span><span class="nf">fast-expt</span> <span class="nv">y</span> <span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="mi">1</span><span class="p">)))))</span>
<span class="lineno">20 </span>               <span class="mf">1.0</span><span class="p">))</span>
<span class="lineno">21 </span><span class="p">(</span><span class="nf">nth-root</span> <span class="mi">27</span> <span class="mi">64</span><span class="p">)</span>
</pre>
</div>  </div>
 </div>
 <div class="chapter-block">
  <h2>
   Упражнение 1.46
  </h2>
  <div>
   <div>
    <p>
     Некоторые из численных методов, описанных в этой главе являются примерами примерами чрезвычайно общей вычислитетельной стратегии известной как итеративное улучшение. Итеративное вычисление говорит о том, что для вычисления чего либо, мы начнем с первоначальной догадки для ответа, проверим, является ли догадка достаточно хорошей, иначе улчучшим догадку и продолжим процесс используя улучшенную догадку в качестве новой догадки. Напишите процедуру iterative-improve которая принимает две процедуры в качестве аргументов: метод определяющий достаточно ли хороша догадка и метод улучшения догадки. Iterative-improve должна возвращать процедуру которая принимает в качестве аргумента догадку и улучшает её пока она не проходит проверку на предел. Перепишете процедуру квадратного корня и процедуру fixed-point в терминах iterative-improve.
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno"> 1 </span><span class="p">(</span><span class="k">define </span><span class="nv">tolerance</span> <span class="mf">0.00001</span><span class="p">)</span>
<span class="lineno"> 2 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">close-enough?</span> <span class="nv">v1</span> <span class="nv">v2</span><span class="p">)</span>
<span class="lineno"> 3 </span>  <span class="p">(</span><span class="nb">&lt; </span><span class="p">(</span><span class="nb">abs </span><span class="p">(</span><span class="nb">- </span><span class="nv">v1</span> <span class="nv">v2</span><span class="p">))</span> <span class="nv">tolerance</span><span class="p">))</span>
<span class="lineno"> 4 </span>
<span class="lineno"> 5 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">iterative-improve</span> <span class="nv">good-enough?</span> <span class="nv">improve</span><span class="p">)</span>
<span class="lineno"> 6 </span>  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">try</span> <span class="nv">guess</span> <span class="nv">x</span><span class="p">)</span>
<span class="lineno"> 7 </span>    <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">next</span> <span class="p">(</span><span class="nf">improve</span> <span class="nv">guess</span><span class="p">)))</span>
<span class="lineno"> 8 </span>      <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">close-enough?</span> <span class="nv">guess</span> <span class="nv">next</span><span class="p">)</span>
<span class="lineno"> 9 </span>          <span class="nv">next</span>
<span class="lineno">10 </span>          <span class="p">(</span><span class="nf">try</span> <span class="nv">next</span> <span class="nv">x</span><span class="p">))))</span>
<span class="lineno">11 </span>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span> <span class="nv">guess</span><span class="p">)</span> <span class="p">(</span><span class="nf">try</span> <span class="nv">guess</span> <span class="nv">x</span><span class="p">)))</span>
<span class="lineno">12 </span>
<span class="lineno">13 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nb">sqrt </span><span class="nv">x</span><span class="p">)</span>
<span class="lineno">14 </span>  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">improve</span> <span class="nv">guess</span><span class="p">)</span>
<span class="lineno">15 </span>    <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">average</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span>
<span class="lineno">16 </span>      <span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nb">+ </span><span class="nv">x</span> <span class="nv">y</span><span class="p">)</span> <span class="mi">2</span><span class="p">))</span>
<span class="lineno">17 </span>    <span class="p">(</span><span class="nf">average</span> <span class="nv">guess</span> <span class="p">(</span><span class="nb">/ </span><span class="nv">x</span> <span class="nv">guess</span><span class="p">)))</span>
<span class="lineno">18 </span>  <span class="p">((</span><span class="nf">iterative-improve</span> <span class="nv">close-enough?</span> <span class="nv">improve</span><span class="p">)</span> <span class="nv">x</span> <span class="mf">1.0</span><span class="p">))</span>
<span class="lineno">19 </span>
<span class="lineno">20 </span><span class="p">(</span><span class="nb">sqrt </span><span class="mi">2</span><span class="p">)</span> <span class="c1">;Value: 1.4142156862745097</span>
<span class="lineno">21 </span>
<span class="lineno">22 </span>
<span class="lineno">23 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">fixed-point</span> <span class="nv">f</span><span class="p">)</span>
<span class="lineno">24 </span>  <span class="p">((</span><span class="nf">iterative-improve</span> <span class="nv">close-enough?</span> <span class="nv">f</span><span class="p">)</span> <span class="mf">1.0</span> <span class="mf">1.0</span><span class="p">))</span>
<span class="lineno">25 </span><span class="p">(</span><span class="nf">fixed-point</span> <span class="nv">cos</span><span class="p">)</span> <span class="c1">;Value: .7390822985224024</span>
</pre>
</div>  </div>
 </div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/sicp-133-protsedury-kak-obobshchaiushchie-metody-uprazhneniia-135-139/" class="u-url">SICP 1.33 Процедуры как обобщающие методы, упражнения 1.35-1.39</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Velikii Nehochuha
            </span></p>
            <p class="dateline">
            <a href="posts/sicp-133-protsedury-kak-obobshchaiushchie-metody-uprazhneniia-135-139/" rel="bookmark">
            <time class="published dt-published" datetime="2020-01-15T01:36:40+03:00" itemprop="datePublished" title="2020-01-15 01:36">2020-01-15 01:36</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div>
 <div class="chapter-block">
  <h2>
   Упражнение 1.35
  </h2>
  <div>
   <div>
    <p>
     Показать что золотое сечение <span class="inline-formula"><img class="img-inline-formula img-formula" width="10" height="15" src="formulae/nnhzdqchKKCzaVcrUWETL.T75aNctBowFpJaFA.png" alt="\phi" title="\phi"></span> это фиксированная точка трансформации <span class="inline-formula"><img class="img-inline-formula img-formula" width="94" height="17" src="formulae/1nMkSU9aUmKU94eNCFHsW76zCOstgHrGuaN.JA.png" alt="x\mapsto1+1/x" title="x\mapsto1+1/x"></span> и используя этот факт, вычислить <span class="inline-formula"><img class="img-inline-formula img-formula" width="10" height="15" src="formulae/nnhzdqchKKCzaVcrUWETL.T75aNctBowFpJaFA.png" alt="\phi" title="\phi"></span> через fixed-point.
    </p>
    <p>
     По определению фиксированной точки <span class="inline-formula"><img class="img-inline-formula img-formula" width="91" height="17" src="formulae/WYQmJitF3lTCsDqateA03gibfHVchhI21clQqA.png" alt="\phi=1+1/\phi" title="\phi=1+1/\phi"></span>, где <span class="inline-formula"><img class="img-inline-formula img-formula" width="117" height="20" src="formulae/UjJadbN6A6Af7gemc_E398qzlsLx0k7YuMSyaw.png" alt="\phi=(1+\sqrt{5})/2" title="\phi=(1+\sqrt{5})/2"></span> в общем очевидно что <span class="inline-formula"><img class="img-inline-formula img-formula" width="10" height="15" src="formulae/nnhzdqchKKCzaVcrUWETL.T75aNctBowFpJaFA.png" alt="\phi" title="\phi"></span> фиксированная точка на таком отображении.
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno">1 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">phi</span> <span class="nv">x</span><span class="p">)</span>
<span class="lineno">2 </span>  <span class="p">(</span><span class="nf">fixed-point</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">y</span><span class="p">)</span> <span class="p">(</span><span class="nb">+ </span><span class="mi">1</span> <span class="p">(</span><span class="nb">/ </span><span class="mi">1</span> <span class="nv">y</span><span class="p">)))</span>
<span class="lineno">3 </span>  <span class="mf">1.0</span><span class="p">))</span>
<span class="lineno">4 </span>
<span class="lineno">5 </span><span class="p">(</span><span class="nf">phi</span> <span class="mi">1</span><span class="p">)</span> <span class="c1">;Value: 1.6180327868852458</span>
</pre>
</div>  </div>
 </div>
 <div class="chapter-block">
  <h2>
   Упражнение 1.36
  </h2>
  <div>
   <div>
    <p>
     Измените процедуру fixed-point чтобы она печатала последовательность генерируемых приближений используя newline и display из упражнения 1.22. Затем найдите решение для <span class="inline-formula"><img class="img-inline-formula img-formula" width="76" height="11" src="formulae/HM9Qm.s3HgJ57VPQ4wJ9rQUqMNF5eAQN2wpsuQ.png" alt="x^x=1000" title="x^x=1000"></span> найдя фиксированную точку для <span class="inline-formula"><img class="img-inline-formula img-formula" width="164" height="17" src="formulae/XbkaMPB9jJlE1P3QZghbOy1J0EdWxwV8s53z7g.png" alt="x\mapsto\log(1000)/\log(x)" title="x\mapsto\log(1000)/\log(x)"></span>. Сравните количество шагов с использованием усреднения и без него.
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno"> 1 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">fixed-point</span> <span class="nv">f</span> <span class="nv">first-guess</span><span class="p">)</span>
<span class="lineno"> 2 </span>  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">close-enough?</span> <span class="nv">v1</span> <span class="nv">v2</span><span class="p">)</span>
<span class="lineno"> 3 </span>    <span class="p">(</span><span class="nb">&lt; </span><span class="p">(</span><span class="nb">abs </span><span class="p">(</span><span class="nb">- </span><span class="nv">v1</span> <span class="nv">v2</span><span class="p">))</span> <span class="nv">tolerance</span><span class="p">))</span>
<span class="lineno"> 4 </span>  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">try</span> <span class="nv">guess</span><span class="p">)</span>
<span class="lineno"> 5 </span>    <span class="p">(</span><span class="nf">newline</span><span class="p">)</span>
<span class="lineno"> 6 </span>    <span class="p">(</span><span class="nb">display </span><span class="nv">guess</span><span class="p">)</span>
<span class="lineno"> 7 </span>    <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">next</span> <span class="p">(</span><span class="nf">f</span> <span class="nv">guess</span><span class="p">)))</span>
<span class="lineno"> 8 </span>      <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">close-enough?</span> <span class="nv">guess</span> <span class="nv">next</span><span class="p">)</span>
<span class="lineno"> 9 </span>          <span class="nv">next</span>
<span class="lineno">10 </span>          <span class="p">(</span><span class="nf">try</span> <span class="nv">next</span><span class="p">))))</span>
<span class="lineno">11 </span>  <span class="p">(</span><span class="nf">try</span> <span class="nv">first-guess</span><span class="p">))</span>
</pre>
</div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno">1 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">xx1000</span><span class="p">)</span>
<span class="lineno">2 </span>  <span class="p">(</span><span class="nf">fixed-point</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">y</span><span class="p">)</span> <span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nb">log </span><span class="mi">1000</span><span class="p">)</span> <span class="p">(</span><span class="nb">log </span><span class="nv">y</span><span class="p">)))</span>
<span class="lineno">3 </span>               <span class="mf">2.0</span><span class="p">))</span>
<span class="lineno">4 </span><span class="p">(</span><span class="nf">xx1000</span><span class="p">)</span>
</pre>
</div>   <div>
    <p>
     2. 9.965784284662087 3.004472209841214 6.279195757507157 3.759850702401539 5.215843784925895 4.182207192401397 4.8277650983445906 4.387593384662677 4.671250085763899 4.481403616895052 4.6053657460929 4.5230849678718865 4.577114682047341 4.541382480151454 4.564903245230833 4.549372679303342 4.559606491913287 4.552853875788271 4.557305529748263 4.554369064436181 4.556305311532999 4.555028263573554 4.555870396702851 4.555315001192079 4.5556812635433275 4.555439715736846 4.555599009998291 4.555493957531389 4.555563237292884 4.555517548417651 4.555547679306398 4.555527808516254 4.555540912917957 ;Value: 4.555532270803653
    </p>
    <p>
     35 раз.
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno">1 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">xx1000</span><span class="p">)</span>
<span class="lineno">2 </span>  <span class="p">(</span><span class="nf">fixed-point</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">y</span><span class="p">)</span> <span class="p">(</span><span class="nf">average</span> <span class="nv">y</span> <span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nb">log </span><span class="mi">1000</span><span class="p">)</span> <span class="p">(</span><span class="nb">log </span><span class="nv">y</span><span class="p">))))</span>
<span class="lineno">3 </span>               <span class="mf">2.0</span><span class="p">))</span>
<span class="lineno">4 </span><span class="p">(</span><span class="nf">xx1000</span><span class="p">)</span>
</pre>
</div>   <div>
    <p>
     2. 5.9828921423310435 4.922168721308343 4.628224318195455 4.568346513136242 4.5577305909237005 4.555909809045131 4.555599411610624 4.5555465521473675 ;Value: 4.555537551999825
    </p>
    <p>
     10 раз.
    </p>
   </div>
  </div>
 </div>
 <div class="chapter-block">
  <h2>
   Упражнение 1.37
  </h2>
  <div>
   <div>
    <p>
     a. Бесконечная непрерывная дробь, выражение вида <span class="inline-formula"><img class="img-inline-formula img-formula" width="137" height="42" src="formulae/sjdXVLc6Vxzo8R25UmTxO.UuXfYfmoa9vN_8.Q.png" alt="f=\frac{N_1}{D_1+\frac{N_2}{D_2+\frac{N_3}{D_3+...}}}" title="f=\frac{N_1}{D_1+\frac{N_2}{D_2+\frac{N_3}{D_3+...}}}"></span>. В качестве примера можно показать что если для всех i <span class="inline-formula"><img class="img-inline-formula img-formula" width="51" height="14" src="formulae/a5St5HY2vJG2jaktUsvEtzVWFraPzgmbnMYF1g.png" alt="N_i=1" title="N_i=1"></span> <span class="inline-formula"><img class="img-inline-formula img-formula" width="52" height="14" src="formulae/bDp8GpJmdsEE0J6UTQXqXGylrL1NSnQeOKvqew.png" alt="D_i=1" title="D_i=1"></span>, то дробь будут равна <span class="inline-formula"><img class="img-inline-formula img-formula" width="28" height="17" src="formulae/jqoyPqGFD.741uy0dJ7pDnObupyLxw9ZqHDK_w.png" alt="1/\phi" title="1/\phi"></span>, где <span class="inline-formula"><img class="img-inline-formula img-formula" width="10" height="15" src="formulae/nnhzdqchKKCzaVcrUWETL.T75aNctBowFpJaFA.png" alt="\phi" title="\phi"></span> золотое сечение рассмотренное в упражнении 1.22. Один из способов приближенного вычисления такой дроби это отсечь дальнейшее деление при каком-то i=k. Такое усечение называется k-выраженная конечная непрерывная дробь. <span class="inline-formula"><img class="img-inline-formula img-formula" width="79" height="43" src="formulae/5YQQAqK.eBLHAcmk.ZOTVEMFDhO2rwHnTcpQRA.png" alt="\frac{N_1}{D_1+\frac{N_2}{...+\frac{N_k}{D_k}}}" title="\frac{N_1}{D_1+\frac{N_2}{...+\frac{N_k}{D_k}}}"></span>. Предположим что n и d процедуры одного аргумента (в терминах индекса i), которые возвращают <span class="inline-formula"><img class="img-inline-formula img-formula" width="20" height="14" src="formulae/sZiS..WGvCGhxZnDSGl5MdBWBV0bOes6DufUgQ.png" alt="N_i" title="N_i"></span> и <span class="inline-formula"><img class="img-inline-formula img-formula" width="20" height="14" src="formulae/E9O3WRQowdTN.EcibQkKJgNdUqBImg.3BViLZQ.png" alt="D_i" title="D_i"></span> в терминологии непрерывной дроби. Определите процедуру cont-frac так что выполнение (cont-frac n d k) вычисляет значение дроби усеченной по k. Проверьте вашу процедуру на приближенное вычисление <span class="inline-formula"><img class="img-inline-formula img-formula" width="28" height="17" src="formulae/jqoyPqGFD.741uy0dJ7pDnObupyLxw9ZqHDK_w.png" alt="1/\phi" title="1/\phi"></span> используя код
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno">1 </span><span class="p">(</span><span class="nf">cont-frac</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">i</span><span class="p">)</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="lineno">2 </span>           <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">i</span><span class="p">)</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="lineno">3 </span>           <span class="nv">k</span><span class="p">)</span>
</pre>
</div>   <div>
    <p>
     b. Напишите рекурсивную и итеративную реализацию процедуры cont-frac.
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno"> 1 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">cont-frac</span> <span class="nv">n</span> <span class="nv">d</span> <span class="nv">k</span><span class="p">)</span>
<span class="lineno"> 2 </span>  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">revert-index</span> <span class="nv">n</span> <span class="nv">d</span> <span class="nv">i</span><span class="p">)</span>
<span class="lineno"> 3 </span>    <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&gt; </span><span class="nv">i</span> <span class="nv">k</span><span class="p">)</span>
<span class="lineno"> 4 </span>        <span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nf">n</span> <span class="nv">i</span><span class="p">)</span> <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">d</span> <span class="nv">i</span><span class="p">)</span> <span class="mf">0.0</span><span class="p">))</span>
<span class="lineno"> 5 </span>        <span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nf">n</span> <span class="nv">i</span><span class="p">)</span> <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">d</span> <span class="nv">i</span><span class="p">)</span> <span class="p">(</span><span class="nf">revert-index</span> <span class="nv">n</span> <span class="nv">d</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">i</span> <span class="mi">1</span><span class="p">))))))</span>
<span class="lineno"> 6 </span>  <span class="p">(</span><span class="nf">revert-index</span> <span class="nv">n</span> <span class="nv">d</span> <span class="mi">0</span><span class="p">))</span>
<span class="lineno"> 7 </span>
<span class="lineno"> 8 </span><span class="p">(</span><span class="nf">cont-frac</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">i</span><span class="p">)</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="lineno"> 9 </span>           <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">i</span><span class="p">)</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="lineno">10 </span>           <span class="mi">100</span><span class="p">)</span> <span class="c1">;Value: .6180339887498948</span>
<span class="lineno">11 </span>
<span class="lineno">12 </span>
<span class="lineno">13 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">cont-frac</span> <span class="nv">n</span> <span class="nv">d</span> <span class="nv">k</span><span class="p">)</span>
<span class="lineno">14 </span>  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">iter</span> <span class="nv">i</span> <span class="nv">result</span><span class="p">)</span>
<span class="lineno">15 </span>    <span class="p">(</span><span class="nf">newline</span><span class="p">)</span>
<span class="lineno">16 </span>    <span class="p">(</span><span class="nb">display </span><span class="nv">result</span><span class="p">)</span>
<span class="lineno">17 </span>    <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="nv">i</span> <span class="mi">0</span><span class="p">)</span>
<span class="lineno">18 </span>        <span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nf">n</span> <span class="nv">i</span><span class="p">)</span> <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">d</span> <span class="nv">i</span><span class="p">)</span> <span class="nv">result</span><span class="p">))</span>
<span class="lineno">19 </span>        <span class="p">(</span><span class="nf">iter</span> <span class="p">(</span><span class="nb">- </span><span class="nv">i</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nf">n</span> <span class="nv">i</span><span class="p">)</span> <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">d</span> <span class="nv">i</span><span class="p">)</span> <span class="nv">result</span><span class="p">)))))</span>
<span class="lineno">20 </span>  <span class="p">(</span><span class="nf">iter</span> <span class="nv">k</span> <span class="mf">0.0</span><span class="p">))</span>
<span class="lineno">21 </span>
<span class="lineno">22 </span><span class="p">(</span><span class="nf">cont-frac</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">i</span><span class="p">)</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="lineno">23 </span>           <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">i</span><span class="p">)</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="lineno">24 </span>           <span class="mi">100</span><span class="p">)</span> <span class="c1">;Value: .6180339887498948</span>
</pre>
</div>  </div>
 </div>
 <div class="chapter-block">
  <h2>
   Упражнение 1.38
  </h2>
  <div>
   <div>
    <p>
     В 1737 швейцарский математик Леонард Эйлер опубликовал мемуары De Fractionibus Continuis, которые содержали запись непрерывной дроби для e-2, где e - основание натурального логарифма. В этой дроби все Ni = 1, а Di соответственно 1, 2, 1, 1, 4, 1, 1, 6, 1, 1, 8, ... Напишите процедуру для приближенного вычисления e.
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno"> 1 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">e-approximation</span> <span class="nv">k</span><span class="p">)</span>
<span class="lineno"> 2 </span>  <span class="p">(</span><span class="nb">+ </span><span class="mi">2</span> <span class="p">(</span><span class="nf">cont-frac</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">i</span><span class="p">)</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="lineno"> 3 </span>                  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">i</span><span class="p">)</span> <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">= </span><span class="nv">i</span> <span class="mi">0</span><span class="p">)</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="lineno"> 4 </span>                               <span class="p">((</span><span class="nb">= </span><span class="nv">i</span> <span class="mi">1</span><span class="p">)</span> <span class="mf">2.0</span><span class="p">)</span>
<span class="lineno"> 5 </span>                               <span class="p">((</span><span class="nb">&lt;= </span><span class="nv">i</span> <span class="mi">3</span><span class="p">)</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="lineno"> 6 </span>                               <span class="p">((</span><span class="nb">= </span><span class="p">(</span><span class="nb">remainder </span><span class="p">(</span><span class="nb">- </span><span class="nv">i</span> <span class="mi">1</span><span class="p">)</span> <span class="mi">3</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nb">* </span><span class="mi">2</span> <span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nb">- </span><span class="nv">i</span> <span class="mi">1</span><span class="p">)</span> <span class="mi">3</span><span class="p">)))</span>
<span class="lineno"> 7 </span>                               <span class="p">(</span><span class="k">else </span><span class="mf">1.0</span><span class="p">)))</span>
<span class="lineno"> 8 </span>                  <span class="nv">k</span><span class="p">)))</span>
<span class="lineno"> 9 </span>
<span class="lineno">10 </span><span class="p">(</span><span class="nf">e-approximation</span> <span class="mi">100</span><span class="p">)</span> <span class="c1">;Value: 2.7208245385621153</span>
</pre>
</div>  </div>
 </div>
 <div class="chapter-block">
  <h2>
   Упражнение 1.39
  </h2>
  <div>
   <div>
    <p>
     Бесконечная дробь для тангенса была опубликована в 1970 немецким математиком Ламбертом. <span class="inline-formula"><img class="img-inline-formula img-formula" width="133" height="37" src="formulae/Kh3Tu0aZ5ik5TrqUeTNCTUfOTq2DBN23c_X9Qw.png" alt="\tan{x}=\frac{x}{1-\frac{x^2}{3-\frac{x^2}{5-...}}}" title="\tan{x}=\frac{x}{1-\frac{x^2}{3-\frac{x^2}{5-...}}}"></span>. Напишите процедуру для приближенного вычисления тангенса.
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno"> 1 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">cont-frac-params</span> <span class="nv">n</span> <span class="nv">d</span> <span class="nv">k</span> <span class="nv">x</span><span class="p">)</span>
<span class="lineno"> 2 </span>  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">iter</span> <span class="nv">i</span> <span class="nv">result</span><span class="p">)</span>
<span class="lineno"> 3 </span>    <span class="p">(</span><span class="nf">newline</span><span class="p">)</span>
<span class="lineno"> 4 </span>    <span class="p">(</span><span class="nb">display </span><span class="nv">result</span><span class="p">)</span>
<span class="lineno"> 5 </span>    <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="nv">i</span> <span class="mi">0</span><span class="p">)</span>
<span class="lineno"> 6 </span>        <span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nf">n</span> <span class="nv">i</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">- </span><span class="p">(</span><span class="nf">d</span> <span class="nv">i</span> <span class="nv">x</span><span class="p">)</span> <span class="nv">result</span><span class="p">))</span>
<span class="lineno"> 7 </span>        <span class="p">(</span><span class="nf">iter</span> <span class="p">(</span><span class="nb">- </span><span class="nv">i</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nf">n</span> <span class="nv">i</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">- </span><span class="p">(</span><span class="nf">d</span> <span class="nv">i</span> <span class="nv">x</span><span class="p">)</span> <span class="nv">result</span><span class="p">)))))</span>
<span class="lineno"> 8 </span>  <span class="p">(</span><span class="nf">iter</span> <span class="nv">k</span> <span class="mf">0.0</span><span class="p">))</span>
<span class="lineno"> 9 </span>
<span class="lineno">10 </span>
<span class="lineno">11 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">tan-cf</span> <span class="nv">x</span> <span class="nv">k</span><span class="p">)</span>
<span class="lineno">12 </span>  <span class="p">(</span><span class="nf">cont-frac-params</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">i</span> <span class="nv">j</span><span class="p">)</span> <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">= </span><span class="nv">i</span> <span class="mi">0</span><span class="p">)</span> <span class="nv">j</span><span class="p">)</span>
<span class="lineno">13 </span>                          <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">square</span> <span class="nv">j</span><span class="p">))))</span>
<span class="lineno">14 </span>           <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">i</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">+ </span><span class="mi">1</span> <span class="p">(</span><span class="nb">* </span><span class="mi">2</span> <span class="nv">i</span><span class="p">)))</span>
<span class="lineno">15 </span>           <span class="mi">100</span> <span class="nv">x</span><span class="p">))</span>
<span class="lineno">16 </span>
<span class="lineno">17 </span><span class="p">(</span><span class="nf">tan-cf</span> <span class="mi">2</span> <span class="mi">100</span><span class="p">)</span><span class="c1">;Value: -2.185039863261519</span>
</pre>
</div>  </div>
 </div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/sicp-protsedury-vysshego-poriadka-uprazhneniia-129-133/" class="u-url">SICP Процедуры высшего порядка, упражнения 1.29-1.34</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Velikii Nehochuha
            </span></p>
            <p class="dateline">
            <a href="posts/sicp-protsedury-vysshego-poriadka-uprazhneniia-129-133/" rel="bookmark">
            <time class="published dt-published" datetime="2020-01-14T12:43:07+03:00" itemprop="datePublished" title="2020-01-14 12:43">2020-01-14 12:43</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div>
 <div class="chapter-block">
  <h2>
   Упражнение 1.29
  </h2>
  <div>
   <div>
    <p>
     Правило Симпсона более точный метод вычисления интеграла чем метод приведенный ранее в книге. По правилу Симпсона, интеграл функции f от а до b приблизительно равен <span class="inline-formula"><img class="img-inline-formula img-formula" width="344" height="21" src="formulae/ZEjhbtp2azXoWkeqy4AJ.bLxz0MqUj5y_JoL5g.png" alt="\frac{h}{3}[y_0+4y_1+2y_2+...+2y_{n-2}+4y_{n-1}+2y_n]" title="\frac{h}{3}[y_0+4y_1+2y_2+...+2y_{n-2}+4y_{n-1}+2y_n]"></span>, где h=(b-a)/n, <span class="inline-formula"><img class="img-inline-formula img-formula" width="114" height="17" src="formulae/fkSsmMh38xP3c4ajHM7Irs1jWJ1ViSftHhg2Ng.png" alt="y_k=f(a+kh)" title="y_k=f(a+kh)"></span>. Напишите процедуру вычисляющую интеграл по этому методу. Сравните результаты с предыдущим методом при n=100, n=1000.
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno"> 1 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">sum-simpson</span> <span class="nv">term</span> <span class="nv">a</span> <span class="nv">next</span> <span class="nv">b</span> <span class="nv">controln</span> <span class="nv">k</span><span class="p">)</span>
<span class="lineno"> 2 </span>  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&gt; </span><span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
<span class="lineno"> 3 </span>      <span class="mi">0</span>
<span class="lineno"> 4 </span>      <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nb">* </span><span class="p">(</span><span class="nf">controln</span> <span class="nv">k</span><span class="p">)(</span><span class="nf">term</span> <span class="nv">a</span><span class="p">))</span>
<span class="lineno"> 5 </span>         <span class="p">(</span><span class="nf">sum-simpson</span> <span class="nv">term</span> <span class="p">(</span><span class="nf">next</span> <span class="nv">a</span><span class="p">)</span> <span class="nv">next</span> <span class="nv">b</span> <span class="nv">controln</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">k</span> <span class="mi">1</span><span class="p">)))))</span>
<span class="lineno"> 6 </span>
<span class="lineno"> 7 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">integral-simpson</span> <span class="nv">f</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">n</span><span class="p">)</span>
<span class="lineno"> 8 </span>  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">getdx</span> <span class="nv">start</span> <span class="nv">end</span> <span class="nv">steps</span><span class="p">)</span>
<span class="lineno"> 9 </span>    <span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nb">- </span><span class="nv">end</span> <span class="nv">start</span><span class="p">)</span> <span class="nv">steps</span><span class="p">))</span>
<span class="lineno">10 </span>  <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">dx</span> <span class="p">(</span><span class="nf">getdx</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">n</span><span class="p">)))</span>
<span class="lineno">11 </span>    <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">controln</span> <span class="nv">step-number</span><span class="p">)</span>
<span class="lineno">12 </span>      <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">= </span><span class="nv">step-number</span> <span class="mi">0</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span>
<span class="lineno">13 </span>            <span class="p">((</span><span class="nb">even? </span><span class="nv">step-number</span><span class="p">)</span> <span class="mi">2</span><span class="p">)</span>
<span class="lineno">14 </span>            <span class="p">(</span><span class="k">else </span><span class="mi">4</span><span class="p">)))</span>
<span class="lineno">15 </span>
<span class="lineno">16 </span>    <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">next-a</span> <span class="nv">x</span><span class="p">)</span>
<span class="lineno">17 </span>      <span class="p">(</span><span class="nb">+ </span><span class="nv">x</span> <span class="nv">dx</span><span class="p">))</span>
<span class="lineno">18 </span>  <span class="c1">;; ;; (define (add-dx x) (+ x (getdx dx)))</span>
<span class="lineno">19 </span>    <span class="p">(</span><span class="nb">* </span><span class="p">(</span><span class="nf">sum-simpson</span> <span class="nv">f</span> <span class="nv">a</span> <span class="nv">next-a</span> <span class="nv">b</span> <span class="nv">controln</span> <span class="mi">0</span><span class="p">)</span>
<span class="lineno">20 </span>       <span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nf">getdx</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">n</span><span class="p">)</span> <span class="mi">3</span><span class="p">))</span>
<span class="lineno">21 </span>    <span class="p">))</span>
<span class="lineno">22 </span>
<span class="lineno">23 </span><span class="p">(</span><span class="nf">integral-simpson</span> <span class="nv">cube</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">100</span><span class="p">)</span><span class="c1">;;19/75 0.25333333333333335</span>
<span class="lineno">24 </span><span class="p">(</span><span class="nf">integral-simpson</span> <span class="nv">cube</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">1000</span><span class="p">)</span><span class="c1">;; 751/3000 0.25033333333333335</span>
</pre>
</div>  </div>
 </div>
 <div class="chapter-block">
  <h2>
   Упражнение 1.30
  </h2>
  <div>
   <div>
    <p>
     Процедура sum приведенная в книге генерирует линейную рекурсию. Процедуру можно переписать что бы сумма вычислялась итерациями. Покажите как это сделать.
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno">1 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">sum</span> <span class="nv">term</span> <span class="nv">a</span> <span class="nv">next</span> <span class="nv">b</span><span class="p">)</span>
<span class="lineno">2 </span>  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">iter</span> <span class="nv">a</span> <span class="nv">result</span><span class="p">)</span>
<span class="lineno">3 </span>    <span class="p">(</span><span class="k">if </span><span class="nv">&lt;??&gt;</span>
<span class="lineno">4 </span>        <span class="nv">&lt;??&gt;</span>
<span class="lineno">5 </span>        <span class="p">(</span><span class="nf">iter</span> <span class="nv">&lt;??&gt;</span> <span class="nv">&lt;??&gt;</span><span class="p">)))</span>
<span class="lineno">6 </span>  <span class="p">(</span><span class="nf">iter</span> <span class="nv">&lt;??&gt;</span> <span class="nv">&lt;??&gt;</span><span class="p">))</span>
</pre>
</div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno">1 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">sum</span> <span class="nv">term</span> <span class="nv">a</span> <span class="nv">next</span> <span class="nv">b</span><span class="p">)</span>
<span class="lineno">2 </span>  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">iter</span> <span class="nv">a</span> <span class="nv">result</span><span class="p">)</span>
<span class="lineno">3 </span>    <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&gt; </span><span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
<span class="lineno">4 </span>        <span class="nv">result</span>
<span class="lineno">5 </span>        <span class="p">(</span><span class="nf">iter</span> <span class="p">(</span><span class="nf">next</span> <span class="nv">a</span><span class="p">)</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">result</span> <span class="p">(</span><span class="nf">term</span> <span class="nv">a</span><span class="p">)))))</span>
<span class="lineno">6 </span>  <span class="p">(</span><span class="nf">iter</span> <span class="nv">a</span> <span class="mi">0</span><span class="p">))</span>
<span class="lineno">7 </span><span class="p">(</span><span class="nf">sum</span> <span class="nv">identity</span> <span class="mi">1</span> <span class="nv">inc</span> <span class="mi">5</span><span class="p">)</span> <span class="c1">; 15</span>
</pre>
</div>  </div>
 </div>
 <div class="chapter-block">
  <h2>
   Упражнение 1.31
  </h2>
  <div>
   <div>
    <p>
     a. Процедура sum является лишь простым примером из огромного числа подобных абстракций, которые могут быть сформулированы через процедуры высшего порядка. Напишите аналогичную процедуру product которая возвращает произведение значений функции в точках заданного интервала. Покажите как определить факториал через данную процедуру. Также используйте product для вычисления приближения <span class="inline-formula"><img class="img-inline-formula img-formula" width="10" height="7" src="formulae/pNnv.0JDiPStcnC_sVMLZXeu2Nqgm_VX3SQ9xw.png" alt="\pi" title="\pi"></span> используя формулу <span class="inline-formula"><img class="img-inline-formula img-formula" width="114" height="21" src="formulae/2U4YX2IBoqTMhJ80nyMI7JdFJpeeiyvd2Yp69g.png" alt="\frac{\pi}{4}=\frac{2\cdot4\cdot4\cdot6\cdot6\cdot8...}{3\cdot3\cdot5\cdot5\cdot7\cdot7...}" title="\frac{\pi}{4}=\frac{2\cdot4\cdot4\cdot6\cdot6\cdot8...}{3\cdot3\cdot5\cdot5\cdot7\cdot7...}"></span>.
    </p>
    <p>
     b. Если ваша процедура генерирует рекурсивный процесс, перепишите её на итерационный процесс.
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno"> 1 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">product</span> <span class="nv">term</span> <span class="nv">a</span> <span class="nv">next</span> <span class="nv">b</span><span class="p">)</span>
<span class="lineno"> 2 </span>  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&gt; </span><span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
<span class="lineno"> 3 </span>      <span class="mi">1</span>
<span class="lineno"> 4 </span>      <span class="p">(</span><span class="nb">* </span><span class="p">(</span><span class="nf">term</span> <span class="nv">a</span><span class="p">)</span>
<span class="lineno"> 5 </span>         <span class="p">(</span><span class="nf">product</span> <span class="nv">term</span> <span class="p">(</span><span class="nf">next</span> <span class="nv">a</span><span class="p">)</span> <span class="nv">next</span> <span class="nv">b</span><span class="p">))))</span>
<span class="lineno"> 6 </span>
<span class="lineno"> 7 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">producti</span> <span class="nv">term</span> <span class="nv">a</span> <span class="nv">next</span> <span class="nv">b</span><span class="p">)</span>
<span class="lineno"> 8 </span>  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">iter</span> <span class="nv">a</span> <span class="nv">result</span><span class="p">)</span>
<span class="lineno"> 9 </span>    <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&gt; </span><span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
<span class="lineno">10 </span>        <span class="nv">result</span>
<span class="lineno">11 </span>        <span class="p">(</span><span class="nf">iter</span> <span class="p">(</span><span class="nf">next</span> <span class="nv">a</span><span class="p">)</span> <span class="p">(</span><span class="nb">* </span><span class="nv">result</span> <span class="p">(</span><span class="nf">term</span> <span class="nv">a</span><span class="p">)))))</span>
<span class="lineno">12 </span>  <span class="p">(</span><span class="nf">iter</span> <span class="nv">a</span> <span class="mi">1</span><span class="p">))</span>
<span class="lineno">13 </span>
<span class="lineno">14 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">product-factorial</span> <span class="nv">n</span><span class="p">)</span>
<span class="lineno">15 </span>  <span class="p">(</span><span class="nf">product</span> <span class="nv">identity</span> <span class="mi">1</span> <span class="nv">inc</span> <span class="mi">5</span><span class="p">))</span>
<span class="lineno">16 </span><span class="p">(</span><span class="nf">product-factorial</span> <span class="mi">5</span><span class="p">)</span> <span class="c1">;; 120</span>
<span class="lineno">17 </span>
<span class="lineno">18 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">multiplicate-pi</span> <span class="nv">x</span><span class="p">)</span>
<span class="lineno">19 </span>  <span class="p">(</span><span class="nf">square</span> <span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nb">+ </span><span class="mi">4</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">+ </span><span class="mi">5</span> <span class="nv">x</span><span class="p">))))</span>
<span class="lineno">20 </span>
<span class="lineno">21 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">product-pi</span> <span class="nv">n</span><span class="p">)</span>
<span class="lineno">22 </span>  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">sub-pi</span> <span class="nv">x</span><span class="p">)</span>
<span class="lineno">23 </span>    <span class="p">(</span><span class="nb">* </span><span class="p">(</span><span class="nb">/ </span><span class="nv">x</span> <span class="p">(</span><span class="nb">+ </span><span class="mi">1</span> <span class="nv">x</span><span class="p">))</span> <span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nb">+ </span><span class="nv">x</span> <span class="mi">2</span><span class="p">)</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">x</span> <span class="mi">1</span><span class="p">))))</span>
<span class="lineno">24 </span>  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">next-x</span> <span class="nv">x</span><span class="p">)</span>
<span class="lineno">25 </span>    <span class="p">(</span><span class="nb">+ </span><span class="nv">x</span> <span class="mi">2</span><span class="p">))</span>
<span class="lineno">26 </span>  <span class="p">(</span><span class="nb">* </span><span class="mi">4</span> <span class="p">(</span><span class="nf">product</span> <span class="nv">sub-pi</span> <span class="mi">2</span> <span class="nv">next-x</span> <span class="nv">n</span><span class="p">)))</span>
<span class="lineno">27 </span><span class="p">(</span><span class="nf">product-pi</span> <span class="mi">1000</span><span class="p">)</span> <span class="c1">; 3.1431607055322663</span>
</pre>
</div>  </div>
 </div>
 <div class="chapter-block">
  <h2>
   Упражнение 1.32
  </h2>
  <div>
   <div>
    <p>
     a. Покажите что процедуры sum и product оба являются частными случаями более общей нотации accumulate, которая объединяет набор терминов в более общую функцию.
    </p>
    <p>
     b. сделайте рекурсивный и итерационный вариант.
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno"> 1 </span><span class="c1">;; рекурсивный</span>
<span class="lineno"> 2 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">accumulate</span> <span class="nv">combiner</span> <span class="nv">null-value</span> <span class="nv">term</span> <span class="nv">a</span> <span class="nv">next</span> <span class="nv">b</span><span class="p">)</span>
<span class="lineno"> 3 </span>  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&gt; </span><span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
<span class="lineno"> 4 </span>      <span class="nv">null-value</span>
<span class="lineno"> 5 </span>      <span class="p">(</span><span class="nf">combiner</span> <span class="p">(</span><span class="nf">term</span> <span class="nv">a</span><span class="p">)</span>
<span class="lineno"> 6 </span>                <span class="p">(</span><span class="nf">accumulate</span> <span class="nv">combiner</span> <span class="nv">null-value</span> <span class="nv">term</span> <span class="p">(</span><span class="nf">next</span> <span class="nv">a</span><span class="p">)</span> <span class="nv">next</span> <span class="nv">b</span><span class="p">))))</span>
<span class="lineno"> 7 </span>
<span class="lineno"> 8 </span><span class="c1">;; итерационный</span>
<span class="lineno"> 9 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">accumulate</span> <span class="nv">combiner</span> <span class="nv">null-value</span> <span class="nv">term</span> <span class="nv">a</span> <span class="nv">next</span> <span class="nv">b</span><span class="p">)</span>
<span class="lineno">10 </span>  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">iter</span> <span class="nv">a</span> <span class="nv">result</span><span class="p">)</span>
<span class="lineno">11 </span>    <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&gt; </span><span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
<span class="lineno">12 </span>      <span class="nv">result</span>
<span class="lineno">13 </span>      <span class="p">(</span><span class="nf">iter</span> <span class="p">(</span><span class="nf">next</span> <span class="nv">a</span><span class="p">)</span> <span class="p">(</span><span class="nf">combiner</span> <span class="nv">result</span> <span class="p">(</span><span class="nf">term</span> <span class="nv">a</span><span class="p">)))))</span>
<span class="lineno">14 </span>  <span class="p">(</span><span class="nf">iter</span> <span class="nv">a</span> <span class="nv">null-value</span><span class="p">))</span>
<span class="lineno">15 </span>
<span class="lineno">16 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">product</span> <span class="nv">term</span> <span class="nv">a</span> <span class="nv">next</span> <span class="nv">b</span><span class="p">)</span>
<span class="lineno">17 </span>  <span class="p">(</span><span class="nf">accumulate</span> <span class="nv">*</span> <span class="mi">1</span> <span class="nv">term</span> <span class="nv">a</span> <span class="nv">next</span> <span class="nv">b</span><span class="p">))</span>
<span class="lineno">18 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">sum</span> <span class="nv">term</span> <span class="nv">a</span> <span class="nv">next</span> <span class="nv">b</span><span class="p">)</span>
<span class="lineno">19 </span>  <span class="p">(</span><span class="nf">accumulate</span> <span class="nv">+</span> <span class="mi">0</span> <span class="nv">term</span> <span class="nv">a</span> <span class="nv">next</span> <span class="nv">b</span><span class="p">))</span>
<span class="lineno">20 </span>
<span class="lineno">21 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">accumulate-factorial</span> <span class="nv">n</span><span class="p">)</span>
<span class="lineno">22 </span>  <span class="p">(</span><span class="nf">product</span> <span class="nv">identity</span> <span class="mi">1</span> <span class="nv">inc</span> <span class="mi">5</span><span class="p">))</span>
<span class="lineno">23 </span><span class="p">(</span><span class="nf">accumulate-factorial</span> <span class="mi">5</span><span class="p">)</span> <span class="c1">; 120</span>
<span class="lineno">24 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">accumulate-sum</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
<span class="lineno">25 </span>  <span class="p">(</span><span class="nf">sum</span> <span class="nv">identity</span> <span class="nv">a</span> <span class="nv">inc</span> <span class="nv">b</span><span class="p">))</span>
<span class="lineno">26 </span><span class="p">(</span><span class="nf">accumulate-sum</span> <span class="mi">1</span> <span class="mi">5</span><span class="p">)</span> <span class="c1">; 15</span>
</pre>
</div>  </div>
 </div>
 <div class="chapter-block">
  <h2>
   Упражнение 1.33
  </h2>
  <div>
   <div>
    <p>
     Вы можете получить еще более общую версию accumulate, введя понятие фильтра по слагаемым. То есть складывать (или перемножать) только те значения которые удовлетворяют заданному условию. Результирующая абстракция filtered-accumulate все те же параметры как и accumulate, плюс дополнительным предикатом одного аргумента, описывающим фильтр. Напишите процедуру filtered-accumulate. Покажите как выразить следующие понятия используя её.
    </p>
    <p>
     a. Сумма квадратов простых чисел в интервале от a до b. b. Перемножение всех положительных целых меньших чем n, которые взаимно простых с n (GCD (i,n) = 1)
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno"> 1 </span><span class="c1">;; рекурсивный</span>
<span class="lineno"> 2 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">filtered-accumulate</span> <span class="nv">combiner</span> <span class="nv">null-value</span> <span class="nv">term</span> <span class="nv">a</span> <span class="nv">next</span> <span class="nv">b</span> <span class="nv">filter</span><span class="p">)</span>
<span class="lineno"> 3 </span>  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&gt; </span><span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
<span class="lineno"> 4 </span>      <span class="nv">null-value</span>
<span class="lineno"> 5 </span>      <span class="p">(</span><span class="nf">combiner</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">filter</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">)</span> <span class="p">(</span><span class="nf">term</span> <span class="nv">a</span><span class="p">)</span> <span class="nv">null-value</span><span class="p">)</span>
<span class="lineno"> 6 </span>                <span class="p">(</span><span class="nf">filtered-accumulate</span> <span class="nv">combiner</span> <span class="nv">null-value</span> <span class="nv">term</span> <span class="p">(</span><span class="nf">next</span> <span class="nv">a</span><span class="p">)</span> <span class="nv">next</span> <span class="nv">b</span> <span class="nv">filter</span><span class="p">))))</span>
<span class="lineno"> 7 </span>
<span class="lineno"> 8 </span><span class="c1">;; итерационный</span>
<span class="lineno"> 9 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">filtered-accumulate</span> <span class="nv">combiner</span> <span class="nv">null-value</span> <span class="nv">term</span> <span class="nv">a</span> <span class="nv">next</span> <span class="nv">b</span> <span class="nv">filter</span><span class="p">)</span>
<span class="lineno">10 </span>  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">iter</span> <span class="nv">a</span> <span class="nv">result</span><span class="p">)</span>
<span class="lineno">11 </span>    <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&gt; </span><span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
<span class="lineno">12 </span>      <span class="nv">result</span>
<span class="lineno">13 </span>      <span class="p">(</span><span class="nf">iter</span> <span class="p">(</span><span class="nf">next</span> <span class="nv">a</span><span class="p">)</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">filter</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
<span class="lineno">14 </span>                         <span class="p">(</span><span class="nf">combiner</span> <span class="nv">result</span> <span class="p">(</span><span class="nf">term</span> <span class="nv">a</span><span class="p">))</span>
<span class="lineno">15 </span>                         <span class="nv">result</span><span class="p">)</span>
<span class="lineno">16 </span>            <span class="p">)))</span>
<span class="lineno">17 </span>  <span class="p">(</span><span class="nf">iter</span> <span class="nv">a</span> <span class="nv">null-value</span><span class="p">))</span>
<span class="lineno">18 </span>
<span class="lineno">19 </span>
<span class="lineno">20 </span><span class="c1">;; cумма квадратов целых в диапазоне</span>
<span class="lineno">21 </span><span class="c1">;; передаем в фильтр два параметра a b что бы работало абстракция со следующим примером</span>
<span class="lineno">22 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">filter-prime?</span> <span class="nv">x</span> <span class="nv">end</span><span class="p">)</span>
<span class="lineno">23 </span>  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">prime?</span> <span class="nv">x</span><span class="p">)</span>
<span class="lineno">24 </span>      <span class="mi">1</span>
<span class="lineno">25 </span>      <span class="nv">false</span><span class="p">))</span>
<span class="lineno">26 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">sum-square-primes</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
<span class="lineno">27 </span>  <span class="p">(</span><span class="nf">filtered-accumulate</span> <span class="nv">+</span> <span class="mi">0</span> <span class="nv">square</span> <span class="nv">a</span> <span class="nv">inc</span> <span class="nv">b</span> <span class="nv">filter-prime?</span><span class="p">))</span>
<span class="lineno">28 </span><span class="p">(</span><span class="nf">sum-square-primes</span> <span class="mi">1</span> <span class="mi">5</span><span class="p">)</span> <span class="c1">; 14</span>
<span class="lineno">29 </span>
<span class="lineno">30 </span><span class="c1">;; перемножение всех взаимно простых с n в диапазоне [m n]</span>
<span class="lineno">31 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">filter-relative-prime?</span> <span class="nv">x</span> <span class="nv">end</span><span class="p">)</span>
<span class="lineno">32 </span>  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="p">(</span><span class="nb">gcd </span><span class="nv">x</span> <span class="nv">end</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span>
<span class="lineno">33 </span>      <span class="mi">1</span>
<span class="lineno">34 </span>      <span class="nv">false</span><span class="p">))</span>
<span class="lineno">35 </span>
<span class="lineno">36 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">product-relative-primes</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
<span class="lineno">37 </span>  <span class="p">(</span><span class="nf">filtered-accumulate</span> <span class="nv">*</span> <span class="mi">1</span> <span class="nv">identity</span> <span class="nv">a</span> <span class="nv">inc</span> <span class="nv">b</span> <span class="nv">filter-relative-prime?</span><span class="p">))</span>
<span class="lineno">38 </span><span class="p">(</span><span class="nf">product-relative-primes</span> <span class="mi">1</span> <span class="mi">6</span><span class="p">)</span><span class="c1">; 5</span>
</pre>
</div>  </div>
 </div>
 <div class="chapter-block">
  <h2>
   Упражнение 1.34
  </h2>
  <div>
   <div>
    <p>
     Предположим мы определили процедуру
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno">1 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">f</span> <span class="nv">g</span><span class="p">)</span>
<span class="lineno">2 </span>  <span class="p">(</span><span class="nf">g</span> <span class="mi">2</span><span class="p">))</span>
<span class="lineno">3 </span><span class="p">(</span><span class="nf">f</span> <span class="nv">square</span><span class="p">)</span> <span class="c1">; 4</span>
<span class="lineno">4 </span><span class="p">(</span><span class="nf">f</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">z</span><span class="p">)</span> <span class="p">(</span><span class="nb">* </span><span class="nv">z</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">z</span> <span class="mi">1</span><span class="p">))))</span> <span class="c1">; 6</span>
<span class="lineno">5 </span>
<span class="lineno">6 </span><span class="p">(</span><span class="mi">2</span> <span class="mi">2</span><span class="p">)</span>
</pre>
</div>   <div>
    <p>
     Что произойдет если вызвать (f f)?
    </p>
    <p>
     Происходит ошибка ;The object 2 is not applicable. Функция f ожидает в качестве параметра получить функцию которую можно вызвать, она его и получает и вызывает функцию f с параметром 2 (рекурсивно второй раз), и пытается выполнить функцию (2 2), на что и ругается интерпретатор, потому что 2 не процедура.
    </p>
   </div>
  </div>
 </div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/sicp-uprazhneniia-125-126-127-128/" class="u-url">SICP Упражнения 1.25, 1.26, 1.27, 1.28</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Velikii Nehochuha
            </span></p>
            <p class="dateline">
            <a href="posts/sicp-uprazhneniia-125-126-127-128/" rel="bookmark">
            <time class="published dt-published" datetime="2020-01-13T14:34:28+03:00" itemprop="datePublished" title="2020-01-13 14:34">2020-01-13 14:34</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div>
 <div class="chapter-block">
  <h2>
   Упражнение 1.25
  </h2>
  <div>
   <div>
    <p>
     Алиса посетовала что мы проделали много лишней работы при написании expmod. В конце концов, сказала она, мы уже знаем как посчитать экспоненту, мы могли бы просто написать:
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno">1 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">expmod</span> <span class="nv">base</span> <span class="nv">exp</span> <span class="nv">m</span><span class="p">)</span>
<span class="lineno">2 </span>  <span class="p">(</span><span class="nb">remainder </span><span class="p">(</span><span class="nf">fast-expt</span> <span class="nv">base</span> <span class="nv">exp</span><span class="p">)</span> <span class="nv">m</span><span class="p">))</span>
</pre>
</div>   <div>
    <p>
     Правильно ли это? Будет ли эта процедура работать так же быстро как fast-prime тест?
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno"> 1 </span><span class="c1">;; метод который используем в fast-prime?</span>
<span class="lineno"> 2 </span><span class="c1">;; Два числа называются сопоставимыми по модулю n если оба имеют одинаковый остаток при делении на n.</span>
<span class="lineno"> 3 </span><span class="c1">;; вызывая каждый раз reminder, числа с которыми мы работаем остаются малыми</span>
<span class="lineno"> 4 </span>
<span class="lineno"> 5 </span><span class="c1">;; 2 7 7</span>
<span class="lineno"> 6 </span><span class="c1">;; 2 &lt;- 2 * (2 6 7)</span>
<span class="lineno"> 7 </span><span class="c1">;; 1 &lt;- square (2 3 7)</span>
<span class="lineno"> 8 </span><span class="c1">;; 1 &lt;- 2 * (2 2 7)</span>
<span class="lineno"> 9 </span><span class="c1">;; 4 &lt;- sqaure (2 1 7)</span>
<span class="lineno">10 </span><span class="c1">;; 2 &lt;- 2 * (2 0 7)</span>
<span class="lineno">11 </span>
<span class="lineno">12 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">expmod</span> <span class="nv">base</span> <span class="nv">exp</span> <span class="nv">m</span><span class="p">)</span>
<span class="lineno">13 </span>  <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">= </span><span class="nv">exp</span> <span class="mi">0</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span>
<span class="lineno">14 </span>        <span class="p">((</span><span class="nb">even? </span><span class="nv">exp</span><span class="p">)</span>
<span class="lineno">15 </span>         <span class="p">(</span><span class="nb">remainder </span><span class="p">(</span><span class="nf">square</span> <span class="p">(</span><span class="nf">expmod</span> <span class="nv">base</span> <span class="p">(</span><span class="nb">/ </span><span class="nv">exp</span> <span class="mi">2</span><span class="p">)</span> <span class="nv">m</span><span class="p">))</span>
<span class="lineno">16 </span>                    <span class="nv">m</span><span class="p">))</span>
<span class="lineno">17 </span>        <span class="p">(</span><span class="nf">else</span>
<span class="lineno">18 </span>         <span class="p">(</span><span class="nb">remainder </span><span class="p">(</span><span class="nb">* </span><span class="nv">base</span> <span class="p">(</span><span class="nf">expmod</span> <span class="nv">base</span> <span class="p">(</span><span class="nb">- </span><span class="nv">exp</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">m</span><span class="p">))</span>
<span class="lineno">19 </span>                    <span class="nv">m</span><span class="p">))))</span>
<span class="lineno">20 </span>
<span class="lineno">21 </span><span class="nv">expmod</span> <span class="p">(</span><span class="mi">100</span> <span class="mi">1000000007</span> <span class="mi">1000000007</span><span class="p">)</span>
<span class="lineno">22 </span><span class="nv">reminder</span> <span class="p">(</span><span class="mi">100</span> <span class="nv">*</span> <span class="p">[</span><span class="nv">expmod</span><span class="p">(</span><span class="mi">100</span> <span class="mi">1000000006</span> <span class="mi">1000000007</span><span class="p">)])</span> <span class="mi">1000000007</span>
<span class="lineno">23 </span><span class="c1">;; тут мы будем умножать на остаток []</span>
<span class="lineno">24 </span><span class="p">[]</span> <span class="nv">=</span> <span class="nv">reminder</span> <span class="p">(</span><span class="nf">square</span> <span class="p">([</span><span class="nv">expmod</span> <span class="mi">100</span> <span class="mi">500000003</span> <span class="mi">1000000007</span><span class="p">]))</span> <span class="mi">1000000007</span><span class="p">)</span>
<span class="lineno">25 </span><span class="c1">;; возводить в квадрат и перемножать мы будем остаток от деления</span>
<span class="lineno">26 </span><span class="c1">;; мы сделаем это лагорифмическое число раз</span>
<span class="lineno">27 </span><span class="nv">reminder</span> <span class="p">(</span><span class="nf">square</span> <span class="p">(</span><span class="mi">100</span> <span class="nv">*</span> <span class="nv">expmod</span><span class="p">(</span><span class="mi">100</span> <span class="mi">1000000006</span><span class="nv">/2</span> <span class="mi">1000000007</span><span class="p">))</span>
<span class="lineno">28 </span>
<span class="lineno">29 </span><span class="c1">;; метод Алисы</span>
<span class="lineno">30 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">fast-expt</span> <span class="nv">b</span> <span class="nv">n</span><span class="p">)</span>
<span class="lineno">31 </span>  <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">= </span><span class="nv">n</span> <span class="mi">0</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span>
<span class="lineno">32 </span>        <span class="p">((</span><span class="nb">even? </span><span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nf">square</span> <span class="p">(</span><span class="nf">fast-expt</span> <span class="nv">b</span> <span class="p">(</span><span class="nb">/ </span><span class="nv">n</span> <span class="mi">2</span><span class="p">))))</span>
<span class="lineno">33 </span>        <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">* </span><span class="nv">b</span> <span class="p">(</span><span class="nf">fast-expt</span> <span class="nv">b</span> <span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="mi">1</span><span class="p">))))))</span>
<span class="lineno">34 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">expmod</span> <span class="nv">base</span> <span class="nv">exp</span> <span class="nv">m</span><span class="p">)</span>
<span class="lineno">35 </span>  <span class="p">(</span><span class="nb">remainder </span><span class="p">(</span><span class="nf">fast-expt</span> <span class="nv">base</span> <span class="nv">exp</span><span class="p">)</span> <span class="nv">m</span><span class="p">))</span>
<span class="lineno">36 </span><span class="c1">;; тут мы сначала вычисляем экспоненту, с числами навроде 100**1000000007</span>
<span class="lineno">37 </span><span class="c1">;; умножение и возведение в квадрат на таких больших числах приводит к росту времени, алгоритм у нас по прежнему имеет лагорифмическую оценку по подсчету экспоненты, но порядок цифр таков, что обычное умножение требует больгих ресурсов компьютера.</span>
</pre>
</div>  </div>
 </div>
 <div class="chapter-block">
  <h2>
   Упражнение 1.26
  </h2>
  <div>
   <div>
    <p>
     Луи изменил процедуру expmod как приведено ниже.
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno">1 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">expmod</span> <span class="nv">base</span> <span class="nv">exp</span> <span class="nv">m</span><span class="p">)</span>
<span class="lineno">2 </span>  <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">= </span><span class="nv">exp</span> <span class="mi">0</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span>
<span class="lineno">3 </span>        <span class="p">((</span><span class="nb">even? </span><span class="nv">exp</span><span class="p">)</span>
<span class="lineno">4 </span>         <span class="p">(</span><span class="nb">remainder </span><span class="p">(</span><span class="nb">* </span><span class="p">(</span><span class="nf">expmod</span> <span class="nv">base</span> <span class="p">(</span><span class="nb">/ </span><span class="nv">exp</span> <span class="mi">2</span><span class="p">)</span> <span class="nv">m</span><span class="p">)</span>
<span class="lineno">5 </span>                       <span class="p">(</span><span class="nf">expmod</span> <span class="nv">base</span> <span class="p">(</span><span class="nb">/ </span><span class="nv">exp</span> <span class="mi">2</span><span class="p">)</span> <span class="nv">m</span><span class="p">))</span>
<span class="lineno">6 </span>                    <span class="nv">m</span><span class="p">))</span>
<span class="lineno">7 </span>        <span class="p">(</span><span class="nf">else</span>
<span class="lineno">8 </span>         <span class="p">(</span><span class="nb">remainder </span><span class="p">(</span><span class="nb">* </span><span class="nv">base</span> <span class="p">(</span><span class="nf">expmod</span> <span class="nv">base</span> <span class="p">(</span><span class="nb">- </span><span class="nv">exp</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">m</span><span class="p">))</span>
<span class="lineno">9 </span>                    <span class="nv">m</span><span class="p">))))</span>
</pre>
</div>   <div>
    <p>
     Его тест с fast-prime? стал работать медленнее теста prime? Записав процедуру таким образом мы изменили порядок роста <span class="inline-formula"><img class="img-inline-formula img-formula" width="69" height="17" src="formulae/1x5T1vUP00ZqvVjCivgudKxH94n8CzR8J2yhGg.png" alt="\theta(log(n))" title="\theta(log(n))"></span> на <span class="inline-formula"><img class="img-inline-formula img-formula" width="32" height="17" src="formulae/cCSlLH6spWmUZ.yEu3RFI4JpEISlQpO3e_iouA.png" alt="\theta(n)" title="\theta(n)"></span>. Поясните.
    </p>
    <p>
     На каждой итерации (вернее через одну) мы сокращаем показатель экспоненты в два раза, но при этом мы увеличиваем количество операций в два раза. И таких шагов будет порядка n. То есть порядок роста данной процедуры будет <span class="inline-formula"><img class="img-inline-formula img-formula" width="125" height="17" src="formulae/l0_g5HESpbwL51Bg3kOuV1NK6d.gEU49UQiD0w.png" alt="\theta(log(2^n) = \theta(n)" title="\theta(log(2^n) = \theta(n)"></span>.
    </p>
   </div>
  </div>
 </div>
 <div class="chapter-block">
  <h2>
   Упражнение 1.27
  </h2>
  <div>
   <div>
    <p>
     Продемонстрируйте что числа Кармайкла действительно проходят тест Фрема. Напишите процедуру которая принимает целое и тестуриует все числе &lt; n.
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno"> 1 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">fermat-test-all</span> <span class="nv">n</span><span class="p">)</span>
<span class="lineno"> 2 </span>  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">iter-test</span> <span class="nv">a</span><span class="p">)</span>
<span class="lineno"> 3 </span>    <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">&gt;= </span><span class="nv">a</span> <span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nb">display </span><span class="s">"passed full fermat"</span><span class="p">))</span>
<span class="lineno"> 4 </span>          <span class="p">((</span><span class="nb">= </span><span class="p">(</span><span class="nf">expmod</span> <span class="nv">a</span> <span class="nv">n</span> <span class="nv">n</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span> <span class="p">(</span><span class="nf">iter-test</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">a</span> <span class="mi">1</span><span class="p">)))</span>
<span class="lineno"> 5 </span>          <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">display </span><span class="s">"Ferma test failed"</span><span class="p">))))</span>
<span class="lineno"> 6 </span>  <span class="p">(</span><span class="nf">iter-test</span> <span class="mi">2</span><span class="p">))</span>
<span class="lineno"> 7 </span>
<span class="lineno"> 8 </span><span class="p">(</span><span class="nf">fermat-test-all</span> <span class="mi">561</span><span class="p">)</span>  <span class="c1">; passed full fermat</span>
<span class="lineno"> 9 </span><span class="p">(</span><span class="nf">fermat-test-all</span> <span class="mi">1105</span><span class="p">)</span> <span class="c1">; passed full fermat</span>
<span class="lineno">10 </span><span class="p">(</span><span class="nf">fermat-test-all</span> <span class="mi">1729</span><span class="p">)</span> <span class="c1">; passed full fermat</span>
<span class="lineno">11 </span><span class="p">(</span><span class="nf">fermat-test-all</span> <span class="mi">2465</span><span class="p">)</span> <span class="c1">; passed full fermat</span>
<span class="lineno">12 </span><span class="p">(</span><span class="nf">fermat-test-all</span> <span class="mi">2821</span><span class="p">)</span> <span class="c1">; passed full fermat</span>
<span class="lineno">13 </span><span class="p">(</span><span class="nf">fermat-test-all</span> <span class="mi">6601</span><span class="p">)</span> <span class="c1">; passed full fermat</span>
</pre>
</div>  </div>
 </div>
 <div class="chapter-block">
  <h2>
   Упражнение 1.28
  </h2>
  <div>
   <div>
    <p>
     Один из вариантов теста Ферма, который не может быть одурачен числами Кармайкла, называется тест Миллера-Рабина (Миллер 1976; Рабин 1980). Он отталкивается от альтернативной формы Малой Теоремы Ферма, которая говорит что, если n - простое число и есть положительное целое a меньшее n, тогда <span class="inline-formula"><img class="img-inline-formula img-formula" width="124" height="18" src="formulae/h1NxGLnmrm3jF.Dr5t2Dx3FVFJTQnTF5iXXiSQ.png" alt="a^{n-1} \equiv 1 mod(n)" title="a^{n-1} \equiv 1 mod(n)"></span>.
    </p>
    <p>
     Для тестирования простоты числа n, мы выбираем произвольный a &lt; n и возводим его в степень (n-1), берем модуль используя процедуру expmod.
    </p>
    <p>
     Каждый раз когда мы выполняем возведение в квадрат, мы делаем дополнительную проверку на "не тривиальность квадратного корня к 1 по модулю n", то есть число не равное 1 или n-1, квадрат которого равен 1 по модулю n. Возможно доказать что если есть нетривиальный квадратный корень сопоставимый с 1 mod n, тогда n не простое. Также возможно доказать что если n нечетное число, которое не является простым, то по крайне мере для половины чисел a&lt;n, вычисление <span class="inline-formula"><img class="img-inline-formula img-formula" width="36" height="14" src="formulae/DiMGXUF1qBWcScK6PAT_f9sf89ACJHw5efZfAg.png" alt="a^{n-1}" title="a^{n-1}"></span> таким образом выявит нетривиальный квадратный корень от 1 по модулю n. (Именно из-за этого уточнения числа Кармайкла отсеиваются). Измените процедуру expmod что бы в случае обнаружения нетривиального квадратного корня она сигнализировала об ошибке.
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno"> 1 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">expmod-miller-rabin</span> <span class="nv">base</span> <span class="nv">exp</span> <span class="nv">m</span><span class="p">)</span>
<span class="lineno"> 2 </span>  <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">= </span><span class="nv">exp</span> <span class="mi">0</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span>
<span class="lineno"> 3 </span>        <span class="p">((</span><span class="nb">even? </span><span class="nv">exp</span><span class="p">)</span>
<span class="lineno"> 4 </span>         <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">x</span> <span class="p">(</span><span class="nf">expmod-miller-rabin</span> <span class="nv">base</span> <span class="p">(</span><span class="nb">/ </span><span class="nv">exp</span> <span class="mi">2</span><span class="p">)</span> <span class="nv">m</span><span class="p">)))</span>
<span class="lineno"> 5 </span>           <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="k">or </span><span class="p">(</span><span class="nb">= </span><span class="nv">x</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nb">= </span><span class="nv">x</span> <span class="p">(</span><span class="nb">- </span><span class="nv">m</span> <span class="mi">1</span><span class="p">)))</span> <span class="p">(</span><span class="nb">remainder </span><span class="p">(</span><span class="nf">square</span> <span class="nv">x</span><span class="p">)</span> <span class="nv">m</span><span class="p">))</span>
<span class="lineno"> 6 </span>                 <span class="p">((</span><span class="nb">= </span><span class="p">(</span><span class="nb">remainder </span><span class="p">(</span><span class="nf">square</span> <span class="nv">x</span><span class="p">)</span> <span class="nv">m</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
<span class="lineno"> 7 </span>                 <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">remainder </span><span class="p">(</span><span class="nf">square</span> <span class="nv">x</span><span class="p">)</span> <span class="nv">m</span><span class="p">)))))</span>
<span class="lineno"> 8 </span>        <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">remainder </span><span class="p">(</span><span class="nb">* </span><span class="nv">base</span> <span class="p">(</span><span class="nf">expmod-miller-rabin</span> <span class="nv">base</span> <span class="p">(</span><span class="nb">- </span><span class="nv">exp</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">m</span><span class="p">))</span>
<span class="lineno"> 9 </span>                         <span class="nv">m</span><span class="p">))))</span>
<span class="lineno">10 </span>
<span class="lineno">11 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">miller-rabin-test-all</span> <span class="nv">n</span><span class="p">)</span>
<span class="lineno">12 </span>  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">iter-test</span> <span class="nv">a</span><span class="p">)</span>
<span class="lineno">13 </span>    <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">&gt;= </span><span class="nv">a</span> <span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nb">display </span><span class="s">"passed full miller-rabin test"</span><span class="p">))</span>
<span class="lineno">14 </span>          <span class="p">((</span><span class="nb">= </span><span class="p">(</span><span class="nf">expmod-miller-rabin</span> <span class="nv">a</span> <span class="nv">n</span> <span class="nv">n</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span> <span class="p">(</span><span class="nf">iter-test</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">a</span> <span class="mi">1</span><span class="p">)))</span>
<span class="lineno">15 </span>          <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">display </span><span class="s">"miller-rabin test failed"</span><span class="p">))))</span>
<span class="lineno">16 </span>  <span class="p">(</span><span class="nf">iter-test</span> <span class="mi">2</span><span class="p">))</span>
<span class="lineno">17 </span>
<span class="lineno">18 </span><span class="p">(</span><span class="nf">miller-rabin-test-all</span> <span class="mi">1999</span><span class="p">)</span> <span class="c1">;;  passed full miller-rabin test</span>
<span class="lineno">19 </span><span class="p">(</span><span class="nf">miller-rabin-test-all</span> <span class="mi">561</span><span class="p">)</span> <span class="c1">;;  miller-rabin test failed</span>
</pre>
</div>  </div>
 </div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/sicp-uprazhneniia-120-124/" class="u-url">SICP Упражнения 1.20, 1.21, 1.22, 1.23, 1.24</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Velikii Nehochuha
            </span></p>
            <p class="dateline">
            <a href="posts/sicp-uprazhneniia-120-124/" rel="bookmark">
            <time class="published dt-published" datetime="2020-01-12T12:32:43+03:00" itemprop="datePublished" title="2020-01-12 12:32">2020-01-12 12:32</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div>
 <div class="chapter-block">
  <h2>
   Упражнение 1.20
  </h2>
  <div>
   <div>
    <p>
     Процесс который генерируется процедурой естественно зависит от правил интерпритатора. Как пример возьмем итеративную процецудуру нахождения наибольшего общего делителя приведенного выше. Предположим мы интерпритируем это процедуру используя "нормамальный порядок выполнения". Используя метод подстановки проиллюстрируйте процесс вычисления (gcd 206 40) и указать "reminder" операции которые реально выполняются. Сколько таких операций выполнится при "нормальном порядке" и сколько при "апликативном".
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno"> 1 </span><span class="c1">;; нормальный порядок</span>
<span class="lineno"> 2 </span><span class="p">(</span><span class="nb">gcd </span><span class="mi">206</span> <span class="mi">40</span><span class="p">)</span>
<span class="lineno"> 3 </span><span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="mi">40</span> <span class="mi">0</span><span class="p">))</span>
<span class="lineno"> 4 </span><span class="p">(</span><span class="nb">gcd </span><span class="mi">40</span> <span class="p">(</span><span class="nb">remainder </span><span class="mi">206</span> <span class="mi">40</span><span class="p">))</span>
<span class="lineno"> 5 </span><span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="p">(</span><span class="nb">remainder </span><span class="mi">206</span> <span class="mi">40</span><span class="p">)</span> <span class="mi">0</span><span class="p">))</span> <span class="c1">; 6 + 1 раз</span>
<span class="lineno"> 6 </span><span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="mi">6</span> <span class="mi">0</span><span class="p">))</span>
<span class="lineno"> 7 </span><span class="p">(</span><span class="nb">gcd </span><span class="p">(</span><span class="nb">remainder </span><span class="mi">206</span> <span class="mi">40</span><span class="p">)</span> <span class="p">(</span><span class="nb">remainder </span><span class="mi">40</span> <span class="p">(</span><span class="nb">remainder </span><span class="mi">206</span> <span class="mi">40</span><span class="p">)))</span>
<span class="lineno"> 8 </span><span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="p">(</span><span class="nb">remainder </span><span class="mi">40</span> <span class="p">(</span><span class="nb">remainder </span><span class="mi">206</span> <span class="mi">40</span><span class="p">))</span> <span class="mi">0</span><span class="p">))</span> <span class="c1">; 4 + 2 раза</span>
<span class="lineno"> 9 </span><span class="p">(</span><span class="nb">gcd </span><span class="p">(</span><span class="nb">remainder </span><span class="mi">40</span> <span class="p">(</span><span class="nb">remainder </span><span class="mi">206</span> <span class="mi">40</span><span class="p">))</span> <span class="p">(</span><span class="nb">remainder </span><span class="p">(</span><span class="nb">remainder </span><span class="mi">206</span> <span class="mi">40</span><span class="p">)</span> <span class="p">(</span><span class="nb">remainder </span><span class="mi">40</span> <span class="p">(</span><span class="nb">remainder </span><span class="mi">206</span> <span class="mi">40</span><span class="p">))))</span>
<span class="lineno">10 </span><span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="p">(</span><span class="nb">remainder </span><span class="p">(</span><span class="nb">remainder </span><span class="mi">206</span> <span class="mi">40</span><span class="p">)</span> <span class="p">(</span><span class="nb">remainder </span><span class="mi">40</span> <span class="p">(</span><span class="nb">remainder </span><span class="mi">206</span> <span class="mi">40</span><span class="p">)))</span> <span class="mi">0</span><span class="p">))</span> <span class="c1">; 2 + 4 раза</span>
<span class="lineno">11 </span><span class="p">(</span><span class="nb">gcd </span><span class="p">(</span><span class="nb">remainder </span><span class="p">(</span><span class="nb">remainder </span><span class="mi">206</span> <span class="mi">40</span><span class="p">)</span> <span class="p">(</span><span class="nb">remainder </span><span class="mi">40</span> <span class="p">(</span><span class="nb">remainder </span><span class="mi">206</span> <span class="mi">40</span><span class="p">)))</span> <span class="p">(</span><span class="nb">remainder </span><span class="p">(</span><span class="nb">remainder </span><span class="mi">40</span> <span class="p">(</span><span class="nb">remainder </span><span class="mi">206</span> <span class="mi">40</span><span class="p">))</span> <span class="p">(</span><span class="nb">remainder </span><span class="p">(</span><span class="nb">remainder </span><span class="mi">206</span> <span class="mi">40</span><span class="p">)</span> <span class="p">(</span><span class="nb">remainder </span><span class="mi">40</span> <span class="p">(</span><span class="nb">remainder </span><span class="mi">206</span> <span class="mi">40</span><span class="p">)))))</span>
<span class="lineno">12 </span><span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="p">(</span><span class="nf">reminder</span> <span class="p">(</span><span class="nb">remainder </span><span class="mi">40</span> <span class="p">(</span><span class="nb">remainder </span><span class="mi">206</span> <span class="mi">40</span><span class="p">))</span> <span class="p">(</span><span class="nb">remainder </span><span class="p">(</span><span class="nb">remainder </span><span class="mi">206</span> <span class="mi">40</span><span class="p">)</span> <span class="p">(</span><span class="nb">remainder </span><span class="mi">40</span> <span class="p">(</span><span class="nb">remainder </span><span class="mi">206</span> <span class="mi">40</span><span class="p">))))</span> <span class="mi">0</span><span class="p">))</span><span class="c1">; 0; + 7 раз</span>
<span class="lineno">13 </span><span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="mi">0</span> <span class="mi">0</span><span class="p">)</span> <span class="o">...</span><span class="p">)</span>
<span class="lineno">14 </span><span class="p">(</span><span class="nb">remainder </span><span class="p">(</span><span class="nb">remainder </span><span class="mi">206</span> <span class="mi">40</span><span class="p">)</span> <span class="p">(</span><span class="nb">remainder </span><span class="mi">40</span> <span class="p">(</span><span class="nb">remainder </span><span class="mi">206</span> <span class="mi">40</span><span class="p">)))</span> <span class="c1">;; 4 раза</span>
<span class="lineno">15 </span><span class="c1">;; 18 вычислений reminder</span>
<span class="lineno">16 </span><span class="c1">;; при апликативной форме этих вычислений всего 4</span>
</pre>
</div>   <div>
    <p>
     Вывод: при normal-order-evaluation 18 вызовов reminder, при applicative-order-evaluation 4.
    </p>
   </div>
  </div>
 </div>
 <div class="chapter-block">
  <h2>
   Упражнение 1.21
  </h2>
  <div>
   <div>
    <p>
     Используя процедуру "smallest-divisor" Найдите наиментший делитель для 199б 1999, 19999
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno"> 1 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">smallest-divisor</span> <span class="nv">n</span><span class="p">)</span>
<span class="lineno"> 2 </span>  <span class="p">(</span><span class="nf">find-divisor</span> <span class="nv">n</span> <span class="mi">2</span><span class="p">))</span>
<span class="lineno"> 3 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">find-divisor</span> <span class="nv">n</span> <span class="nv">test-divisor</span><span class="p">)</span>
<span class="lineno"> 4 </span>  <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">&gt; </span><span class="p">(</span><span class="nf">square</span> <span class="nv">test-divisor</span><span class="p">)</span> <span class="nv">n</span><span class="p">)</span> <span class="nv">n</span><span class="p">)</span>
<span class="lineno"> 5 </span>        <span class="p">((</span><span class="nf">divides?</span> <span class="nv">test-divisor</span> <span class="nv">n</span><span class="p">)</span> <span class="nv">test-divisor</span><span class="p">)</span>
<span class="lineno"> 6 </span>        <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">find-divisor</span> <span class="nv">n</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">test-divisor</span> <span class="mi">1</span><span class="p">)))))</span>
<span class="lineno"> 7 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">divides?</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
<span class="lineno"> 8 </span>  <span class="p">(</span><span class="nb">= </span><span class="p">(</span><span class="nb">remainder </span><span class="nv">b</span> <span class="nv">a</span><span class="p">)</span> <span class="mi">0</span><span class="p">))</span>
<span class="lineno"> 9 </span>
<span class="lineno">10 </span><span class="p">(</span><span class="nf">smallest-divisor</span> <span class="mi">199</span><span class="p">)</span> <span class="c1">; 199</span>
<span class="lineno">11 </span><span class="p">(</span><span class="nf">smallest-divisor</span> <span class="mi">1999</span><span class="p">)</span> <span class="c1">; 1999</span>
<span class="lineno">12 </span><span class="p">(</span><span class="nf">smallest-divisor</span> <span class="mi">19999</span><span class="p">)</span> <span class="c1">; 7</span>
</pre>
</div>  </div>
 </div>
 <div class="chapter-block">
  <h2>
   Упражнение 1.22
  </h2>
  <div>
   <div>
    <p>
     Большинство реализаций lisp включаются примитиву runtime, которая возвращает время работы системы. Ниже написана процедура которое замеряет время теста на простоту. Используя ей, напишите процедуру search-for-primes, которая проверяет простоту последовательных нечетных целых в заданном диапазоне. Используйте её чтобы найти 3 простых &gt; 1000; &gt; 10 000; &gt; 100 000; &gt; 1 000 000. Замерьте время для проверки каждого простого числа. Так как тестирующий алгоритм имеет порядок роста <span class="inline-formula"><img class="img-inline-formula img-formula" width="47" height="18" src="formulae/Fm5mrdojcg8nfk0moVZWNPpDRW6kuON6Rr83Gg.png" alt="\theta(\sqrt{n})" title="\theta(\sqrt{n})"></span>, вы должны ожидать получить для время для 10 000 в <span class="inline-formula"><img class="img-inline-formula img-formula" width="32" height="18" src="formulae/stpajtmjWkASRa_Px.gSazh7yZYs.WaF43zFUg.png" alt="\sqrt{10}" title="\sqrt{10}"></span> больше времени чем для 1 000. Посмотрите как работает это соотношение для разных диапазонов n.
    </p>
    <p>
     Запись кривовата, потому что нет конструкции (let или progn как в emacs lisp, просто их еще не было в курсе). Тенденция <span class="inline-formula"><img class="img-inline-formula img-formula" width="33" height="18" src="formulae/R5RobS5u6di.UD.78_HWXVOLw_0Y2cnEpyVVEQ.png" alt="\theta{\sqrt{n}}" title="\theta{\sqrt{n}}"></span> начинает походить на оценку только с 10 000 000. До этого все данные совпадают и нет прироста.
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno"> 1 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">report-prime</span> <span class="nv">start-time</span> <span class="nv">end-time</span><span class="p">)</span>
<span class="lineno"> 2 </span>  <span class="p">(</span><span class="nf">newline</span><span class="p">)</span>
<span class="lineno"> 3 </span>  <span class="p">(</span><span class="nb">display </span><span class="s">" *** "</span><span class="p">)</span>
<span class="lineno"> 4 </span>  <span class="p">(</span><span class="nb">display </span><span class="nv">start-time</span><span class="p">)</span>
<span class="lineno"> 5 </span>  <span class="p">(</span><span class="nb">display </span><span class="s">"; "</span><span class="p">)</span>
<span class="lineno"> 6 </span>  <span class="p">(</span><span class="nb">display </span><span class="nv">end-time</span><span class="p">)</span>
<span class="lineno"> 7 </span>  <span class="p">(</span><span class="nb">display </span><span class="s">"; "</span><span class="p">)</span>
<span class="lineno"> 8 </span>  <span class="p">(</span><span class="nb">display </span><span class="p">(</span><span class="nb">- </span><span class="nv">end-time</span> <span class="nv">start-time</span><span class="p">)))</span>
<span class="lineno"> 9 </span>
<span class="lineno">10 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">prime?</span> <span class="nv">n</span><span class="p">)</span>
<span class="lineno">11 </span>  <span class="p">(</span><span class="nb">= </span><span class="nv">n</span> <span class="p">(</span><span class="nf">smallest-divisor</span> <span class="nv">n</span><span class="p">)))</span>
<span class="lineno">12 </span>
<span class="lineno">13 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">search-iter</span> <span class="nv">from</span> <span class="nv">number</span> <span class="nv">start-time</span><span class="p">)</span>
<span class="lineno">14 </span>  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nb">= </span><span class="nv">number</span> <span class="mi">0</span><span class="p">))</span>
<span class="lineno">15 </span>      <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">prime?</span> <span class="nv">from</span><span class="p">)</span>
<span class="lineno">16 </span>          <span class="p">(</span><span class="nf">report-and-continue</span> <span class="nv">from</span> <span class="nv">number</span> <span class="nv">start-time</span> <span class="p">(</span><span class="nf">runtime</span><span class="p">))</span>
<span class="lineno">17 </span>          <span class="p">(</span><span class="nf">search-iter</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">from</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">number</span> <span class="nv">start-time</span><span class="p">))))</span>
<span class="lineno">18 </span>
<span class="lineno">19 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">report-and-continue</span> <span class="nv">from</span> <span class="nv">number</span> <span class="nv">start-time</span> <span class="nv">end-time</span><span class="p">)</span>
<span class="lineno">20 </span>  <span class="p">(</span><span class="nf">newline</span><span class="p">)</span>
<span class="lineno">21 </span>  <span class="p">(</span><span class="nb">display </span><span class="nv">from</span><span class="p">)</span>
<span class="lineno">22 </span>  <span class="p">(</span><span class="nf">newline</span><span class="p">)</span>
<span class="lineno">23 </span>  <span class="p">(</span><span class="nf">report-prime</span> <span class="nv">start-time</span> <span class="nv">end-time</span><span class="p">)</span>
<span class="lineno">24 </span>  <span class="p">(</span><span class="nf">search-iter</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">from</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nb">- </span><span class="nv">number</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">start-time</span><span class="p">))</span>
<span class="lineno">25 </span>
<span class="lineno">26 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">search-for-primes</span> <span class="nv">from</span> <span class="nv">number</span><span class="p">)</span>
<span class="lineno">27 </span>  <span class="p">(</span><span class="nf">search-iter</span> <span class="nv">from</span> <span class="nv">number</span> <span class="p">(</span><span class="nf">runtime</span><span class="p">)))</span>
<span class="lineno">28 </span>
<span class="lineno">29 </span><span class="p">(</span><span class="nf">search-for-primes</span> <span class="mi">1000</span> <span class="mi">3</span><span class="p">)</span>
<span class="lineno">30 </span><span class="p">(</span><span class="nf">search-for-primes</span> <span class="mi">10000</span> <span class="mi">3</span><span class="p">)</span>
<span class="lineno">31 </span><span class="p">(</span><span class="nf">search-for-primes</span> <span class="mi">100000</span> <span class="mi">3</span><span class="p">)</span>
<span class="lineno">32 </span><span class="p">(</span><span class="nf">search-for-primes</span> <span class="mi">1000000</span> <span class="mi">3</span><span class="p">)</span>
<span class="lineno">33 </span><span class="p">(</span><span class="nf">search-for-primes</span> <span class="mi">10000000</span> <span class="mi">3</span><span class="p">)</span>
<span class="lineno">34 </span><span class="p">(</span><span class="nf">search-for-primes</span> <span class="mi">100000000</span> <span class="mi">3</span><span class="p">)</span>
</pre>
</div>   <div class="center-block">
    <p>
     </p>
<div class="tabular-wrapper"><table>
<tr>
<td class="cell-lt" style="text-align: left;">1009 </td>
<td class="cell-lrt" style="text-align: center;"> 0. </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">1013 </td>
<td class="cell-lrt" style="text-align: center;"> 1.0000000000001563e-2 </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">1019 </td>
<td class="cell-lrt" style="text-align: center;"> 1.0000000000001563e-2 </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">10007 </td>
<td class="cell-lrt" style="text-align: center;"> 0. </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">10009 </td>
<td class="cell-lrt" style="text-align: center;"> .00999999999999801 </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">10037 </td>
<td class="cell-lrt" style="text-align: center;"> 1.9999999999999574e-2 </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">100003 </td>
<td class="cell-lrt" style="text-align: center;"> 0. </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">100019 </td>
<td class="cell-lrt" style="text-align: center;"> 1.0000000000001563e-2 </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">100043 </td>
<td class="cell-lrt" style="text-align: center;"> 1.9999999999999574e-2 </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">1000003 </td>
<td class="cell-lrt" style="text-align: center;"> 0. </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">1000033 </td>
<td class="cell-lrt" style="text-align: center;"> 1.0000000000001563e-2 </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">1000037 </td>
<td class="cell-lrt" style="text-align: center;"> 1.9999999999999574e-2 </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">10000019 </td>
<td class="cell-lrt" style="text-align: center;"> .00999999999999801 </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">10000079 </td>
<td class="cell-lrt" style="text-align: center;"> .03999999999999915 </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">10000103 </td>
<td class="cell-lrt" style="text-align: center;"> .05999999999999872 </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">100000007 </td>
<td class="cell-lrt" style="text-align: center;"> .03999999999999915 </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">10000079 </td>
<td class="cell-lrt" style="text-align: center;"> .08999999999999986 </td>
</tr>
<tr>
<td class="cell-ltb" style="text-align: left;">10000103 </td>
<td class="cell-lrtb" style="text-align: center;"> .129999999999999 </td>
</tr>
</table></div>
    
   </div>
  </div>
 </div>
 <div class="chapter-block">
  <h2>
   Упражнение 1.23
  </h2>
  <div>
   <div>
    <p>
     Процедура smallest-divisor приведенная в начале главы выполняет много ненужных проверок. После проверки деления на 2, нет смысла делить на любые другие четные. То есть значениями для проверки должны быть не 2, 3, 4, 5, 6, ..., а 2, 3, 5, 7, 9, ....
    </p>
    <p>
     Сделайте это изменение реализовав процедуру next, которая вернет 3 если на вход получили 2, в ином случае вернет входное значение плюс два. Измените smallest-divisor используя (next test-divisor) (+ test-divisor 1).
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno"> 1 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">smallest-divisor</span> <span class="nv">n</span><span class="p">)</span>
<span class="lineno"> 2 </span>  <span class="p">(</span><span class="nf">find-divisor</span> <span class="nv">n</span> <span class="mi">2</span><span class="p">))</span>
<span class="lineno"> 3 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">next</span> <span class="nv">n</span><span class="p">)</span>
<span class="lineno"> 4 </span>  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="nv">n</span> <span class="mi">2</span><span class="p">)</span>
<span class="lineno"> 5 </span>      <span class="mi">3</span>
<span class="lineno"> 6 </span>      <span class="p">(</span><span class="nb">+ </span><span class="nv">n</span> <span class="mi">2</span><span class="p">)))</span>
<span class="lineno"> 7 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">find-divisor</span> <span class="nv">n</span> <span class="nv">test-divisor</span><span class="p">)</span>
<span class="lineno"> 8 </span>  <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">&gt; </span><span class="p">(</span><span class="nf">square</span> <span class="nv">test-divisor</span><span class="p">)</span> <span class="nv">n</span><span class="p">)</span> <span class="nv">n</span><span class="p">)</span>
<span class="lineno"> 9 </span>        <span class="p">((</span><span class="nf">divides?</span> <span class="nv">test-divisor</span> <span class="nv">n</span><span class="p">)</span> <span class="nv">test-divisor</span><span class="p">)</span>
<span class="lineno">10 </span>        <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">find-divisor</span> <span class="nv">n</span> <span class="p">(</span><span class="nf">next</span> <span class="nv">test-divisor</span><span class="p">)))))</span>
<span class="lineno">11 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">divides?</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
<span class="lineno">12 </span>  <span class="p">(</span><span class="nb">= </span><span class="p">(</span><span class="nb">remainder </span><span class="nv">b</span> <span class="nv">a</span><span class="p">)</span> <span class="mi">0</span><span class="p">))</span>
</pre>
</div>   <div>
    <p>
     Повторите тест из 1.22
    </p>
    <div class="center-block">
     <p>
      </p>
<div class="tabular-wrapper"><table>
<tr>
<td class="cell-lt" style="text-align: left;">1009 </td>
<td class="cell-lrt" style="text-align: center;"> 0. </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">1013 </td>
<td class="cell-lrt" style="text-align: center;"> 0. </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">1019 </td>
<td class="cell-lrt" style="text-align: center;"> 1.0000000000001563e-2 </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">10007 </td>
<td class="cell-lrt" style="text-align: center;"> 0. </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">10009 </td>
<td class="cell-lrt" style="text-align: center;"> 0. </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">10037 </td>
<td class="cell-lrt" style="text-align: center;"> 1.0000000000001563e-2 </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">100003 </td>
<td class="cell-lrt" style="text-align: center;"> 0. </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">100019 </td>
<td class="cell-lrt" style="text-align: center;"> 1.0000000000001563e-2 </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">100043 </td>
<td class="cell-lrt" style="text-align: center;"> 1.9999999999999574e-2 </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">1000003 </td>
<td class="cell-lrt" style="text-align: center;"> 0. </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">1000033 </td>
<td class="cell-lrt" style="text-align: center;"> 1.0000000000001563e-2 </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">1000037 </td>
<td class="cell-lrt" style="text-align: center;"> 2.0000000000003126e-2 </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">10000019 </td>
<td class="cell-lrt" style="text-align: center;"> .0 </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">10000079 </td>
<td class="cell-lrt" style="text-align: center;"> 1.9999999999999574e-2 </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">10000103 </td>
<td class="cell-lrt" style="text-align: center;"> 3.0000000000001137e-2 </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">100000007 </td>
<td class="cell-lrt" style="text-align: center;"> 1.9999999999999574e-2 </td>
</tr>
<tr>
<td class="cell-lt" style="text-align: left;">100000037 </td>
<td class="cell-lrt" style="text-align: center;"> .05000000000000071 </td>
</tr>
<tr>
<td class="cell-ltb" style="text-align: left;">100000039 </td>
<td class="cell-lrtb" style="text-align: center;"> .07000000000000028 </td>
</tr>
</table></div>
     
    </div>
    <p>
     Во многих случаях уменьшилось в два раза.
    </p>
   </div>
  </div>
 </div>
 <div class="chapter-block">
  <h2>
   Упражнение 1.24
  </h2>
  <div>
   <div>
    <p>
     Измените процедуру timed-prime-test из 1.22 что бы она использовала fast-prime? (метод Ферма), протестируйте 12 чисел которые были найдены в упражнении 1.22. Сравните время проверки. Так как тест Ферма имеет порядок роста (log n), каково ожидание по времени для чисел около 1,000,000 в сравнении с числами около 1000? Подтвержают ли это ваши данные? Можете объяснить несоответствия, которые найдете?
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno"> 1 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">smallest-divisor</span> <span class="nv">n</span><span class="p">)</span>
<span class="lineno"> 2 </span>  <span class="p">(</span><span class="nf">find-divisor</span> <span class="nv">n</span> <span class="mi">2</span><span class="p">))</span>
<span class="lineno"> 3 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">next</span> <span class="nv">n</span><span class="p">)</span>
<span class="lineno"> 4 </span>  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="nv">n</span> <span class="mi">2</span><span class="p">)</span>
<span class="lineno"> 5 </span>      <span class="mi">3</span>
<span class="lineno"> 6 </span>      <span class="p">(</span><span class="nb">+ </span><span class="nv">n</span> <span class="mi">2</span><span class="p">)))</span>
<span class="lineno"> 7 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">find-divisor</span> <span class="nv">n</span> <span class="nv">test-divisor</span><span class="p">)</span>
<span class="lineno"> 8 </span>  <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">&gt; </span><span class="p">(</span><span class="nf">square</span> <span class="nv">test-divisor</span><span class="p">)</span> <span class="nv">n</span><span class="p">)</span> <span class="nv">n</span><span class="p">)</span>
<span class="lineno"> 9 </span>        <span class="p">((</span><span class="nf">divides?</span> <span class="nv">test-divisor</span> <span class="nv">n</span><span class="p">)</span> <span class="nv">test-divisor</span><span class="p">)</span>
<span class="lineno">10 </span>        <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">find-divisor</span> <span class="nv">n</span> <span class="p">(</span><span class="nf">next</span> <span class="nv">test-divisor</span><span class="p">)))))</span>
<span class="lineno">11 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">divides?</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
<span class="lineno">12 </span>  <span class="p">(</span><span class="nb">= </span><span class="p">(</span><span class="nb">remainder </span><span class="nv">b</span> <span class="nv">a</span><span class="p">)</span> <span class="mi">0</span><span class="p">))</span>
</pre>
</div>   <div>
    <p>
     для диапазанов &lt; 10,000,000 время проверки по исходному тесту было .0, поэтому я добавил еще один диапазон и протестировал сначала старую функцию timed-prime-test
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno"> 1 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">10000019</span><span class="p">)</span><span class="c1">; 1.0000000000001563e-2</span>
<span class="lineno"> 2 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">10000079</span><span class="p">)</span><span class="c1">; 1.0000000000001563e-2</span>
<span class="lineno"> 3 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">10000103</span><span class="p">)</span><span class="c1">; 1.0000000000001563e-2</span>
<span class="lineno"> 4 </span>
<span class="lineno"> 5 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">100000007</span><span class="p">)</span><span class="c1">; 1.9999999999999574e-2</span>
<span class="lineno"> 6 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">100000037</span><span class="p">)</span><span class="c1">; 2.0000000000003126e-2</span>
<span class="lineno"> 7 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">100000039</span><span class="p">)</span><span class="c1">; 2.0000000000003126e-2</span>
<span class="lineno"> 8 </span>
<span class="lineno"> 9 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">1000000007</span><span class="p">)</span><span class="c1">; .05000000000000071</span>
<span class="lineno">10 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">1000000009</span><span class="p">)</span><span class="c1">; .05999999999999872</span>
<span class="lineno">11 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">1000000021</span><span class="p">)</span><span class="c1">; .07000000000000028</span>
</pre>
</div>   <div>
    <p>
     результаты выполнения теста между 1 и 2 диапазоном &lt; <span class="inline-formula"><img class="img-inline-formula img-formula" width="32" height="18" src="formulae/stpajtmjWkASRa_Px.gSazh7yZYs.WaF43zFUg.png" alt="\sqrt{10}" title="\sqrt{10}"></span> между 2 и 3 приближенно равны ему.
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno"> 1 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">10000019</span><span class="p">)</span><span class="c1">; 1.0000000000001563e-2</span>
<span class="lineno"> 2 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">10000079</span><span class="p">)</span><span class="c1">; 1.0000000000001563e-2</span>
<span class="lineno"> 3 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">10000103</span><span class="p">)</span><span class="c1">; 1.0000000000001563e-2</span>
<span class="lineno"> 4 </span>
<span class="lineno"> 5 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">100000007</span><span class="p">)</span><span class="c1">; 1.9999999999999574e-2</span>
<span class="lineno"> 6 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">100000037</span><span class="p">)</span><span class="c1">; 2.0000000000003126e-2</span>
<span class="lineno"> 7 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">100000039</span><span class="p">)</span><span class="c1">; 2.0000000000003126e-2</span>
<span class="lineno"> 8 </span>
<span class="lineno"> 9 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">1000000007</span><span class="p">)</span><span class="c1">; .05000000000000071</span>
<span class="lineno">10 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">1000000009</span><span class="p">)</span><span class="c1">; .05999999999999872</span>
<span class="lineno">11 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">1000000021</span><span class="p">)</span><span class="c1">; .07000000000000028</span>
</pre>
</div>   <div>
    <p>
     после этого переписал через fast-prime, время теста зависит от количества проверок
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno"> 1 </span><span class="c1">; c 10 проверками</span>
<span class="lineno"> 2 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">10000019</span><span class="p">)</span><span class="c1">; 0.</span>
<span class="lineno"> 3 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">10000079</span><span class="p">)</span><span class="c1">; 0.</span>
<span class="lineno"> 4 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">10000103</span><span class="p">)</span><span class="c1">; .00999999999999801</span>
<span class="lineno"> 5 </span>
<span class="lineno"> 6 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">100000007</span><span class="p">)</span><span class="c1">; 0.</span>
<span class="lineno"> 7 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">100000037</span><span class="p">)</span><span class="c1">; .00999999999999801</span>
<span class="lineno"> 8 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">100000039</span><span class="p">)</span><span class="c1">; .00999999999999801</span>
<span class="lineno"> 9 </span>
<span class="lineno">10 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">1000000007</span><span class="p">)</span><span class="c1">; 1.0000000000001563e-2</span>
<span class="lineno">11 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">1000000009</span><span class="p">)</span><span class="c1">; 1.0000000000001563e-2</span>
<span class="lineno">12 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">1000000021</span><span class="p">)</span><span class="c1">; 1.0000000000001563e-2</span>
<span class="lineno">13 </span>
<span class="lineno">14 </span><span class="c1">; с 1000 проверками</span>
<span class="lineno">15 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">10000019</span><span class="p">)</span><span class="c1">; .1999999999999993</span>
<span class="lineno">16 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">10000079</span><span class="p">)</span><span class="c1">; .20000000000000284</span>
<span class="lineno">17 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">10000103</span><span class="p">)</span><span class="c1">; .21999999999999886</span>
<span class="lineno">18 </span>
<span class="lineno">19 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">100000007</span><span class="p">)</span><span class="c1">; .23000000000000043</span>
<span class="lineno">20 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">100000037</span><span class="p">)</span><span class="c1">; .23999999999999844</span>
<span class="lineno">21 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">100000039</span><span class="p">)</span><span class="c1">; .240000000000002</span>
<span class="lineno">22 </span>
<span class="lineno">23 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">1000000007</span><span class="p">)</span><span class="c1">; .2699999999999996</span>
<span class="lineno">24 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">1000000009</span><span class="p">)</span><span class="c1">; .26000000000000156</span>
<span class="lineno">25 </span><span class="p">(</span><span class="nf">timed-prime-test</span> <span class="mi">1000000021</span><span class="p">)</span><span class="c1">; .259999999999998</span>
</pre>
</div>   <div>
    <p>
     оба тесты похожи на линейный прирост времени.
    </p>
   </div>
  </div>
 </div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/sicp-uprazhnenie-114/" class="u-url">SICP Упражнения 1.14, 1.15, 1.16, 1.17.</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Velikii Nehochuha
            </span></p>
            <p class="dateline">
            <a href="posts/sicp-uprazhnenie-114/" rel="bookmark">
            <time class="published dt-published" datetime="2020-01-11T14:54:25+03:00" itemprop="datePublished" title="2020-01-11 14:54">2020-01-11 14:54</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div>
 <div class="chapter-block">
  <h2>
   Упражнение 1.14
  </h2>
  <div>
   <div class="section-block">
    <h3>
     Изобразите дерево иллюстрирующее процесс процедуры count-charge из секции 1.22 для 11 центов.
    </h3>
    <div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno"> 1 </span><span class="c1">;; Example: Counting change</span>
<span class="lineno"> 2 </span><span class="c1">;; Сколькими способами мы можем внесни изменение в сумму</span>
<span class="lineno"> 3 </span><span class="c1">;; если у нас есть монеты 50 25 10 5 и 1 центов.</span>
<span class="lineno"> 4 </span><span class="c1">;; Есть простое решение через рекурсивную процедуру</span>
<span class="lineno"> 5 </span><span class="c1">;; если a = 0 1 способ внести изменение</span>
<span class="lineno"> 6 </span><span class="c1">;; если a &lt; 0 0 способов</span>
<span class="lineno"> 7 </span><span class="c1">;; если n = 0, 0 способов внести изменение</span>
<span class="lineno"> 8 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">count-change</span> <span class="nv">amount</span><span class="p">)</span>
<span class="lineno"> 9 </span>  <span class="p">(</span><span class="nf">cc</span> <span class="nv">amount</span> <span class="mi">5</span><span class="p">))</span>
<span class="lineno">10 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">first-denomination</span> <span class="nv">kinds-of-coins</span><span class="p">)</span>
<span class="lineno">11 </span>  <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">= </span><span class="nv">kinds-of-coins</span> <span class="mi">1</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span>
<span class="lineno">12 </span>        <span class="p">((</span><span class="nb">= </span><span class="nv">kinds-of-coins</span> <span class="mi">2</span><span class="p">)</span> <span class="mi">5</span><span class="p">)</span>
<span class="lineno">13 </span>        <span class="p">((</span><span class="nb">= </span><span class="nv">kinds-of-coins</span> <span class="mi">3</span><span class="p">)</span> <span class="mi">10</span><span class="p">)</span>
<span class="lineno">14 </span>        <span class="p">((</span><span class="nb">= </span><span class="nv">kinds-of-coins</span> <span class="mi">4</span><span class="p">)</span> <span class="mi">25</span><span class="p">)</span>
<span class="lineno">15 </span>        <span class="p">((</span><span class="nb">= </span><span class="nv">kinds-of-coins</span> <span class="mi">5</span><span class="p">)</span> <span class="mi">50</span><span class="p">)))</span>
<span class="lineno">16 </span>
<span class="lineno">17 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">cc</span> <span class="nv">amount</span> <span class="nv">kinds-of-coins</span><span class="p">)</span>
<span class="lineno">18 </span>  <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">= </span><span class="nv">amount</span> <span class="mi">0</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span>
<span class="lineno">19 </span>        <span class="p">((</span><span class="k">or </span><span class="p">(</span><span class="nb">&lt; </span><span class="nv">amount</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nb">= </span><span class="nv">kinds-of-coins</span> <span class="mi">0</span><span class="p">))</span> <span class="mi">0</span><span class="p">)</span>
<span class="lineno">20 </span>        <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">cc</span> <span class="nv">amount</span>
<span class="lineno">21 </span>                     <span class="p">(</span><span class="nb">- </span><span class="nv">kinds-of-coins</span> <span class="mi">1</span><span class="p">))</span> <span class="c1">;; изменение берем разные монетки</span>
<span class="lineno">22 </span>                 <span class="p">(</span><span class="nf">cc</span> <span class="p">(</span><span class="nb">- </span><span class="nv">amount</span>
<span class="lineno">23 </span>                        <span class="p">(</span><span class="nf">first-denomination</span> <span class="nv">kinds-of-coins</span><span class="p">))</span> <span class="c1">;; изменяем сумму на значение монетки</span>
<span class="lineno">24 </span>                     <span class="nv">kinds-of-coins</span><span class="p">)))))</span>
</pre>
</div>     <div>
      <p>
       Иттерируя можно себе представить что получится что-то вроде.
      </p>
     </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno"> 1 </span>                            <span class="p">(</span><span class="nf">cc</span> <span class="mi">11</span> <span class="mi">5</span><span class="p">)</span>
<span class="lineno"> 2 </span>                     <span class="p">(</span><span class="nf">cc</span> <span class="mi">11</span> <span class="mi">4</span><span class="p">)</span>     <span class="p">(</span><span class="nf">cc</span> <span class="mi">-39</span> <span class="mi">5</span><span class="p">)</span>
<span class="lineno"> 3 </span>                <span class="p">(</span><span class="nf">cc</span> <span class="mi">11</span> <span class="mi">3</span><span class="p">)</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">-14</span> <span class="mi">4</span><span class="p">)</span>      <span class="mi">0</span>
<span class="lineno"> 4 </span>           <span class="p">(</span><span class="nf">cc</span> <span class="mi">11</span> <span class="mi">2</span><span class="p">)</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">1</span> <span class="mi">3</span><span class="p">)</span> <span class="nv">|</span> <span class="mi">0</span>
<span class="lineno"> 5 </span>      <span class="p">(</span><span class="nf">cc</span> <span class="mi">11</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">6</span> <span class="mi">2</span><span class="p">)</span> <span class="nv">|</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">1</span> <span class="mi">2</span><span class="p">)</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">-9</span> <span class="mi">3</span><span class="p">)</span>
<span class="lineno"> 6 </span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">11</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">10</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">|</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">6</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">|</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">-4</span> <span class="mi">2</span><span class="p">)</span> <span class="nv">|</span> <span class="mi">0</span>
<span class="lineno"> 7 </span>    <span class="mi">0</span> <span class="nv">|</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">10</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">9</span> <span class="mi">0</span><span class="p">)</span> <span class="nv">|</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">6</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">5</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">|</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">0</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">|</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">0</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">|</span> <span class="mi">0</span>
<span class="lineno"> 8 </span>          <span class="mi">0</span> <span class="nv">|</span> <span class="mi">0</span> <span class="nv">|</span> <span class="mi">0</span> <span class="nv">|</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">5</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">4</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">|</span> <span class="mi">0</span> <span class="nv">|</span> <span class="mi">0</span> <span class="nv">|</span> <span class="mi">0</span> <span class="nv">|</span> <span class="mi">0</span>
<span class="lineno"> 9 </span>          <span class="mi">0</span> <span class="nv">|</span> <span class="mi">0</span> <span class="nv">|</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">4</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">3</span> <span class="mi">1</span><span class="p">)</span>
<span class="lineno">10 </span>          <span class="mi">0</span> <span class="nv">|</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">3</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">2</span> <span class="mi">1</span><span class="p">)</span>
<span class="lineno">11 </span>          <span class="mi">0</span> <span class="nv">|</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">2</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">)</span>
<span class="lineno">12 </span>          <span class="mi">0</span> <span class="nv">|</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nf">cc</span> <span class="mi">0</span> <span class="mi">1</span><span class="p">)</span>
<span class="lineno">13 </span>          <span class="mi">0</span> <span class="nv">|</span> <span class="mi">0</span>
</pre>
</div>    </div>
   </div>
   <div class="section-block">
    <h3>
     Каков порядок роста (<span class="inline-formula"><img class="img-inline-formula img-formula" width="32" height="17" src="formulae/cCSlLH6spWmUZ.yEu3RFI4JpEISlQpO3e_iouA.png" alt="\theta(n)" title="\theta(n)"></span>) по памяти и по количеству шагов. Где n - сумма.
    </h3>
    <div>
     <div>
      <p>
       По количеству шагов, давайте представим что у нас есть всего одна монетка для изменений. Тогда.
      </p>
     </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno">1 </span>        <span class="p">(</span><span class="nf">cc</span> <span class="nv">amount</span> <span class="mi">1</span><span class="p">)</span>
<span class="lineno">2 </span>  <span class="p">(</span><span class="nf">cc</span> <span class="nv">amount</span> <span class="mi">0</span><span class="p">)</span>  <span class="p">(</span><span class="nf">cc</span> <span class="p">(</span><span class="nf">amount</span> <span class="nv">-</span> <span class="mi">1</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span>
<span class="lineno">3 </span><span class="mi">0</span>                <span class="mi">0</span>     <span class="p">(</span><span class="nf">cc</span> <span class="p">(</span><span class="nf">amount</span> <span class="nv">-</span> <span class="mi">2</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span>
</pre>
</div>     <div>
      <p>
       Видим что у нас левая часть всегда вырождается в 0. А порядок роста в право это просто <span class="inline-formula"><img class="img-inline-formula img-formula" width="32" height="17" src="formulae/cCSlLH6spWmUZ.yEu3RFI4JpEISlQpO3e_iouA.png" alt="\theta(n)" title="\theta(n)"></span>
      </p>
      <p>
       Теперь посмотрим что будет происходить с двумя монетками для изменения.
      </p>
     </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno">1 </span>        <span class="p">(</span><span class="nf">cc</span> <span class="nv">amount</span> <span class="mi">2</span><span class="p">)</span>
<span class="lineno">2 </span>  <span class="p">(</span><span class="nf">cc</span> <span class="nv">amount</span> <span class="mi">1</span><span class="p">)</span>  <span class="p">(</span><span class="nf">cc</span> <span class="p">(</span><span class="nf">amount</span> <span class="nv">-</span> <span class="mi">1</span><span class="p">)</span> <span class="mi">2</span><span class="p">)</span>
</pre>
</div>     <div>
      <p>
       Видим что в левой части у нас в точности то что при одной монетке. А в провой части у нас каждый раз будет создаваться новая левая для одной монетки и еще одна правая. Порядок роста у нас получится <span class="inline-formula"><img class="img-inline-formula img-formula" width="40" height="18" src="formulae/TDMg7xotZXKkYHRB35dASqEHcCEqzcosTs4gqA.png" alt="\theta(n^2)" title="\theta(n^2)"></span>.
      </p>
      <p>
       И так при каждом добавлении еще одного номинала разменной монетки, порядок роста будет увеличиваться на n.
      </p>
      <p>
       У нас в задаче 5 разменных монет, поэтому для нашей задачи порядок роста <span class="inline-formula"><img class="img-inline-formula img-formula" width="40" height="18" src="formulae/fOU3P7Sr57KOt1u0RoA3w7g8.o4nZ4F8ewg70g.png" alt="\theta(n^5)" title="\theta(n^5)"></span>.
      </p>
      <p>
       По памяти <span class="inline-formula"><img class="img-inline-formula img-formula" width="32" height="17" src="formulae/cCSlLH6spWmUZ.yEu3RFI4JpEISlQpO3e_iouA.png" alt="\theta(n)" title="\theta(n)"></span> (порядок максимального разветвления дерева).
      </p>
     </div>
    </div>
   </div>
  </div>
 </div>
 <div class="chapter-block">
  <h2>
   Упражнение 1.15
  </h2>
  <div>
   <div>
    <p>
     Синус угла (указанный в радианах) может быть вычислен используя приближение что <span class="inline-formula"><img class="img-inline-formula img-formula" width="74" height="17" src="formulae/VwTzGshSwoUNeeeAXWnwBL9X4VMacim1a14XTQ.png" alt="\sin(r) = r" title="\sin(r) = r"></span> если <span class="inline-formula"><img class="img-inline-formula img-formula" width="8" height="7" src="formulae/9PDR_uZ5xxt4l_bI_FVKMXrwFl94B6.ue5eEfg.png" alt="r" title="r"></span> малое значение. Для итеративного уменьшения угла будем использовать тригонометрическое тождество <span class="inline-formula"><img class="img-inline-formula img-formula" width="204" height="18" src="formulae/B.h1aEvWmQVlz4e7yBgWDTMA515GD0w6mJyTvg.png" alt="\sin{r} = 3\sin{r/3} - 4sin^3{r/3}" title="\sin{r} = 3\sin{r/3} - 4sin^3{r/3}"></span>.
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno">1 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">cube</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">* </span><span class="nv">x</span> <span class="nv">x</span> <span class="nv">x</span><span class="p">))</span>
<span class="lineno">2 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">p</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">- </span><span class="p">(</span><span class="nb">* </span><span class="mi">3</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">* </span><span class="mi">4</span> <span class="p">(</span><span class="nf">cube</span> <span class="nv">x</span><span class="p">))))</span>
<span class="lineno">3 </span>
<span class="lineno">4 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">sine</span> <span class="nv">angle</span><span class="p">)</span>
<span class="lineno">5 </span>   <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nb">&gt; </span><span class="p">(</span><span class="nb">abs </span><span class="nv">angle</span><span class="p">)</span> <span class="mf">0.1</span><span class="p">))</span>
<span class="lineno">6 </span>       <span class="nv">angle</span>
<span class="lineno">7 </span>       <span class="p">(</span><span class="nf">p</span> <span class="p">(</span><span class="nf">sine</span> <span class="p">(</span><span class="nb">/ </span><span class="nv">angle</span> <span class="mf">3.0</span><span class="p">)))))</span>
</pre>
</div>   <div>
    <div class="section-block">
     <h3>
      Сколько раз выполнится процедура p применительно к sin 12.15?
     </h3>
     <div>
      <p>
       Будем делить угол на 3 пока, он не станет меньше чем 0.1. 12.15/3/3/3/3/3 = 0.049, значит 5 раз.
      </p>
      <p>
       А если записать в общем виде это будет <span class="inline-formula"><img class="img-inline-formula img-formula" width="73" height="16" src="formulae/WyZGa87XcDVFaBuL3zhCCfou.bf8HHwAK4huJg.png" alt="\log_3{x} + a" title="\log_3{x} + a"></span>, где а константа.
      </p>
     </div>
    </div>
    <div class="section-block">
     <h3>
      Каков порядок роста этой функции.
     </h3>
     <div>
      <p>
       Порядок роста по количеству итераций равен <span class="inline-formula"><img class="img-inline-formula img-formula" width="55" height="17" src="formulae/p7Pg644Ou_yBspI.6P9dd_cyiYJtXOrDgKl4aQ.png" alt="\theta(log{n})" title="\theta(log{n})"></span>. По месту так же.
      </p>
     </div>
    </div>
   </div>
  </div>
 </div>
 <div class="chapter-block">
  <h2>
   Упражнение 1.16
  </h2>
  <div>
   <div>
    <p>
     Написать итеративный вариант быстрой экспоненты с порядком роста <span class="inline-formula"><img class="img-inline-formula img-formula" width="55" height="17" src="formulae/p7Pg644Ou_yBspI.6P9dd_cyiYJtXOrDgKl4aQ.png" alt="\theta(log{n})" title="\theta(log{n})"></span>
    </p>
    <p>
     Рекурсивный вариант:
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno"> 1 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nb">even? </span><span class="nv">n</span><span class="p">)</span>
<span class="lineno"> 2 </span>  <span class="p">(</span><span class="nb">= </span><span class="p">(</span><span class="nb">remainder </span><span class="nv">n</span> <span class="mi">2</span><span class="p">)</span> <span class="mi">0</span><span class="p">))</span>
<span class="lineno"> 3 </span><span class="p">(</span><span class="nb">even? </span><span class="mi">2</span><span class="p">)</span>
<span class="lineno"> 4 </span><span class="p">(</span><span class="nb">even? </span><span class="mi">7</span><span class="p">)</span>
<span class="lineno"> 5 </span>
<span class="lineno"> 6 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">fast-expt</span> <span class="nv">b</span> <span class="nv">n</span><span class="p">)</span>
<span class="lineno"> 7 </span>  <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">= </span><span class="nv">n</span> <span class="mi">0</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span>
<span class="lineno"> 8 </span>        <span class="p">((</span><span class="nb">even? </span><span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nf">square</span> <span class="p">(</span><span class="nf">fast-expt</span> <span class="nv">b</span> <span class="p">(</span><span class="nb">/ </span><span class="nv">n</span> <span class="mi">2</span><span class="p">))))</span>
<span class="lineno"> 9 </span>        <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">* </span><span class="nv">b</span> <span class="p">(</span><span class="nf">fast-expt</span> <span class="nv">b</span> <span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="mi">1</span><span class="p">))))))</span>
<span class="lineno">10 </span><span class="p">(</span><span class="nf">fast-expt</span> <span class="mi">5</span> <span class="mi">10</span><span class="p">)</span>
</pre>
</div>   <div>
    <p>
     Итеративный вариант:
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno"> 1 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nb">even? </span><span class="nv">n</span><span class="p">)</span>
<span class="lineno"> 2 </span>  <span class="p">(</span><span class="nb">= </span><span class="p">(</span><span class="nb">remainder </span><span class="nv">n</span> <span class="mi">2</span><span class="p">)</span> <span class="mi">0</span><span class="p">))</span>
<span class="lineno"> 3 </span>
<span class="lineno"> 4 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nb">expt </span><span class="nv">b</span> <span class="nv">n</span><span class="p">)</span>
<span class="lineno"> 5 </span>  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">expt-iter</span> <span class="nv">a</span> <span class="nv">count</span><span class="p">)</span>
<span class="lineno"> 6 </span>    <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">= </span><span class="nv">count</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span>
<span class="lineno"> 7 </span>          <span class="p">((</span><span class="nb">= </span><span class="nv">count</span> <span class="mi">0</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span>
<span class="lineno"> 8 </span>          <span class="p">((</span><span class="nb">&gt;= </span><span class="nv">count</span> <span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="mi">1</span><span class="p">))</span> <span class="p">(</span><span class="nf">expt-iter</span> <span class="p">(</span><span class="nf">square</span> <span class="nv">b</span><span class="p">)</span> <span class="p">(</span><span class="nb">/ </span><span class="nv">count</span> <span class="mi">2</span><span class="p">)))</span>
<span class="lineno"> 9 </span>          <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">expt-iter</span> <span class="p">(</span><span class="nf">square</span> <span class="nv">a</span><span class="p">)</span> <span class="p">(</span><span class="nb">/ </span><span class="nv">count</span> <span class="mi">2</span><span class="p">)))))</span>
<span class="lineno">10 </span>  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">even? </span><span class="nv">n</span><span class="p">)</span>
<span class="lineno">11 </span>      <span class="p">(</span><span class="nf">expt-iter</span> <span class="mi">1</span> <span class="nv">n</span><span class="p">)</span>
<span class="lineno">12 </span>      <span class="p">(</span><span class="nb">* </span><span class="nv">b</span> <span class="p">(</span><span class="nf">expt-iter</span> <span class="mi">1</span> <span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="mi">1</span><span class="p">)))))</span>
<span class="lineno">13 </span><span class="p">(</span><span class="nb">expt </span><span class="mi">3</span> <span class="mi">150</span><span class="p">)</span>
</pre>
</div>  </div>
 </div>
 <div class="chapter-block">
  <h2>
   Упражнение 1.17
  </h2>
  <div>
   <div>
    <p>
     Допустим у нас нет процедуры умножения, написать процедуру использую только сложение и предопределенные процедуры halve и double, с порядком роста <span class="inline-formula"><img class="img-inline-formula img-formula" width="55" height="17" src="formulae/p7Pg644Ou_yBspI.6P9dd_cyiYJtXOrDgKl4aQ.png" alt="\theta(log{n})" title="\theta(log{n})"></span>
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno"> 1 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">double</span> <span class="nv">x</span><span class="p">)</span>
<span class="lineno"> 2 </span>  <span class="p">(</span><span class="nb">* </span><span class="nv">x</span> <span class="mi">2</span><span class="p">))</span>
<span class="lineno"> 3 </span><span class="p">(</span><span class="nf">double</span> <span class="mi">2</span><span class="p">)</span>
<span class="lineno"> 4 </span>
<span class="lineno"> 5 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">halve</span> <span class="nv">x</span><span class="p">)</span>
<span class="lineno"> 6 </span>  <span class="p">(</span><span class="nb">/ </span><span class="nv">x</span> <span class="mi">2</span><span class="p">))</span>
<span class="lineno"> 7 </span><span class="p">(</span><span class="nf">halve</span> <span class="mi">4</span><span class="p">)</span>
<span class="lineno"> 8 </span>
<span class="lineno"> 9 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nb">even? </span><span class="nv">n</span><span class="p">)</span>
<span class="lineno">10 </span>  <span class="p">(</span><span class="nb">= </span><span class="p">(</span><span class="nb">remainder </span><span class="nv">n</span> <span class="mi">2</span><span class="p">)</span> <span class="mi">0</span><span class="p">))</span>
<span class="lineno">11 </span><span class="p">(</span><span class="nb">even? </span><span class="mi">6</span><span class="p">)</span>
<span class="lineno">12 </span>
<span class="lineno">13 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">fast?</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
<span class="lineno">14 </span>  <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="k">or </span><span class="p">(</span><span class="nb">= </span><span class="nv">b</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nb">= </span><span class="nv">a</span> <span class="mi">0</span><span class="p">))</span> <span class="mi">0</span><span class="p">)</span>
<span class="lineno">15 </span>        <span class="p">((</span><span class="nb">= </span><span class="nv">b</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span>
<span class="lineno">16 </span>        <span class="p">((</span><span class="nb">even? </span><span class="nv">b</span><span class="p">)</span> <span class="p">(</span><span class="nf">double</span> <span class="p">(</span><span class="nf">fast?</span> <span class="nv">a</span> <span class="p">(</span><span class="nf">halve</span> <span class="nv">b</span><span class="p">))))</span>
<span class="lineno">17 </span>        <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">+ </span><span class="nv">a</span> <span class="p">(</span><span class="nf">double</span> <span class="p">(</span><span class="nf">fast?</span> <span class="nv">a</span> <span class="p">(</span><span class="nf">halve</span> <span class="p">(</span><span class="nb">- </span><span class="nv">b</span> <span class="mi">1</span><span class="p">))))))))</span>
<span class="lineno">18 </span><span class="p">(</span><span class="nf">fast?</span> <span class="mi">10</span> <span class="mi">0</span><span class="p">)</span>
<span class="lineno">19 </span><span class="p">(</span><span class="nf">fast?</span> <span class="mi">0</span> <span class="mi">10</span><span class="p">)</span>
<span class="lineno">20 </span><span class="p">(</span><span class="nf">fast?</span> <span class="mi">10</span> <span class="mi">10</span><span class="p">)</span>
<span class="lineno">21 </span><span class="p">(</span><span class="nf">fast?</span> <span class="mi">10</span> <span class="mi">11</span><span class="p">)</span>
</pre>
</div>  </div>
 </div>
 <div class="chapter-block">
  <h2>
   Упражнение 1.18
  </h2>
  <div>
   <div>
    <p>
     Используя результаты 1.16, 1.17 разработайте итеративную процедуру умножения двух чисел в терминах “удвоить, взять половину, добавить”, процедура должна выполняться с порядком роста <span class="inline-formula"><img class="img-inline-formula img-formula" width="55" height="17" src="formulae/p7Pg644Ou_yBspI.6P9dd_cyiYJtXOrDgKl4aQ.png" alt="\theta(log{n})" title="\theta(log{n})"></span>.
    </p>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno"> 1 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">fast?</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
<span class="lineno"> 2 </span>  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">fast-iter</span> <span class="nv">asum</span> <span class="nv">bsum</span> <span class="nv">count</span><span class="p">)</span>
<span class="lineno"> 3 </span>    <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">= </span><span class="nv">bsum</span> <span class="mi">0</span><span class="p">)</span> <span class="nv">asum</span><span class="p">)</span>
<span class="lineno"> 4 </span>          <span class="p">((</span><span class="nb">= </span><span class="nv">bsum</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">asum</span><span class="p">)</span>
<span class="lineno"> 5 </span>          <span class="p">((</span><span class="nb">even? </span><span class="nv">bsum</span><span class="p">)</span> <span class="p">(</span><span class="nf">fast-iter</span> <span class="p">(</span><span class="nf">double</span> <span class="nv">asum</span><span class="p">)</span> <span class="p">(</span><span class="nf">halve</span> <span class="nv">bsum</span><span class="p">)))</span>
<span class="lineno"> 6 </span>          <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">fast-iter</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">asum</span> <span class="nv">asum</span><span class="p">)</span> <span class="p">(</span><span class="nb">- </span><span class="nv">bsum</span> <span class="mi">1</span><span class="p">)))))</span>
<span class="lineno"> 7 </span>  <span class="p">(</span><span class="k">cond </span><span class="p">(</span><span class="k">or </span><span class="p">(</span><span class="nb">= </span><span class="nv">b</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nb">= </span><span class="nv">a</span> <span class="mi">0</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
<span class="lineno"> 8 </span>        <span class="p">((</span><span class="nb">= </span><span class="nv">b</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span>
<span class="lineno"> 9 </span>        <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">fast-iter</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">))))</span>
<span class="lineno">10 </span><span class="p">(</span><span class="nf">fast?</span> <span class="mi">16</span> <span class="mi">18</span><span class="p">)</span>
</pre>
</div>  </div>
 </div>
 <div class="chapter-block">
  <h2>
   Упражнение 1.19
  </h2>
  <div>
   <div>
    <p>
     Доработать вычисление функции Фибоначи, процедура должна выполняться с порядком роста <span class="inline-formula"><img class="img-inline-formula img-formula" width="55" height="17" src="formulae/p7Pg644Ou_yBspI.6P9dd_cyiYJtXOrDgKl4aQ.png" alt="\theta(log{n})" title="\theta(log{n})"></span>.
    </p>
    <p>
     В последнем итеративном подсчете Фибоначи мы перезаписывали a &lt;- a + b и b &lt;- a, назовем это трансформацией T. Заметим что применение T n раз даст пару Fib(n + 1) и Fib(n), иными словами числа генерируются применением T^n. Теперь рассмотрим частный случай T p = 0 q = 1 в преобразовании Tpq, где Tpq преобразует пару (a, b) в a &lt;- bq + aq + ap и b &lt;- bp + aq. Покажите что если применить такую трансформацию Tpq дважды, результат будет тем же как и от единственной трансформации Tp'q' такой же формы, для которой p' и q' выраженны через p и q. Это даст нам возможность ускорить процедуру, как мы делали в fast-exp. Собрав все это вместе закончите процедуру приведенную ниже.
    </p>
    <p>
     Выражаем p' и q' через p и q.
    </p>
    <div class="theorem-environment theorem-proposition-environment">
     <div class="theorem-header theorem-proposition-header">
      Утверждение.
     </div>
     <div class="theorem-content theorem-proposition-content">
      <p>
       a1 b1 a2 = b1q + a1q + a1p b2 = b1p + a1q
      </p>
      <p>
       a3 = b2q + a2q + a2p b3 = b2p + a2q
      </p>
      <p>
       a3 = (b1p + a1q)q + (b1q + a1q + a1p)q + (b1q + a1q + a1p)p b3 = (b1p + a1q)p + (b1q + a1q + a1p)q
      </p>
      <p>
       a3 = b1q' + a1q' + a1p' (1) b3 = b1p' + a1q' (2)
      </p>
      <p>
       a3 = b1pq + a1qq + b1qq + a1qq + a1pq + b1pq + a1pq + a1pp b3 = b1pp + a1pq + b1qq + a1qq + a1pq
      </p>
      <p>
       a3 = b1(2pq + qq) + a1(2qq + 2pq + pp) (3) b3 = b1(pp + qq) + a1(2pq + qq) (4)
      </p>
      <p>
       a3 = b1(2pq + qq) + a1(2pq + qq) + a1(qq + pp)
      </p>
      <p>
       q' = 2pq + qq
      </p>
      <p>
       p' = pp + qq
      </p>
     </div>
    </div>
   </div>
<div class="code-scheme">
<pre class="code literal-block"><span></span><span class="lineno"> 1 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">fib</span> <span class="nv">n</span><span class="p">)</span>
<span class="lineno"> 2 </span>  <span class="p">(</span><span class="nf">fib-iter</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="nv">n</span><span class="p">))</span>
<span class="lineno"> 3 </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">fib-iter</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">p</span> <span class="nv">q</span> <span class="nv">count</span><span class="p">)</span>
<span class="lineno"> 4 </span>  <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">= </span><span class="nv">count</span> <span class="mi">0</span><span class="p">)</span> <span class="nv">b</span><span class="p">)</span>
<span class="lineno"> 5 </span>        <span class="p">((</span><span class="nb">even? </span><span class="nv">count</span><span class="p">)</span>
<span class="lineno"> 6 </span>         <span class="p">(</span><span class="nf">fib-iter</span> <span class="nv">a</span>
<span class="lineno"> 7 </span>                   <span class="nv">b</span>
<span class="lineno"> 8 </span>                   <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">square</span> <span class="nv">p</span><span class="p">)</span> <span class="p">(</span><span class="nf">square</span> <span class="nv">q</span><span class="p">))</span>      <span class="c1">; compute p'</span>
<span class="lineno"> 9 </span>                   <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nb">* </span><span class="mi">2</span> <span class="nv">p</span> <span class="nv">q</span><span class="p">)</span> <span class="p">(</span><span class="nf">square</span> <span class="nv">q</span><span class="p">))</span>      <span class="c1">; compute q'</span>
<span class="lineno">10 </span>                   <span class="p">(</span><span class="nb">/ </span><span class="nv">count</span> <span class="mi">2</span><span class="p">)))</span>
<span class="lineno">11 </span>        <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">fib-iter</span> <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nb">* </span><span class="nv">b</span> <span class="nv">q</span><span class="p">)</span> <span class="p">(</span><span class="nb">* </span><span class="nv">a</span> <span class="nv">q</span><span class="p">)</span> <span class="p">(</span><span class="nb">* </span><span class="nv">a</span> <span class="nv">p</span><span class="p">))</span>
<span class="lineno">12 </span>                        <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nb">* </span><span class="nv">b</span> <span class="nv">p</span><span class="p">)</span> <span class="p">(</span><span class="nb">* </span><span class="nv">a</span> <span class="nv">q</span><span class="p">))</span>
<span class="lineno">13 </span>                        <span class="nv">p</span>
<span class="lineno">14 </span>                        <span class="nv">q</span>
<span class="lineno">15 </span>                        <span class="p">(</span><span class="nb">- </span><span class="nv">count</span> <span class="mi">1</span><span class="p">)))))</span>
</pre>
</div>  </div>
 </div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/sicp-uprazhnenie-113/" class="u-url">SICP Упражнение 1.13</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Velikii Nehochuha
            </span></p>
            <p class="dateline">
            <a href="posts/sicp-uprazhnenie-113/" rel="bookmark">
            <time class="published dt-published" datetime="2020-01-10T22:44:12+03:00" itemprop="datePublished" title="2020-01-10 22:44">2020-01-10 22:44</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div class="chapter-block">
 <h2>
  Упражнение 1.13
 </h2>
 <div>
  <div class="section-block">
   <h3>
    Доказать что Fib(n) равно ближайшему целому от <span class="inline-formula"><img class="img-inline-formula img-formula" width="51" height="20" src="formulae/qmmHpyMlLsLpIpLHlURTp1owmHnJlfTVv755nw.png" alt="\phi^n/\sqrt{5}" title="\phi^n/\sqrt{5}"></span>, где <span class="inline-formula"><img class="img-inline-formula img-formula" width="117" height="20" src="formulae/hZnPfd8DlYO9DZt9mrqHPU3pZH.9aebd5WDGlg.png" alt="\phi = (1+\sqrt{5})/2" title="\phi = (1+\sqrt{5})/2"></span>
   </h3>
   <div>
    <p>
     при n=0, <span class="inline-formula"><img class="img-inline-formula img-formula" width="113" height="20" src="formulae/kGR35pg.J1oIAbS3ByyC3CfU7u_zYp7UkShLJA.png" alt="\phi^0/\sqrt{5} = 1/\sqrt{5}" title="\phi^0/\sqrt{5} = 1/\sqrt{5}"></span>, что округляя до целых рано 0.
    </p>
    <p>
     при n=1, <span class="inline-formula"><img class="img-inline-formula img-formula" width="375" height="21" src="formulae/2bqrTUr.StkHYLtOgqb2S6yXaVJRKkmml3mJOQ.png" alt="\phi^1/\sqrt{5} = (1+\sqrt(5))/(2*\sqrt{5}) = 1/2 + 1/(2*\sqrt{5})" title="\phi^1/\sqrt{5} = (1+\sqrt(5))/(2*\sqrt{5}) = 1/2 + 1/(2*\sqrt{5})"></span>, что округляя до целых равно 1. осталось доказать что Fib(n) = Fib(n-2) + Fib(n-1) (1):
    </p>
    <div class="display-formula">
     <img class="img-display-formula img-formula" width="399" height="21" src="formulae/ZURQpAKWFG6.0WAEX.BQDw361iAytlELyBK8rw.png" alt="((1+\sqrt{5})/2)^n = ((1+\sqrt{5})/2)^{n-1} + ((1+\sqrt{5})/2)^{n-2}" title="((1+\sqrt{5})/2)^n = ((1+\sqrt{5})/2)^{n-1} + ((1+\sqrt{5})/2)^{n-2}">
</div>
    <p>
     , (тождество 1) делим все на <span class="inline-formula"><img class="img-inline-formula img-formula" width="124" height="20" src="formulae/P64fheNboh7kjVc.J65fG8aaUiK4lNgXCZmWew.png" alt="((1+\sqrt{5})/2)^{n-2}" title="((1+\sqrt{5})/2)^{n-2}"></span>, получаем:
    </p>
    <div class="display-formula">
     <img class="img-display-formula img-formula" width="255" height="21" src="formulae/OhVfNfT1IDLrXElHys_g1uIdw4zxYkeUMSN2gA.png" alt="((1+\sqrt{5})/2)^2 = ((1+\sqrt{5})/2) + 1" title="((1+\sqrt{5})/2)^2 = ((1+\sqrt{5})/2) + 1">
</div>
    <div class="display-formula">
     <img class="img-display-formula img-formula" width="188" height="21" src="formulae/WdC6BsCq.ziw2FoIpJJN.MGzpGRlNpFiA0Z7HA.png" alt="(1+\sqrt{5})^2 = 2+2\sqrt{5} + 4" title="(1+\sqrt{5})^2 = 2+2\sqrt{5} + 4">
</div>
    <div class="display-formula">
     <img class="img-display-formula img-formula" width="40" height="11" src="formulae/y.GRlg4873GC_OIUeajnnK2yU.iIDK26NTUc9g.png" alt="0 = 0" title="0 = 0">
</div>
    <p>
     Ч.т.д.
    </p>
   </div>
  </div>
  <div class="section-block">
   <h3>
    Доказать по индукции что функцию Фибоначи можно считать как <span class="inline-formula"><img class="img-inline-formula img-formula" width="165" height="20" src="formulae/mF8cUs5LkLg5BCDr.3uAay12c56n.d8XMHDpKQ.png" alt="f(n) = (\phi^n-\psi^n)/\sqrt{5}" title="f(n) = (\phi^n-\psi^n)/\sqrt{5}"></span>, где <span class="inline-formula"><img class="img-inline-formula img-formula" width="117" height="20" src="formulae/hZnPfd8DlYO9DZt9mrqHPU3pZH.9aebd5WDGlg.png" alt="\phi = (1+\sqrt{5})/2" title="\phi = (1+\sqrt{5})/2"></span> и <span class="inline-formula"><img class="img-inline-formula img-formula" width="119" height="20" src="formulae/oxKL1Mb1N_iMBE2vAPapClklGGyJp1NSTo3KTw.png" alt="\psi = (1-\sqrt{5})/2" title="\psi = (1-\sqrt{5})/2"></span>
   </h3>
   <div>
    <p>
     при n=0, <span class="inline-formula"><img class="img-inline-formula img-formula" width="136" height="20" src="formulae/jLMP21rgYPtqQeX8CrNrJkXZjCDu0pSpVoCj9g.png" alt="(\phi^0-\psi^0)/\sqrt{5} = 0" title="(\phi^0-\psi^0)/\sqrt{5} = 0"></span>
    </p>
    <p>
     при n=1, <span class="inline-formula"><img class="img-inline-formula img-formula" width="295" height="21" src="formulae/nSajWKu5CFrSKniUBj10DkIqKy3LRye6a8cl8A.png" alt="((1+\sqrt{5})/2)-(1-\sqrt{5})/2))/\sqrt(5) = 1" title="((1+\sqrt{5})/2)-(1-\sqrt{5})/2))/\sqrt(5) = 1"></span>
    </p>
    <p>
     осталось доказать что Fib(n) = Fib(n-2) + Fib(n-1) (2):
    </p>
    <div class="display-formula">
     <img class="img-display-formula img-formula" width="953" height="21" src="formulae/wq.Rq.HXT9H104.ghU.llmrz5UuKrAI0m.hgBA.png" alt="(((1+\sqrt{5})/2)^n - ((1-\sqrt{5})/2)^n)/\sqrt{5} = (((1+\sqrt{5})/2)^{n-1} - ((1-\sqrt{5})/2)^{n-1})/\sqrt{5} + (((1+\sqrt{5})/2)^{n-2} - ((1-\sqrt{5})/2)^{n-2})/\sqrt{5}" title="(((1+\sqrt{5})/2)^n - ((1-\sqrt{5})/2)^n)/\sqrt{5} = (((1+\sqrt{5})/2)^{n-1} - ((1-\sqrt{5})/2)^{n-1})/\sqrt{5} + (((1+\sqrt{5})/2)^{n-2} - ((1-\sqrt{5})/2)^{n-2})/\sqrt{5}">
</div>
    <div class="display-formula">
     <img class="img-display-formula img-formula" width="817" height="21" src="formulae/Am4sZVszc.AJBcPvGGP2Hg7B_r2VB.lJFJe7rw.png" alt="((1+\sqrt{5})/2)^n - ((1-\sqrt{5})/2)^n = ((1+\sqrt{5})/2)^{n-1} - ((1-\sqrt{5})/2)^{n-1} + ((1+\sqrt{5})/2)^{n-2} - ((1-\sqrt{5})/2)^{n-2}" title="((1+\sqrt{5})/2)^n - ((1-\sqrt{5})/2)^n = ((1+\sqrt{5})/2)^{n-1} - ((1-\sqrt{5})/2)^{n-1} + ((1+\sqrt{5})/2)^{n-2} - ((1-\sqrt{5})/2)^{n-2}">
</div>
    <p>
     применяя тождество 1, получаем:
    </p>
    <div class="display-formula">
     <img class="img-display-formula img-formula" width="399" height="21" src="formulae/mBgmwA_a43nN1qjuDL0a6pF5vhKZV2qnhE5gQg.png" alt="((1-\sqrt{5})/2)^n = ((1-\sqrt{5})/2)^{n-1} + ((1-\sqrt{5})/2)^{n-2}" title="((1-\sqrt{5})/2)^n = ((1-\sqrt{5})/2)^{n-1} + ((1-\sqrt{5})/2)^{n-2}">
</div>
    <p>
     доказывается точно также как тождество 1:
    </p>
    <div class="display-formula">
     <img class="img-display-formula img-formula" width="255" height="21" src="formulae/a8t2dmDEAsinmvCGJofpZncar22jW5V8rrFouA.png" alt="((1-\sqrt{5})/2)^2 = ((1-\sqrt{5})/2) + 1" title="((1-\sqrt{5})/2)^2 = ((1-\sqrt{5})/2) + 1">
</div>
    <div class="display-formula">
     <img class="img-display-formula img-formula" width="188" height="21" src="formulae/kO6G5BYnE8.uTj3lK4dBHJYVKD59RAU6XGtnZA.png" alt="(1-\sqrt{5})^2 = 2-2\sqrt{5} + 4" title="(1-\sqrt{5})^2 = 2-2\sqrt{5} + 4">
</div>
    <div class="display-formula">
     <img class="img-display-formula img-formula" width="40" height="11" src="formulae/y.GRlg4873GC_OIUeajnnK2yU.iIDK26NTUc9g.png" alt="0 = 0" title="0 = 0">
</div>
    <p>
     Ч.т.д.
    </p>
   </div>
  </div>
 </div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/sicp-uprazhneniia-iz-glavy-12/" class="u-url">SICP Упражнения из главы 1.2 (1.9-1.12)</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Velikii Nehochuha
            </span></p>
            <p class="dateline">
            <a href="posts/sicp-uprazhneniia-iz-glavy-12/" rel="bookmark">
            <time class="published dt-published" datetime="2020-01-10T12:33:18+03:00" itemprop="datePublished" title="2020-01-10 12:33">2020-01-10 12:33</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div id="outline-container-org53c3a57" class="outline-2">
<h2 id="org53c3a57">Exercise 1.9.</h2>
<div class="outline-text-2" id="text-org53c3a57">
<p>
Каждая из двух приведенных процедур реализует сложение в терминах инкремента (int), используя модель замещения, проиллюстрируйте процесс вычисления, это рекурсивные или итеративные процессы?
</p>

<div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nb">+ </span><span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="nv">a</span> <span class="mi">0</span><span class="p">)</span>
      <span class="nv">b</span>
      <span class="p">(</span><span class="nf">inc</span> <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">dec</span> <span class="nv">a</span><span class="p">)</span> <span class="nv">b</span><span class="p">))))</span>

<span class="p">(</span><span class="nb">+ </span><span class="mi">6</span> <span class="mi">5</span><span class="p">)</span>
<span class="p">(</span><span class="nf">inc</span> <span class="p">(</span><span class="nb">+ </span><span class="mi">5</span> <span class="mi">5</span><span class="p">))</span>
<span class="p">(</span><span class="nf">inc</span> <span class="p">(</span><span class="nf">inc</span> <span class="p">(</span><span class="nb">+ </span><span class="mi">4</span> <span class="mi">5</span><span class="p">)))</span>
<span class="p">(</span><span class="nf">inc</span> <span class="p">(</span><span class="nf">inc</span> <span class="p">(</span><span class="nf">inc</span> <span class="p">(</span><span class="nb">+ </span><span class="mi">3</span> <span class="mi">5</span><span class="p">))))</span>
<span class="p">(</span><span class="nf">inc</span> <span class="p">(</span><span class="nf">inc</span> <span class="p">(</span><span class="nf">inc</span> <span class="p">(</span><span class="nf">inc</span> <span class="p">(</span><span class="nb">+ </span><span class="mi">2</span> <span class="mi">5</span><span class="p">)))))</span>
<span class="p">(</span><span class="nf">inc</span> <span class="p">(</span><span class="nf">inc</span> <span class="p">(</span><span class="nf">inc</span> <span class="p">(</span><span class="nf">inc</span> <span class="p">(</span><span class="nf">inc</span> <span class="p">(</span><span class="nb">+ </span><span class="mi">1</span> <span class="mi">5</span><span class="p">))))))</span>
<span class="p">(</span><span class="nf">inc</span> <span class="p">(</span><span class="nf">inc</span> <span class="p">(</span><span class="nf">inc</span> <span class="p">(</span><span class="nf">inc</span> <span class="p">(</span><span class="nf">inc</span> <span class="p">(</span><span class="nf">inc</span> <span class="p">(</span><span class="nb">+ </span><span class="mi">0</span> <span class="mi">5</span><span class="p">)))))))</span> <span class="c1">; 5 + 6inc 11</span>


<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nb">+ </span><span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="nv">a</span> <span class="mi">0</span><span class="p">)</span>
      <span class="nv">b</span>
      <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">dec</span> <span class="nv">a</span><span class="p">)</span> <span class="p">(</span><span class="nf">inc</span> <span class="nv">b</span><span class="p">))))</span>
<span class="p">(</span><span class="nb">+ </span><span class="mi">6</span> <span class="mi">5</span><span class="p">)</span>
<span class="p">(</span><span class="nb">+ </span><span class="mi">5</span> <span class="mi">6</span><span class="p">)</span>
<span class="p">(</span><span class="nb">+ </span><span class="mi">4</span> <span class="mi">7</span><span class="p">)</span>
<span class="p">(</span><span class="nb">+ </span><span class="mi">3</span> <span class="mi">8</span><span class="p">)</span>
<span class="p">(</span><span class="nb">+ </span><span class="mi">2</span> <span class="mi">9</span><span class="p">)</span>
<span class="p">(</span><span class="nb">+ </span><span class="mi">1</span> <span class="mi">10</span><span class="p">)</span>
<span class="p">(</span><span class="nb">+ </span><span class="mi">0</span> <span class="mi">11</span><span class="p">)</span> <span class="c1">; 11</span>
</pre></div>
</div>
</div>

<div id="outline-container-orgd2c0f7d" class="outline-2">
<h2 id="orgd2c0f7d">Exercise 1.10</h2>
<div class="outline-text-2" id="text-orgd2c0f7d">
<p>
Функция Аккермана. Интересна тем что являетеся рекурсивной и растет быстрее экспоненты.
</p>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">A</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span>
  <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">= </span><span class="nv">y</span> <span class="mi">0</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
	<span class="p">((</span><span class="nb">= </span><span class="nv">x</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nb">* </span><span class="mi">2</span> <span class="nv">y</span><span class="p">))</span>
	<span class="p">((</span><span class="nb">= </span><span class="nv">y</span> <span class="mi">1</span><span class="p">)</span> <span class="mi">2</span><span class="p">)</span>
	<span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">A</span> <span class="p">(</span><span class="nb">- </span><span class="nv">x</span> <span class="mi">1</span><span class="p">)</span>
		 <span class="p">(</span><span class="nf">A</span> <span class="nv">x</span> <span class="p">(</span><span class="nb">- </span><span class="nv">y</span> <span class="mi">1</span><span class="p">))))))</span>
<span class="p">(</span><span class="nf">A</span> <span class="mi">1</span> <span class="mi">10</span><span class="p">)</span> <span class="c1">;Value: 1024</span>
<span class="p">(</span><span class="nf">A</span> <span class="mi">2</span> <span class="mi">4</span><span class="p">)</span> <span class="c1">;Value: 65536</span>
<span class="p">(</span><span class="nf">A</span> <span class="mi">3</span> <span class="mi">3</span><span class="p">)</span> <span class="c1">;Value: 65536</span>
</pre></div>
<p>
Рассмотрим следующие процедуры
</p>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">f</span> <span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nf">A</span> <span class="mi">0</span> <span class="nv">n</span><span class="p">))</span>
<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">g</span> <span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nf">A</span> <span class="mi">1</span> <span class="nv">n</span><span class="p">))</span>
<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">h</span> <span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nf">A</span> <span class="mi">2</span> <span class="nv">n</span><span class="p">))</span>
<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">k</span> <span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nb">* </span><span class="mi">5</span> <span class="nv">n</span> <span class="nv">n</span><span class="p">))</span>
</pre></div>

<p>
Дайте краткое математическое определение функций f, g, h. К примеру k(n) = 5*n*n
</p>

<p>
(f n) = (A 0 n) = (* 2 n)
(g n) = (A 1 n) = (A 0 (A 1 (- n 1))) = (* 2 (A 1 (- n 1))) = это будет 2 в степени n
(h n) = (A 2 n) = (A 1 (A 2 (- n 1))) = 2 в степени (A 2 (- n 1)) = 2 <b>* 2 в cтепени (A 2 (-n 2), пока A 2 (- n (- n 1))
(A 2 4) ;;  = 2 *</b> 2 <b>* 2 *</b> 2 ;; 65536
</p>
</div>
</div>

<div id="outline-container-org34d7e75" class="outline-2">
<h2 id="org34d7e75">Exercise 1.11.</h2>
<div class="outline-text-2" id="text-org34d7e75">
<p>
Функция f(n) = n, если n&lt;3 и f(n) = f(n - 1) + 2f(n - 2) + 3f(n - 3) если n&gt;= 3. Напишите процедуру для вычисления значения f в рекурсивной и итеративной форме.
</p>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">f</span> <span class="nv">n</span><span class="p">)</span>
  <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">&lt; </span><span class="nv">n</span> <span class="mi">3</span><span class="p">)</span> <span class="nv">n</span><span class="p">)</span>
	<span class="p">((</span><span class="nb">&gt;= </span><span class="nv">n</span> <span class="mi">3</span><span class="p">)</span> <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">f</span> <span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="mi">1</span><span class="p">))</span> <span class="p">(</span><span class="nb">* </span><span class="mi">2</span> <span class="p">(</span><span class="nf">f</span> <span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="mi">2</span><span class="p">)))</span> <span class="p">(</span><span class="nb">* </span><span class="mi">3</span> <span class="p">(</span><span class="nf">f</span> <span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="mi">3</span><span class="p">)))))))</span>
</pre></div>

<p>
при итеративном подходе просто начинаем с известных f(2) f(1) f(0) это параметры f-iter a, b, c
f(3) = (f(2) + 2f(1) + 3f(0)), записываем это значение в a
в b записываем f(2) в с f(1)
на следующей итерации нам вычислять f(4) = (f(3) + 2(f2) + 3(f1))
в a у нас f(3) b = f(2) c = f(1)то есть можем вычислить f4 и записать его в снова в a, при этом в b записываем f(3) то есть предыдущее значение a, в c записываем f(2) теперь нам нужно вычислить f(5), у нас все есть a = f(4) b = f(3) c = f(2).
</p>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">f</span> <span class="nv">n</span><span class="p">)</span>
   <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">f-iter</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span> <span class="nv">count</span><span class="p">)</span>
     <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&lt; </span><span class="nv">count</span> <span class="mi">3</span><span class="p">)</span>
	 <span class="nv">a</span>
	 <span class="p">(</span><span class="nf">f-iter</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">a</span> <span class="p">(</span><span class="nb">* </span><span class="mi">2</span> <span class="nv">b</span><span class="p">)</span> <span class="p">(</span><span class="nb">* </span><span class="mi">3</span> <span class="nv">c</span><span class="p">))</span> <span class="nv">a</span> <span class="nv">b</span> <span class="p">(</span><span class="nb">- </span><span class="nv">count</span> <span class="mi">1</span><span class="p">))))</span>
   <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&lt; </span><span class="nv">n</span> <span class="mi">3</span><span class="p">)</span>
       <span class="nv">n</span>
       <span class="p">(</span><span class="nf">f-iter</span> <span class="mi">2</span> <span class="mi">1</span> <span class="mi">0</span> <span class="nv">n</span><span class="p">)))</span>
</pre></div>
</div>
</div>

<div id="outline-container-orgbbeab67" class="outline-2">
<h2 id="orgbbeab67">Exercise 1.12.</h2>
<div class="outline-text-2" id="text-orgbbeab67">
<p>
Треугольник Паскаля изображен на картинке.
<img src="images/ch1-Z-G-17.gif" alt="nil">
Напишите рекурсивную процедуру вычисления значений элементов в треугольнике паскаля.
</p>

<p>
пусть n ряд в треугольнике
m - позиция в ряду начиная с 0, тогда значение в m будет равно биномиальному коэффициенту С из n по m. (/ n! (* m! (- n m)!)
(1 + x)**3 = 1 + 3x + 3xx + xxx
</p>
<div class="highlight"><pre><span></span><span class="c1">;; через биномиальные коэффициенты</span>
<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">factorial</span> <span class="nv">n</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="nv">n</span> <span class="mi">1</span><span class="p">)</span>
      <span class="nv">n</span>
      <span class="p">(</span><span class="nb">* </span><span class="nv">n</span> <span class="p">(</span><span class="nf">factorial</span> <span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="mi">1</span><span class="p">)))))</span>
<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">pascal</span> <span class="nv">n</span> <span class="nv">m</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="k">or </span><span class="p">(</span><span class="nb">= </span><span class="nv">n</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nb">= </span><span class="nv">m</span> <span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nb">= </span><span class="nv">m</span> <span class="mi">0</span><span class="p">))</span>
      <span class="mi">1</span>
      <span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nf">factorial</span> <span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nb">* </span><span class="p">(</span><span class="nf">factorial</span> <span class="nv">m</span><span class="p">)</span> <span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="nv">m</span><span class="p">)))))</span>

<span class="c1">;; рекурсивно поднимамясь вверх по столбцам</span>
<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">pascal</span> <span class="nv">n</span> <span class="nv">m</span><span class="p">)</span>
  <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="k">or </span><span class="p">(</span><span class="nb">= </span><span class="nv">m</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nb">= </span><span class="nv">m</span> <span class="nv">n</span><span class="p">))</span> <span class="mi">1</span><span class="p">)</span>
	<span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">pascal</span> <span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nb">- </span><span class="nv">m</span> <span class="mi">1</span><span class="p">))</span>
		 <span class="p">(</span><span class="nf">pascal</span> <span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">m</span><span class="p">)))))</span>
</pre></div>
</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/sicp-uprazhneniia-iz-glavy-11/" class="u-url">SICP Упражнения из главы 1.1</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Velikii Nehochuha
            </span></p>
            <p class="dateline">
            <a href="posts/sicp-uprazhneniia-iz-glavy-11/" rel="bookmark">
            <time class="published dt-published" datetime="2020-01-09T13:10:04+03:00" itemprop="datePublished" title="2020-01-09 13:10">2020-01-09 13:10</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div id="outline-container-orga933951" class="outline-2">
<h2 id="orga933951">Exercise 1.1.</h2>
<div class="outline-text-2" id="text-orga933951">
<p>
Простейшие арифметические операции, специальные формы if, define, cond.
</p>
<div class="highlight"><pre><span></span><span class="mi">10</span> <span class="c1">;Value: 10</span>
<span class="p">(</span><span class="nb">+ </span><span class="mi">5</span> <span class="mi">3</span> <span class="mi">4</span><span class="p">)</span> <span class="c1">;Value: 12</span>
<span class="p">(</span><span class="nb">- </span><span class="mi">9</span> <span class="mi">1</span><span class="p">)</span> <span class="c1">;Value: 8</span>
<span class="p">(</span><span class="nb">/ </span><span class="mi">6</span> <span class="mi">2</span><span class="p">)</span> <span class="c1">;Value: 3</span>
<span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nb">* </span><span class="mi">2</span> <span class="mi">4</span><span class="p">)</span> <span class="p">(</span><span class="nb">- </span><span class="mi">4</span> <span class="mi">6</span><span class="p">))</span> <span class="c1">;Value: 6</span>
<span class="p">(</span><span class="k">define </span><span class="nv">a</span> <span class="mi">3</span><span class="p">)</span> <span class="c1">;Value: a</span>
<span class="p">(</span><span class="k">define </span><span class="nv">b</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">a</span> <span class="mi">1</span><span class="p">))</span> <span class="c1">;Value: b</span>
<span class="p">(</span><span class="nb">+ </span><span class="nv">a</span> <span class="nv">b</span> <span class="p">(</span><span class="nb">* </span><span class="nv">a</span> <span class="nv">b</span><span class="p">))</span> <span class="c1">;Value: 19</span>
<span class="p">(</span><span class="nb">= </span><span class="nv">a</span> <span class="nv">b</span><span class="p">)</span> <span class="c1">;Value: #f</span>
<span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nb">&gt; </span><span class="nv">b</span> <span class="nv">a</span><span class="p">)</span> <span class="p">(</span><span class="nb">&lt; </span><span class="nv">b</span> <span class="p">(</span><span class="nb">* </span><span class="nv">a</span> <span class="nv">b</span><span class="p">)))</span>
    <span class="nv">b</span>
    <span class="nv">a</span><span class="p">)</span> <span class="c1">;Value: 4</span>
<span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">= </span><span class="nv">a</span> <span class="mi">4</span><span class="p">)</span> <span class="mi">6</span><span class="p">)</span>
      <span class="p">((</span><span class="nb">= </span><span class="nv">b</span> <span class="mi">4</span><span class="p">)</span> <span class="p">(</span><span class="nb">+ </span><span class="mi">6</span> <span class="mi">7</span> <span class="nv">a</span><span class="p">))</span>
      <span class="p">(</span><span class="k">else </span><span class="mi">25</span><span class="p">))</span> <span class="c1">;Value: 16</span>
<span class="p">(</span><span class="nb">+ </span><span class="mi">2</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&gt; </span><span class="nv">b</span> <span class="nv">a</span><span class="p">)</span> <span class="nv">b</span> <span class="nv">a</span><span class="p">))</span> <span class="c1">;Value: 6</span>
<span class="p">(</span><span class="nb">* </span><span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">&gt; </span><span class="nv">a</span> <span class="nv">b</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span>
	 <span class="p">((</span><span class="nb">&lt; </span><span class="nv">a</span> <span class="nv">b</span><span class="p">)</span> <span class="nv">b</span><span class="p">)</span>
	 <span class="p">(</span><span class="k">else </span><span class="mi">-1</span><span class="p">))</span>
   <span class="p">(</span><span class="nb">+ </span><span class="nv">a</span> <span class="mi">1</span><span class="p">))</span> <span class="c1">;Value: 16</span>
</pre></div>
</div>
</div>

<div id="outline-container-org3679b76" class="outline-2">
<h2 id="org3679b76">Exercise 1.2.</h2>
<div class="outline-text-2" id="text-org3679b76">
<p>
Перевести формулу с картинки в scheme.
</p>

<p>
<img src="images/ch1-Z-G-3.gif" alt="nil"></p>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nb">+ </span><span class="mi">5</span> <span class="mi">4</span> <span class="p">(</span><span class="nb">- </span><span class="mi">2</span> <span class="p">(</span><span class="nb">- </span><span class="mi">3</span> <span class="p">(</span><span class="nb">+ </span><span class="mi">6</span> <span class="p">(</span><span class="nb">/ </span><span class="mi">4</span> <span class="mi">3</span><span class="p">)))))</span> <span class="p">(</span><span class="nb">* </span><span class="mi">3</span> <span class="p">(</span><span class="nb">- </span><span class="mi">6</span> <span class="mi">2</span><span class="p">)</span> <span class="p">(</span><span class="nb">- </span><span class="mi">2</span> <span class="mi">7</span><span class="p">)))</span> <span class="c1">;Value: -23/90</span>
</pre></div>
</div>
</div>

<div id="outline-container-org5f5c07d" class="outline-2">
<h2 id="org5f5c07d">Exercise 1.3.</h2>
<div class="outline-text-2" id="text-org5f5c07d">
<p>
Определить функцию сложения квадратов, двух чисел, выбрав их из трех аргументов.
</p>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">squire</span> <span class="nv">x</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">* </span><span class="nv">x</span> <span class="nv">x</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">sum-squire-two-larger</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&gt; </span><span class="nv">x</span> <span class="nv">y</span><span class="p">)</span>
      <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&gt; </span><span class="nv">y</span> <span class="nv">z</span><span class="p">)</span>
	  <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">squire</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nf">squire</span> <span class="nv">y</span><span class="p">))</span>
	  <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">squire</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nf">squire</span> <span class="nv">z</span><span class="p">)))</span>
      <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&gt; </span><span class="nv">x</span> <span class="nv">z</span><span class="p">)</span>
	  <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">squire</span> <span class="nv">y</span><span class="p">)</span> <span class="p">(</span><span class="nf">squire</span> <span class="nv">x</span><span class="p">))</span>
	  <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">squire</span> <span class="nv">y</span><span class="p">)</span> <span class="p">(</span><span class="nf">squire</span> <span class="nv">z</span><span class="p">)))))</span>
<span class="p">(</span><span class="nf">sum-squire-two-larger</span> <span class="mi">0</span> <span class="mi">5</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>

<div id="outline-container-org3b3179a" class="outline-2">
<h2 id="org3b3179a">Exercise 1.4.</h2>
<div class="outline-text-2" id="text-org3b3179a">
<p>
Scheme позволяет выбирать операнды так же как и обычные переменные.
Можно выбирать какую операцию применить в зависимости от условия, то есть функции можно рассматривать как объекты.
</p>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="n">define</span> <span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="n">plus</span><span class="o">-</span><span class="nb">abs</span><span class="o">-</span><span class="n">b</span> <span class="n">a</span> <span class="n">b</span><span class="p">)</span>
  <span class="p">((</span><span class="k">if</span> <span class="p">(</span><span class="o">&gt;</span> <span class="n">b</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="o">-</span><span class="p">)</span> <span class="n">a</span> <span class="n">b</span><span class="p">))</span>

<span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="n">plus</span><span class="o">-</span><span class="nb">abs</span><span class="o">-</span><span class="n">b</span> <span class="mi">5</span> <span class="o">-</span><span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>

<div id="outline-container-org5893909" class="outline-2">
<h2 id="org5893909">Exercise 1.5.</h2>
<div class="outline-text-2" id="text-org5893909">
<p>
Пытаемся разобраться в какой последовательности выполняются процедуры и зачем нужны специальные формы.
</p>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">p</span><span class="p">)</span> <span class="p">(</span><span class="nf">p</span><span class="p">))</span>
<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">test</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="nv">x</span> <span class="mi">0</span><span class="p">)</span>
      <span class="mi">0</span>
      <span class="nv">y</span><span class="p">))</span>

<span class="p">(</span><span class="nf">test</span> <span class="mi">0</span> <span class="p">(</span><span class="nf">p</span><span class="p">))</span>
</pre></div>

<p>
Scheme сначала вычисляет аргументы, а потом тело процедуры (applicative-order evaluation)
при попытке вычислить (test 0 (p)) интерпретатор пытается сначала
посчитать аргументы функции test, что приводит к бесконечному рекурсивному вызову (define (p) (p))
если мы это была специальная форма, а не обычный define, то нам не пришлось бы вычислять (p) и результатом был бы 0
</p>
</div>
</div>

<div id="outline-container-orgbe9d794" class="outline-2">
<h2 id="orgbe9d794">Exercise 1.6.</h2>
<div class="outline-text-2" id="text-orgbe9d794">
<p>
Хакер Алиса не понимает для чего нужны специальные формы. ``Почему я не могу просто определить if как обычную процедуру в терминах cond?'' - спросила она. Её друг Ева Ли Атор согласился что это действительно можно сделать, и она записала свою реализацию специальной формы if через define:
</p>

<div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">new-if</span> <span class="nv">predicate</span> <span class="nv">then-clause</span> <span class="nv">else-clause</span><span class="p">)</span>
  <span class="p">(</span><span class="k">cond </span><span class="p">(</span><span class="nf">predicate</span> <span class="nv">then-clause</span><span class="p">)</span>
	<span class="p">(</span><span class="k">else </span><span class="nv">else-clause</span><span class="p">)))</span>
</pre></div>

<p>
Ева продемонстрировала программу Алисе:
</p>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">new-if</span> <span class="p">(</span><span class="nb">= </span><span class="mi">2</span> <span class="mi">3</span><span class="p">)</span> <span class="mi">0</span> <span class="mi">5</span><span class="p">)</span>
<span class="c1">;; 5</span>
<span class="p">(</span><span class="nf">new-if</span> <span class="p">(</span><span class="nb">= </span><span class="mi">1</span> <span class="mi">1</span><span class="p">)</span> <span class="mi">0</span> <span class="mi">5</span><span class="p">)</span>
<span class="c1">;; 0</span>
</pre></div>

<p>
Обрадовавшись, Алиса использует new-if чтобы переписать программу получения квадратного корня:
</p>

<div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">sqrt-iter</span> <span class="nv">guess</span> <span class="nv">x</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">new-if</span> <span class="p">(</span><span class="nf">good-enough?</span> <span class="nv">guess</span> <span class="nv">x</span><span class="p">)</span>
	  <span class="nv">guess</span>
	  <span class="p">(</span><span class="nf">sqrt-iter</span> <span class="p">(</span><span class="nf">improve</span> <span class="nv">guess</span> <span class="nv">x</span><span class="p">)</span>
		     <span class="nv">x</span><span class="p">)))</span>
</pre></div>

<p>
Что произойдет при попытке использовать новую версию программы? Объясните.
</p>

<p>
При попытке вывполнить программу мы получаем сообщение об ошибке
</p>
<div class="highlight"><pre><span></span><span class="c1">;Aborting!: maximum recursion depth exceeded</span>
</pre></div>

<p>
обычный if (if &lt;predicate&gt; &lt;consequent&gt; &lt;alternative&gt;) сначала выполняет
predicate, затем в зависимости от условия выполнятеся consequent или alternative.
</p>

<p>
в случае же new-if эта правило нарушается, то есть в new-if
(new-if &lt;predicate&gt; &lt;consequent&gt; &lt;alternative&gt;) интерпретатор сначала выполняет predicate и потом не зависимо от результата пытается вычислить результат consequent и alternative (так как это аргументы процедуры new-if), но так как alternative содержит рекурсию, то данная операция выполняется всегда, так как условие проверяется постфактум.
Это и приводит к ошибке (Превышена глубина рекурсии). Поэтому специальная форма if необходима в данном случае.
</p>
</div>
</div>

<div id="outline-container-orgbd61893" class="outline-2">
<h2 id="orgbd61893">Exercise 1.7.</h2>
<div class="outline-text-2" id="text-orgbd61893">
<p>
Ограничение приведенное в книге не подходит для малых чисел а так же для больших. Так же в реальном мире, арифметические операции всегда выполняются с погрешностью. Это делает наш тест неподходящим для больших чисел. Поясните данное утверждение, приведите примеры когда исходный вариант программы работает плохо. В качестве альтернативной реализации напишите программу которая считает результат подходящим когда изменение предположения между двумя итерациями много меньше предыдущего предполагаемого решения, то есть мы будем получать очень малое уточнение за все последующие операции. Попробуйте получить результат с помощью новой процедуры.
</p>

<div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nb">sqrt </span><span class="nv">x</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">good-enough?</span> <span class="nv">guess</span> <span class="nv">x</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">&lt; </span><span class="p">(</span><span class="nb">abs </span><span class="p">(</span><span class="nb">- </span><span class="p">(</span><span class="nf">square</span> <span class="nv">guess</span><span class="p">)</span> <span class="nv">x</span><span class="p">))</span> <span class="mf">0.001</span><span class="p">))</span>
  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">average</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nb">+ </span><span class="nv">x</span> <span class="nv">y</span><span class="p">)</span> <span class="mi">2</span><span class="p">))</span>
  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">improve</span> <span class="nv">guess</span> <span class="nv">x</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">average</span> <span class="nv">guess</span> <span class="p">(</span><span class="nb">/ </span><span class="nv">x</span> <span class="nv">guess</span><span class="p">)))</span>
  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">sqrt-iter</span> <span class="nv">guess</span> <span class="nv">x</span><span class="p">)</span>
    <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">good-enough?</span> <span class="nv">guess</span> <span class="nv">x</span><span class="p">)</span>
	<span class="nv">guess</span>
	<span class="p">(</span><span class="nf">sqrt-iter</span> <span class="p">(</span><span class="nf">improve</span> <span class="nv">guess</span> <span class="nv">x</span><span class="p">)</span> <span class="nv">x</span><span class="p">)))</span>
  <span class="p">(</span><span class="nf">sqrt-iter</span> <span class="mf">1.0</span> <span class="nv">x</span><span class="p">))</span>

<span class="p">(</span><span class="nb">sqrt </span><span class="mf">0.01</span><span class="p">)</span> <span class="c1">;Value: .10032578510960605 Ok</span>
<span class="p">(</span><span class="nb">sqrt </span><span class="mf">0.001</span><span class="p">)</span> <span class="c1">;Value: .04124542607499115 Работает плохо "реальное значение" 0.03162277660168379</span>

<span class="p">(</span><span class="nb">sqrt </span><span class="mi">10000000</span><span class="p">)</span> <span class="c1">;Value: 3162.277660168379, Ok "реальное значение" 3162.2776601683795</span>
<span class="p">(</span><span class="nb">sqrt </span><span class="mi">12345678901234567</span><span class="p">)</span> <span class="c1">;; Слишком много итераций, программа зависает.</span>
</pre></div>

<p>
Новая версия
</p>

<div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nb">sqrt </span><span class="nv">x</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">good-enough?</span> <span class="nv">guess</span> <span class="nv">prev-guess</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">&lt; </span><span class="p">(</span><span class="nb">abs </span><span class="p">(</span><span class="nb">- </span><span class="nv">guess</span> <span class="nv">prev-guess</span><span class="p">))</span> <span class="mf">0.001</span><span class="p">))</span> <span class="c1">;; изменение guess менее десятой доли процента</span>
  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">average</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nb">+ </span><span class="nv">x</span> <span class="nv">y</span><span class="p">)</span> <span class="mi">2</span><span class="p">))</span>
  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">improve</span> <span class="nv">guess</span> <span class="nv">x</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">average</span> <span class="nv">guess</span> <span class="p">(</span><span class="nb">/ </span><span class="nv">x</span> <span class="nv">guess</span><span class="p">)))</span>
  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">sqrt-iter</span> <span class="nv">g</span> <span class="nv">prev-g</span> <span class="nv">x</span><span class="p">)</span>
    <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">good-enough?</span> <span class="nv">g</span> <span class="nv">prev-g</span><span class="p">)</span>
	<span class="nv">g</span>
	<span class="p">(</span><span class="nf">sqrt-iter</span> <span class="p">(</span><span class="nf">improve</span> <span class="nv">g</span> <span class="nv">x</span><span class="p">)</span> <span class="nv">g</span> <span class="nv">x</span><span class="p">)))</span>
  <span class="p">(</span><span class="nf">sqrt-iter</span> <span class="mf">1.0</span> <span class="mf">1.002</span> <span class="nv">x</span><span class="p">))</span>

<span class="p">(</span><span class="nb">sqrt </span><span class="mi">2</span><span class="p">)</span>
<span class="p">(</span><span class="nb">sqrt </span><span class="mi">12345678901234567</span><span class="p">)</span> <span class="c1">;Value: 111111110.6111111</span>
<span class="p">(</span><span class="nb">sqrt </span><span class="mf">0.001</span><span class="p">)</span> <span class="c1">;Value: .03162278245070105</span>
</pre></div>

<p>
Видим что стало работать быстро на больших числах и точно на любых с заданной погрешностью.
</p>
</div>
</div>

<div id="outline-container-orgf299247" class="outline-2">
<h2 id="orgf299247">Exercise 1.8.</h2>
<div class="outline-text-2" id="text-orgf299247">
<p>
Метод Ньютона для кубического корня основан на факте что приближенное значение можно искать по формуле с картинки. Реализуйте метод извлечения кубического корня из числа.
</p>

<p>
<img src="images/ch1-Z-G-5.gif" alt="nil"></p>

<div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">cube-root</span> <span class="nv">x</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">good-enough?</span> <span class="nv">guess</span> <span class="nv">prev-guess</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">&lt; </span><span class="p">(</span><span class="nb">abs </span><span class="p">(</span><span class="nb">- </span><span class="nv">guess</span> <span class="nv">prev-guess</span><span class="p">))</span> <span class="mf">0.001</span><span class="p">))</span>
  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">average</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nb">+ </span><span class="nv">x</span> <span class="nv">y</span><span class="p">)</span> <span class="mi">2</span><span class="p">))</span>
  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">improve</span> <span class="nv">guess</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">average</span> <span class="nv">guess</span> <span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nb">/ </span><span class="nv">x</span> <span class="p">(</span><span class="nf">square</span> <span class="nv">guess</span><span class="p">))</span> <span class="p">(</span><span class="nb">* </span><span class="mi">2</span> <span class="nv">guess</span><span class="p">))</span> <span class="mi">3</span><span class="p">)))</span>
  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">sqrt-iter</span> <span class="nv">g</span> <span class="nv">prev-g</span><span class="p">)</span>
    <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">good-enough?</span> <span class="nv">g</span> <span class="nv">prev-g</span><span class="p">)</span>
	<span class="nv">g</span>
	<span class="p">(</span><span class="nf">sqrt-iter</span> <span class="p">(</span><span class="nf">improve</span> <span class="nv">g</span><span class="p">)</span> <span class="nv">g</span><span class="p">)))</span>
  <span class="p">(</span><span class="nf">sqrt-iter</span> <span class="mf">1.0</span> <span class="mf">1.002</span><span class="p">))</span>

<span class="p">(</span><span class="nf">cube-root</span> <span class="mi">27</span><span class="p">)</span> <span class="c1">;Value: 3.000935399157486</span>
</pre></div>
</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/zadachi-po-kursu-sicp/" class="u-url">Задачи по курсу SICP. Введение.</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Velikii Nehochuha
            </span></p>
            <p class="dateline">
            <a href="posts/zadachi-po-kursu-sicp/" rel="bookmark">
            <time class="published dt-published" datetime="2020-01-08T15:07:03+03:00" itemprop="datePublished" title="2020-01-08 15:07">2020-01-08 15:07</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>
Есть такой замечательный курс <a href="https://mitpress.mit.edu/sites/default/files/sicp/full-text/book/book-Z-H-4.html#%_toc_start">SICP</a>. Я его когда-то начинал читать, но до конца не прошел, думаю на этот раз получится. Буду делать упражнения из него и выкладывать сюда свои решения.
Первым делом надо настроить emacs что бы удобно было тестировать программы. <code>[4/4]</code>
</p>
<ul class="org-ul">
<li class="on">
<code>[X]</code> Установить mit scheme по <a href="https://www.gnu.org/software/mit-scheme/documentation/mit-scheme-user/Unix-Installation.html">Инструкции.</a>
</li>
<li class="on">
<code>[X]</code> Создать файл в 1-ой вкладке emacs c разрешением .scm файл откроется в scheme-mode</li>
<li class="on">
<code>[X]</code> Запустить в другой окне (C-x 3 - создать окно) M-x run-scheme RET</li>
<li class="on">
<code>[X]</code> Любое выражение из первой вкладки можно выполнить по C-x C-e.</li>
</ul>
<p>
Получится что-то вроде:
</p>

<p>
<img src="images/Screenshot_2020-01-08_08-08-55.thumbnail.png" alt="nil"></p>

<p>
Пишем что-то в правой вкладке, жмем C-x C-e, видим результат в левой.
</p>
    </div>
    </article>
</div>
        <nav class="postindexpager"><ul class="pager">
<li class="next">
                <a href="index-1.html" rel="next">Старые записи</a>
            </li>
        </ul></nav></main><footer id="footer"><p>Contents © 2020         <a href="mailto:anton.s.pilipenko@gmail.com">Velikii Nehochuha</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         </p>
            
        </footer>
</div>
                <script src="assets/js/all-nocdn.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script>
</body>
</html>
