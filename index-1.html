<!DOCTYPE html>
<html prefix="
        og: http://ogp.me/ns# article: http://ogp.me/ns/article#
    " vocab="http://ogp.me/ns" lang="ru">
<head>
<meta charset="utf-8">
<meta name="description" content="IT blog">
<meta name="viewport" content="width=device-width">
<title>VelikiiNehochuha Blog (1 страница со старыми записями) | VelikiiNehochuha Blog</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="ru" href="rss.xml">
<link rel="canonical" href="http://velikiinehochuha.github.io/index-1.html">
<link rel="prev" href="." type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5shiv-printshiv.min.js"></script><![endif]-->
</head>
<body>
    <a href="#content" class="sr-only sr-only-focusable">Перейти к главному содержимому</a>
    <div id="container">
             <header id="header"><h1 id="brand"><a href="http://velikiinehochuha.github.io/" title="VelikiiNehochuha Blog" rel="home">

        <span id="blog-title">VelikiiNehochuha Blog</span>
    </a></h1>

        
            <nav id="menu"><ul>
<li><a href="archive.html">Архив</a></li>
                <li><a href="categories/">Тэги</a></li>
                <li><a href="rss.xml">RSS лента</a></li>

    
    
    
    </ul></nav></header><main id="content"><div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/sicp-uprazhneniia-iz-glavy-11/" class="u-url">SICP Упражнения из главы 1.1</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Velikii Nehochuha
            </span></p>
            <p class="dateline">
            <a href="posts/sicp-uprazhneniia-iz-glavy-11/" rel="bookmark">
            <time class="published dt-published" datetime="2020-01-09T13:10:04+03:00" itemprop="datePublished" title="2020-01-09 13:10">2020-01-09 13:10</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div id="outline-container-orga933951" class="outline-2">
<h2 id="orga933951">Exercise 1.1.</h2>
<div class="outline-text-2" id="text-orga933951">
<p>
Простейшие арифметические операции, специальные формы if, define, cond.
</p>
<div class="highlight"><pre><span></span><span class="mi">10</span> <span class="c1">;Value: 10</span>
<span class="p">(</span><span class="nb">+ </span><span class="mi">5</span> <span class="mi">3</span> <span class="mi">4</span><span class="p">)</span> <span class="c1">;Value: 12</span>
<span class="p">(</span><span class="nb">- </span><span class="mi">9</span> <span class="mi">1</span><span class="p">)</span> <span class="c1">;Value: 8</span>
<span class="p">(</span><span class="nb">/ </span><span class="mi">6</span> <span class="mi">2</span><span class="p">)</span> <span class="c1">;Value: 3</span>
<span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nb">* </span><span class="mi">2</span> <span class="mi">4</span><span class="p">)</span> <span class="p">(</span><span class="nb">- </span><span class="mi">4</span> <span class="mi">6</span><span class="p">))</span> <span class="c1">;Value: 6</span>
<span class="p">(</span><span class="k">define </span><span class="nv">a</span> <span class="mi">3</span><span class="p">)</span> <span class="c1">;Value: a</span>
<span class="p">(</span><span class="k">define </span><span class="nv">b</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">a</span> <span class="mi">1</span><span class="p">))</span> <span class="c1">;Value: b</span>
<span class="p">(</span><span class="nb">+ </span><span class="nv">a</span> <span class="nv">b</span> <span class="p">(</span><span class="nb">* </span><span class="nv">a</span> <span class="nv">b</span><span class="p">))</span> <span class="c1">;Value: 19</span>
<span class="p">(</span><span class="nb">= </span><span class="nv">a</span> <span class="nv">b</span><span class="p">)</span> <span class="c1">;Value: #f</span>
<span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nb">&gt; </span><span class="nv">b</span> <span class="nv">a</span><span class="p">)</span> <span class="p">(</span><span class="nb">&lt; </span><span class="nv">b</span> <span class="p">(</span><span class="nb">* </span><span class="nv">a</span> <span class="nv">b</span><span class="p">)))</span>
    <span class="nv">b</span>
    <span class="nv">a</span><span class="p">)</span> <span class="c1">;Value: 4</span>
<span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">= </span><span class="nv">a</span> <span class="mi">4</span><span class="p">)</span> <span class="mi">6</span><span class="p">)</span>
      <span class="p">((</span><span class="nb">= </span><span class="nv">b</span> <span class="mi">4</span><span class="p">)</span> <span class="p">(</span><span class="nb">+ </span><span class="mi">6</span> <span class="mi">7</span> <span class="nv">a</span><span class="p">))</span>
      <span class="p">(</span><span class="k">else </span><span class="mi">25</span><span class="p">))</span> <span class="c1">;Value: 16</span>
<span class="p">(</span><span class="nb">+ </span><span class="mi">2</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&gt; </span><span class="nv">b</span> <span class="nv">a</span><span class="p">)</span> <span class="nv">b</span> <span class="nv">a</span><span class="p">))</span> <span class="c1">;Value: 6</span>
<span class="p">(</span><span class="nb">* </span><span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">&gt; </span><span class="nv">a</span> <span class="nv">b</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span>
	 <span class="p">((</span><span class="nb">&lt; </span><span class="nv">a</span> <span class="nv">b</span><span class="p">)</span> <span class="nv">b</span><span class="p">)</span>
	 <span class="p">(</span><span class="k">else </span><span class="mi">-1</span><span class="p">))</span>
   <span class="p">(</span><span class="nb">+ </span><span class="nv">a</span> <span class="mi">1</span><span class="p">))</span> <span class="c1">;Value: 16</span>
</pre></div>
</div>
</div>

<div id="outline-container-org3679b76" class="outline-2">
<h2 id="org3679b76">Exercise 1.2.</h2>
<div class="outline-text-2" id="text-org3679b76">
<p>
Перевести формулу с картинки в scheme.
</p>

<p>
<img src="images/ch1-Z-G-3.gif" alt="nil"></p>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nb">+ </span><span class="mi">5</span> <span class="mi">4</span> <span class="p">(</span><span class="nb">- </span><span class="mi">2</span> <span class="p">(</span><span class="nb">- </span><span class="mi">3</span> <span class="p">(</span><span class="nb">+ </span><span class="mi">6</span> <span class="p">(</span><span class="nb">/ </span><span class="mi">4</span> <span class="mi">3</span><span class="p">)))))</span> <span class="p">(</span><span class="nb">* </span><span class="mi">3</span> <span class="p">(</span><span class="nb">- </span><span class="mi">6</span> <span class="mi">2</span><span class="p">)</span> <span class="p">(</span><span class="nb">- </span><span class="mi">2</span> <span class="mi">7</span><span class="p">)))</span> <span class="c1">;Value: -23/90</span>
</pre></div>
</div>
</div>

<div id="outline-container-org5f5c07d" class="outline-2">
<h2 id="org5f5c07d">Exercise 1.3.</h2>
<div class="outline-text-2" id="text-org5f5c07d">
<p>
Определить функцию сложения квадратов, двух чисел, выбрав их из трех аргументов.
</p>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">squire</span> <span class="nv">x</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">* </span><span class="nv">x</span> <span class="nv">x</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">sum-squire-two-larger</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&gt; </span><span class="nv">x</span> <span class="nv">y</span><span class="p">)</span>
      <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&gt; </span><span class="nv">y</span> <span class="nv">z</span><span class="p">)</span>
	  <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">squire</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nf">squire</span> <span class="nv">y</span><span class="p">))</span>
	  <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">squire</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nf">squire</span> <span class="nv">z</span><span class="p">)))</span>
      <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&gt; </span><span class="nv">x</span> <span class="nv">z</span><span class="p">)</span>
	  <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">squire</span> <span class="nv">y</span><span class="p">)</span> <span class="p">(</span><span class="nf">squire</span> <span class="nv">x</span><span class="p">))</span>
	  <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">squire</span> <span class="nv">y</span><span class="p">)</span> <span class="p">(</span><span class="nf">squire</span> <span class="nv">z</span><span class="p">)))))</span>
<span class="p">(</span><span class="nf">sum-squire-two-larger</span> <span class="mi">0</span> <span class="mi">5</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>

<div id="outline-container-org3b3179a" class="outline-2">
<h2 id="org3b3179a">Exercise 1.4.</h2>
<div class="outline-text-2" id="text-org3b3179a">
<p>
Scheme позволяет выбирать операнды так же как и обычные переменные.
Можно выбирать какую операцию применить в зависимости от условия, то есть функции можно рассматривать как объекты.
</p>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="n">define</span> <span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="n">plus</span><span class="o">-</span><span class="nb">abs</span><span class="o">-</span><span class="n">b</span> <span class="n">a</span> <span class="n">b</span><span class="p">)</span>
  <span class="p">((</span><span class="k">if</span> <span class="p">(</span><span class="o">&gt;</span> <span class="n">b</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="o">-</span><span class="p">)</span> <span class="n">a</span> <span class="n">b</span><span class="p">))</span>

<span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="n">plus</span><span class="o">-</span><span class="nb">abs</span><span class="o">-</span><span class="n">b</span> <span class="mi">5</span> <span class="o">-</span><span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>

<div id="outline-container-org5893909" class="outline-2">
<h2 id="org5893909">Exercise 1.5.</h2>
<div class="outline-text-2" id="text-org5893909">
<p>
Пытаемся разобраться в какой последовательности выполняются процедуры и зачем нужны специальные формы.
</p>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">p</span><span class="p">)</span> <span class="p">(</span><span class="nf">p</span><span class="p">))</span>
<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">test</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="nv">x</span> <span class="mi">0</span><span class="p">)</span>
      <span class="mi">0</span>
      <span class="nv">y</span><span class="p">))</span>

<span class="p">(</span><span class="nf">test</span> <span class="mi">0</span> <span class="p">(</span><span class="nf">p</span><span class="p">))</span>
</pre></div>

<p>
Scheme сначала вычисляет аргументы, а потом тело процедуры (applicative-order evaluation)
при попытке вычислить (test 0 (p)) интерпретатор пытается сначала
посчитать аргументы функции test, что приводит к бесконечному рекурсивному вызову (define (p) (p))
если мы это была специальная форма, а не обычный define, то нам не пришлось бы вычислять (p) и результатом был бы 0
</p>
</div>
</div>

<div id="outline-container-orgbe9d794" class="outline-2">
<h2 id="orgbe9d794">Exercise 1.6.</h2>
<div class="outline-text-2" id="text-orgbe9d794">
<p>
Хакер Алиса не понимает для чего нужны специальные формы. ``Почему я не могу просто определить if как обычную процедуру в терминах cond?'' - спросила она. Её друг Ева Ли Атор согласился что это действительно можно сделать, и она записала свою реализацию специальной формы if через define:
</p>

<div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">new-if</span> <span class="nv">predicate</span> <span class="nv">then-clause</span> <span class="nv">else-clause</span><span class="p">)</span>
  <span class="p">(</span><span class="k">cond </span><span class="p">(</span><span class="nf">predicate</span> <span class="nv">then-clause</span><span class="p">)</span>
	<span class="p">(</span><span class="k">else </span><span class="nv">else-clause</span><span class="p">)))</span>
</pre></div>

<p>
Ева продемонстрировала программу Алисе:
</p>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">new-if</span> <span class="p">(</span><span class="nb">= </span><span class="mi">2</span> <span class="mi">3</span><span class="p">)</span> <span class="mi">0</span> <span class="mi">5</span><span class="p">)</span>
<span class="c1">;; 5</span>
<span class="p">(</span><span class="nf">new-if</span> <span class="p">(</span><span class="nb">= </span><span class="mi">1</span> <span class="mi">1</span><span class="p">)</span> <span class="mi">0</span> <span class="mi">5</span><span class="p">)</span>
<span class="c1">;; 0</span>
</pre></div>

<p>
Обрадовавшись, Алиса использует new-if чтобы переписать программу получения квадратного корня:
</p>

<div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">sqrt-iter</span> <span class="nv">guess</span> <span class="nv">x</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">new-if</span> <span class="p">(</span><span class="nf">good-enough?</span> <span class="nv">guess</span> <span class="nv">x</span><span class="p">)</span>
	  <span class="nv">guess</span>
	  <span class="p">(</span><span class="nf">sqrt-iter</span> <span class="p">(</span><span class="nf">improve</span> <span class="nv">guess</span> <span class="nv">x</span><span class="p">)</span>
		     <span class="nv">x</span><span class="p">)))</span>
</pre></div>

<p>
Что произойдет при попытке использовать новую версию программы? Объясните.
</p>

<p>
При попытке вывполнить программу мы получаем сообщение об ошибке
</p>
<div class="highlight"><pre><span></span><span class="c1">;Aborting!: maximum recursion depth exceeded</span>
</pre></div>

<p>
обычный if (if &lt;predicate&gt; &lt;consequent&gt; &lt;alternative&gt;) сначала выполняет
predicate, затем в зависимости от условия выполнятеся consequent или alternative.
</p>

<p>
в случае же new-if эта правило нарушается, то есть в new-if
(new-if &lt;predicate&gt; &lt;consequent&gt; &lt;alternative&gt;) интерпретатор сначала выполняет predicate и потом не зависимо от результата пытается вычислить результат consequent и alternative (так как это аргументы процедуры new-if), но так как alternative содержит рекурсию, то данная операция выполняется всегда, так как условие проверяется постфактум.
Это и приводит к ошибке (Превышена глубина рекурсии). Поэтому специальная форма if необходима в данном случае.
</p>
</div>
</div>

<div id="outline-container-orgbd61893" class="outline-2">
<h2 id="orgbd61893">Exercise 1.7.</h2>
<div class="outline-text-2" id="text-orgbd61893">
<p>
Ограничение приведенное в книге не подходит для малых чисел а так же для больших. Так же в реальном мире, арифметические операции всегда выполняются с погрешностью. Это делает наш тест неподходящим для больших чисел. Поясните данное утверждение, приведите примеры когда исходный вариант программы работает плохо. В качестве альтернативной реализации напишите программу которая считает результат подходящим когда изменение предположения между двумя итерациями много меньше предыдущего предполагаемого решения, то есть мы будем получать очень малое уточнение за все последующие операции. Попробуйте получить результат с помощью новой процедуры.
</p>

<div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nb">sqrt </span><span class="nv">x</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">good-enough?</span> <span class="nv">guess</span> <span class="nv">x</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">&lt; </span><span class="p">(</span><span class="nb">abs </span><span class="p">(</span><span class="nb">- </span><span class="p">(</span><span class="nf">square</span> <span class="nv">guess</span><span class="p">)</span> <span class="nv">x</span><span class="p">))</span> <span class="mf">0.001</span><span class="p">))</span>
  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">average</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nb">+ </span><span class="nv">x</span> <span class="nv">y</span><span class="p">)</span> <span class="mi">2</span><span class="p">))</span>
  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">improve</span> <span class="nv">guess</span> <span class="nv">x</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">average</span> <span class="nv">guess</span> <span class="p">(</span><span class="nb">/ </span><span class="nv">x</span> <span class="nv">guess</span><span class="p">)))</span>
  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">sqrt-iter</span> <span class="nv">guess</span> <span class="nv">x</span><span class="p">)</span>
    <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">good-enough?</span> <span class="nv">guess</span> <span class="nv">x</span><span class="p">)</span>
	<span class="nv">guess</span>
	<span class="p">(</span><span class="nf">sqrt-iter</span> <span class="p">(</span><span class="nf">improve</span> <span class="nv">guess</span> <span class="nv">x</span><span class="p">)</span> <span class="nv">x</span><span class="p">)))</span>
  <span class="p">(</span><span class="nf">sqrt-iter</span> <span class="mf">1.0</span> <span class="nv">x</span><span class="p">))</span>

<span class="p">(</span><span class="nb">sqrt </span><span class="mf">0.01</span><span class="p">)</span> <span class="c1">;Value: .10032578510960605 Ok</span>
<span class="p">(</span><span class="nb">sqrt </span><span class="mf">0.001</span><span class="p">)</span> <span class="c1">;Value: .04124542607499115 Работает плохо "реальное значение" 0.03162277660168379</span>

<span class="p">(</span><span class="nb">sqrt </span><span class="mi">10000000</span><span class="p">)</span> <span class="c1">;Value: 3162.277660168379, Ok "реальное значение" 3162.2776601683795</span>
<span class="p">(</span><span class="nb">sqrt </span><span class="mi">12345678901234567</span><span class="p">)</span> <span class="c1">;; Слишком много итераций, программа зависает.</span>
</pre></div>

<p>
Новая версия
</p>

<div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nb">sqrt </span><span class="nv">x</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">good-enough?</span> <span class="nv">guess</span> <span class="nv">prev-guess</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">&lt; </span><span class="p">(</span><span class="nb">abs </span><span class="p">(</span><span class="nb">- </span><span class="nv">guess</span> <span class="nv">prev-guess</span><span class="p">))</span> <span class="mf">0.001</span><span class="p">))</span> <span class="c1">;; изменение guess менее десятой доли процента</span>
  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">average</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nb">+ </span><span class="nv">x</span> <span class="nv">y</span><span class="p">)</span> <span class="mi">2</span><span class="p">))</span>
  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">improve</span> <span class="nv">guess</span> <span class="nv">x</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">average</span> <span class="nv">guess</span> <span class="p">(</span><span class="nb">/ </span><span class="nv">x</span> <span class="nv">guess</span><span class="p">)))</span>
  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">sqrt-iter</span> <span class="nv">g</span> <span class="nv">prev-g</span> <span class="nv">x</span><span class="p">)</span>
    <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">good-enough?</span> <span class="nv">g</span> <span class="nv">prev-g</span><span class="p">)</span>
	<span class="nv">g</span>
	<span class="p">(</span><span class="nf">sqrt-iter</span> <span class="p">(</span><span class="nf">improve</span> <span class="nv">g</span> <span class="nv">x</span><span class="p">)</span> <span class="nv">g</span> <span class="nv">x</span><span class="p">)))</span>
  <span class="p">(</span><span class="nf">sqrt-iter</span> <span class="mf">1.0</span> <span class="mf">1.002</span> <span class="nv">x</span><span class="p">))</span>

<span class="p">(</span><span class="nb">sqrt </span><span class="mi">2</span><span class="p">)</span>
<span class="p">(</span><span class="nb">sqrt </span><span class="mi">12345678901234567</span><span class="p">)</span> <span class="c1">;Value: 111111110.6111111</span>
<span class="p">(</span><span class="nb">sqrt </span><span class="mf">0.001</span><span class="p">)</span> <span class="c1">;Value: .03162278245070105</span>
</pre></div>

<p>
Видим что стало работать быстро на больших числах и точно на любых с заданной погрешностью.
</p>
</div>
</div>

<div id="outline-container-orgf299247" class="outline-2">
<h2 id="orgf299247">Exercise 1.8.</h2>
<div class="outline-text-2" id="text-orgf299247">
<p>
Метод Ньютона для кубического корня основан на факте что приближенное значение можно искать по формуле с картинки. Реализуйте метод извлечения кубического корня из числа.
</p>

<p>
<img src="images/ch1-Z-G-5.gif" alt="nil"></p>

<div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">cube-root</span> <span class="nv">x</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">good-enough?</span> <span class="nv">guess</span> <span class="nv">prev-guess</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">&lt; </span><span class="p">(</span><span class="nb">abs </span><span class="p">(</span><span class="nb">- </span><span class="nv">guess</span> <span class="nv">prev-guess</span><span class="p">))</span> <span class="mf">0.001</span><span class="p">))</span>
  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">average</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nb">+ </span><span class="nv">x</span> <span class="nv">y</span><span class="p">)</span> <span class="mi">2</span><span class="p">))</span>
  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">improve</span> <span class="nv">guess</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">average</span> <span class="nv">guess</span> <span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nb">/ </span><span class="nv">x</span> <span class="p">(</span><span class="nf">square</span> <span class="nv">guess</span><span class="p">))</span> <span class="p">(</span><span class="nb">* </span><span class="mi">2</span> <span class="nv">guess</span><span class="p">))</span> <span class="mi">3</span><span class="p">)))</span>
  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">sqrt-iter</span> <span class="nv">g</span> <span class="nv">prev-g</span><span class="p">)</span>
    <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">good-enough?</span> <span class="nv">g</span> <span class="nv">prev-g</span><span class="p">)</span>
	<span class="nv">g</span>
	<span class="p">(</span><span class="nf">sqrt-iter</span> <span class="p">(</span><span class="nf">improve</span> <span class="nv">g</span><span class="p">)</span> <span class="nv">g</span><span class="p">)))</span>
  <span class="p">(</span><span class="nf">sqrt-iter</span> <span class="mf">1.0</span> <span class="mf">1.002</span><span class="p">))</span>

<span class="p">(</span><span class="nf">cube-root</span> <span class="mi">27</span><span class="p">)</span> <span class="c1">;Value: 3.000935399157486</span>
</pre></div>
</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/zadachi-po-kursu-sicp/" class="u-url">Задачи по курсу SICP. Введение.</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Velikii Nehochuha
            </span></p>
            <p class="dateline">
            <a href="posts/zadachi-po-kursu-sicp/" rel="bookmark">
            <time class="published dt-published" datetime="2020-01-08T15:07:03+03:00" itemprop="datePublished" title="2020-01-08 15:07">2020-01-08 15:07</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>
Есть такой замечательный курс <a href="https://mitpress.mit.edu/sites/default/files/sicp/full-text/book/book-Z-H-4.html#%_toc_start">SICP</a>. Я его когда-то начинал читать, но до конца не прошел, думаю на этот раз получится. Буду делать упражнения из него и выкладывать сюда свои решения.
Первым делом надо настроить emacs что бы удобно было тестировать программы. <code>[4/4]</code>
</p>
<ul class="org-ul">
<li class="on">
<code>[X]</code> Установить mit scheme по <a href="https://www.gnu.org/software/mit-scheme/documentation/mit-scheme-user/Unix-Installation.html">Инструкции.</a>
</li>
<li class="on">
<code>[X]</code> Создать файл в 1-ой вкладке emacs c разрешением .scm файл откроется в scheme-mode</li>
<li class="on">
<code>[X]</code> Запустить в другой окне (C-x 3 - создать окно) M-x run-scheme RET</li>
<li class="on">
<code>[X]</code> Любое выражение из первой вкладки можно выполнить по C-x C-e.</li>
</ul>
<p>
Получится что-то вроде:
</p>

<p>
<img src="images/Screenshot_2020-01-08_08-08-55.thumbnail.png" alt="nil"></p>

<p>
Пишем что-то в правой вкладке, жмем C-x C-e, видим результат в левой.
</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/nastroika-emacs-dlia-svelte/" class="u-url">Настройка emacs для svelte</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Velikii Nehochuha
            </span></p>
            <p class="dateline">
            <a href="posts/nastroika-emacs-dlia-svelte/" rel="bookmark">
            <time class="published dt-published" datetime="2019-11-26T22:58:31+03:00" itemprop="datePublished" title="2019-11-26 22:58">2019-11-26 22:58</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div id="outline-container-orgf99b1d5" class="outline-2">
<h2 id="orgf99b1d5">Установить необходимые пакеты в emacs</h2>
<div class="outline-text-2" id="text-orgf99b1d5">
<p>
Я добавил поддержку svelte шаблонов сравнительно недавно, поэтому web-mode
c поддержкой svelte доступен пока только в unstable melpa
</p>

<div class="highlight"><pre><span></span><span class="nv">package-install</span> <span class="nv">web-mode</span>
<span class="nv">package-install</span> <span class="nv">add-node-modules-path</span>
<span class="nv">package-install</span> <span class="nv">flycheck</span>
</pre></div>
</div>
</div>

<div id="outline-container-org53994fa" class="outline-2">
<h2 id="org53994fa">Настроим web-mode</h2>
<div class="outline-text-2" id="text-org53994fa">
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nb">load</span> <span class="s">"~/.emacs.d/web-mode.el"</span><span class="p">)</span>
<span class="p">(</span><span class="nv">add-to-list</span> <span class="ss">'auto-mode-alist</span> <span class="o">'</span><span class="p">(</span><span class="s">"\\.svelte\\'"</span> <span class="o">.</span> <span class="nv">web-mode</span><span class="p">))</span>
<span class="p">(</span><span class="nv">add-to-list</span> <span class="ss">'auto-mode-alist</span> <span class="o">'</span><span class="p">(</span><span class="s">"\\.html\\'"</span> <span class="o">.</span> <span class="nv">web-mode</span><span class="p">))</span>
<span class="p">(</span><span class="nv">add-to-list</span> <span class="ss">'auto-mode-alist</span> <span class="o">'</span><span class="p">(</span><span class="s">"\\.jsx\\'"</span> <span class="o">.</span> <span class="nv">web-mode</span><span class="p">))</span>
<span class="p">(</span><span class="nv">add-to-list</span> <span class="ss">'auto-mode-alist</span> <span class="o">'</span><span class="p">(</span><span class="s">"\\.js\\'"</span> <span class="o">.</span> <span class="nv">web-mode</span><span class="p">))</span>

<span class="p">(</span><span class="k">setq</span> <span class="nv">web-mode-engines-alist</span>
    <span class="o">'</span><span class="p">((</span><span class="s">"django"</span>    <span class="o">.</span> <span class="s">"\\.html\\'"</span><span class="p">))</span>
<span class="p">)</span>
<span class="p">(</span><span class="nb">defun</span> <span class="nv">my-web-mode-hook</span> <span class="p">()</span>
  <span class="s">"Hooks for Web mode."</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">web-mode-indent-style</span> <span class="mi">2</span><span class="p">)</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">web-mode-markup-indent-offset</span> <span class="mi">2</span><span class="p">)</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">web-mode-css-indent-offset</span> <span class="mi">2</span><span class="p">)</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">web-mode-code-indent-offset</span> <span class="mi">2</span><span class="p">)</span> <span class="c1">;; 4</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">web-mode-style-padding</span> <span class="mi">2</span><span class="p">)</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">web-mode-script-padding</span> <span class="mi">2</span><span class="p">)</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">web-mode-block-padding</span> <span class="mi">2</span><span class="p">)</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">web-mode-part-padding</span> <span class="mi">2</span><span class="p">)</span>
<span class="p">)</span>
<span class="p">(</span><span class="nv">add-hook</span> <span class="ss">'web-mode-hook</span>  <span class="ss">'my-web-mode-hook</span><span class="p">)</span>
</pre></div>
</div>
</div>


<div id="outline-container-org8aa27a8" class="outline-2">
<h2 id="org8aa27a8">Настройка eslint</h2>
<div class="outline-text-2" id="text-org8aa27a8">
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nb">when</span> <span class="p">(</span><span class="nv">maybe-require-package</span> <span class="ss">'add-node-modules-path</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">after-load</span> <span class="ss">'web-mode</span>
    <span class="p">(</span><span class="nv">add-hook</span> <span class="ss">'web-mode-hook</span> <span class="ss">'add-node-modules-path</span><span class="p">)))</span>
<span class="p">(</span><span class="nv">setenv</span> <span class="s">"PATH"</span> <span class="p">(</span><span class="nv">concat</span> <span class="p">(</span><span class="nv">getenv</span> <span class="s">"PATH"</span><span class="p">)</span> <span class="s">":/home/anton/.nvm/versions/node/v10.15.3/bin/"</span><span class="p">))</span>
<span class="p">(</span><span class="k">setq</span> <span class="nv">exec-path</span> <span class="p">(</span><span class="nb">append</span> <span class="nv">exec-path</span> <span class="o">'</span><span class="p">(</span><span class="s">"/home/anton/.nvm/versions/node/v10.15.3/bin"</span><span class="p">)))</span>
<span class="p">(</span><span class="k">setq</span> <span class="nv">flycheck-javascript-eslint-executable</span> <span class="s">"eslint_d"</span><span class="p">)</span>
<span class="p">(</span><span class="nv">with-eval-after-load</span> <span class="ss">'flycheck</span>
  <span class="p">(</span><span class="nv">flycheck-add-mode</span> <span class="ss">'javascript-eslint</span> <span class="ss">'web-mode</span><span class="p">))</span>
</pre></div>
</div>

<div id="outline-container-org5604b4a" class="outline-3">
<h3 id="org5604b4a">установить глобально eslint<sub>d</sub>
</h3>
<div class="outline-text-3" id="text-org5604b4a">
<div class="highlight"><pre><span></span>npm install -g eslint eslint_d
</pre></div>
</div>
</div>
<div id="outline-container-orgf8cce70" class="outline-3">
<h3 id="orgf8cce70">установить в директорию с проектом</h3>
<div class="outline-text-3" id="text-orgf8cce70">
<div class="highlight"><pre><span></span>npm install eslint-plugin-svelte3 babel-eslint --save-dev
</pre></div>
</div>
</div>

<div id="outline-container-org632c4ab" class="outline-3">
<h3 id="org632c4ab">в директорию с проектом поместить .eslintrc</h3>
<div class="outline-text-3" id="text-org632c4ab">
<div class="highlight"><pre><span></span>{
  "parserOptions": { "ecmaVersion": 2019, "sourceType": "module" },
  "env": {
    "es6": true,
    "browser": true,
    "node": true
  },
  "plugins": [
    "svelte3"
  ],
  "overrides": [
    {
      "files": ["**/*.svelte"],
      "processor": "svelte3/svelte3"
    }
  ],
  "rules": {
    //"no-undefined": 2,
    "no-unused-vars": 2,
    "no-use-before-define": 2
  }
}
</pre></div>
</div>
</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/binarnyi-poisk-realizatsiia-na-python/" class="u-url">Бинарный поиск (реализация на python)</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Velikii Nehochuha
            </span></p>
            <p class="dateline">
            <a href="posts/binarnyi-poisk-realizatsiia-na-python/" rel="bookmark">
            <time class="published dt-published" datetime="2019-11-17T20:14:29+03:00" itemprop="datePublished" title="2019-11-17 20:14">2019-11-17 20:14</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>
Представьте англо-русский словарь и вам нужно найти какое-то слово на букву "o".
Для этого мы откроем словарь посередине и в зависимости на какую букву будет начинаться
слово примем решение левая или правая половина листов нам нужна. Повторим это пока не найдем страницу с буквой "o".
</p>

<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">binary_search</span><span class="p">(</span><span class="n">iterable</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
    <span class="n">minimum</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">maximum</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">iterable</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">minimum</span><span class="p">,</span> <span class="n">maximum</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">minimum</span> <span class="o">&lt;</span> <span class="n">maximum</span><span class="p">:</span>
	<span class="n">midle</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">maximum</span> <span class="o">+</span> <span class="n">minimum</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
	<span class="nb">print</span><span class="p">(</span><span class="s1">'midle'</span><span class="p">,</span> <span class="n">midle</span><span class="p">)</span>
	<span class="n">current</span> <span class="o">=</span> <span class="n">iterable</span><span class="p">[</span><span class="n">midle</span><span class="p">]</span>
	<span class="nb">print</span><span class="p">(</span><span class="s1">'current'</span><span class="p">,</span> <span class="n">current</span><span class="p">)</span>
	<span class="nb">print</span><span class="p">(</span><span class="s1">'item'</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
	<span class="k">if</span> <span class="n">current</span> <span class="o">==</span> <span class="n">item</span><span class="p">:</span>
	    <span class="k">return</span> <span class="n">midle</span>
	<span class="k">elif</span> <span class="n">item</span> <span class="o">&gt;</span> <span class="n">current</span><span class="p">:</span>
	    <span class="nb">print</span><span class="p">(</span><span class="s1">'ehrhe'</span><span class="p">)</span>
	    <span class="n">minimum</span> <span class="o">=</span> <span class="n">midle</span>
	<span class="k">elif</span> <span class="n">item</span> <span class="o">&lt;</span> <span class="n">current</span><span class="p">:</span>
	    <span class="n">maximum</span> <span class="o">=</span> <span class="n">midle</span>
	<span class="k">else</span><span class="p">:</span>
	    <span class="k">return</span> <span class="kc">None</span>

<span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">binary_search</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">res</span> <span class="o">=</span> <span class="mi">7</span>
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/poluchit-sms-s-telefona/" class="u-url">Получить смс с android телефона</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Velikii Nehochuha
            </span></p>
            <p class="dateline">
            <a href="posts/poluchit-sms-s-telefona/" rel="bookmark">
            <time class="published dt-published" datetime="2019-11-02T23:40:11+03:00" itemprop="datePublished" title="2019-11-02 23:40">2019-11-02 23:40</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div id="outline-container-org38b0488" class="outline-2">
<h2 id="org38b0488">Если есть root доступ по adb</h2>
<div class="outline-text-2" id="text-org38b0488">
<p>
Подключаемся по adb и запускаем запускаем отладочный сервер
</p>

<div class="highlight"><pre><span></span>adb root
adb start-server
adb tcpip 5555
adb connect host:5555 # adb over wi-fi
</pre></div>

<p>
Все SMS хранятся в базе данных mmssms.db, ищем её на устройстве
</p>
<div class="highlight"><pre><span></span>find / -name "*mmssms*" # in my case it is /data/user_de/0/com.android.providers.telephony/databases/mmssms.db
</pre></div>

<p>
Считываем из базы данных
</p>
<div class="highlight"><pre><span></span>sqlite3 /data/user_de/0/com.android.providers.telephony/databases/mmssms.db
select * from sms limit 3;
</pre></div>

<p>
Я часто раздаю интернет через hotsport с телефона, поэтому однострочником будет
</p>
<div class="highlight"><pre><span></span>ip -4 route list 0/0 | awk '{print $3}' | (read _default_route; adb connect $_default_route:5555) &amp;&amp; adb root &amp;&amp; adb shell 'sqlite3 /data/user_de/0/com.android.providers.telephony/databases/mmssms.db -batch "select * from sms limit 2";'
</pre></div>
</div>
</div>
    </div>
    </article>
</div>
        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="." rel="prev">Новые записи</a>
            </li>
        </ul></nav></main><footer id="footer"><p>Contents © 2020         <a href="mailto:anton.s.pilipenko@gmail.com">Velikii Nehochuha</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         </p>
            
        </footer>
</div>
                <script src="assets/js/all-nocdn.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script>
</body>
</html>
